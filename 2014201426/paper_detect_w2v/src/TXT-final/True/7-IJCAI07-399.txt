
wifi localization  the task of determining the physical location of a mobile device from wireless signal strengths  has been shown to be an accurate method of indoor and outdoor localization and a powerful building block for location-aware applications. however  most localization techniques require a training set of signal strength readings labeled against a ground truth location map  which is prohibitive to collect and maintain as maps grow large. in this paper we propose a novel technique for solving the wifi slam problem using the gaussian process latent variable model  gplvm  to determine the latent-space locations of unlabeled signal strength data. we show how gplvm  in combination with an appropriate motion dynamics model  can be used to reconstruct a topological connectivity graph from a signal strength sequence which  in combination with the learned gaussian process signal strength model  can be used to perform efficient localization.
1 introduction
the use of wireless signal strength information to localize mobile devices has gained significant interest in several research communities. this is mainly due to the increasing availability of 1 wifi networks and the importance of location information for applications such as activity recognition  surveillance  and context-aware computing.
﹛the unpredictability of signal propagation through indoor environments is the key challenge in location estimation from wireless signal strength. this unpredictability makes it difficult to generate an adequate likelihood model of signal strength measurements. thus  the main focus of research in this area has been on the development of techniques that can generate good likelihood models from calibration data collected in an environment. this data typically consists of signal strength measurements annotated with the ground truth locations of the device. the calibration data is then often used to estimate the parameters of locally gaussian models  which have proven to be very effective for localization  haeberlen et al.  1; letchner et al.  1; ferris et al.  1 .
﹛the reliance on ground truth calibration data clearly limits the applicability of existing techniques. in order to enable location-aware mobile devices  these devices need to be able to build their own spatial representations based on sequences of raw  unlabeled signal strength data. while the robotics and computer vision communities have developed techniques for jointly estimating the locations of a device and a map of an environment  the nature of wireless signal strength prohibits the use of standard slam  simultaneous localization and mapping  techniques  thrun et al.  1 .
﹛in this paper we present wifi-slam  a novel technique for building wireless signal strength maps without requiring any location labels in the training data. to do so  our approach builds on gaussian process latent variable models  gp-lvm   a recently developed technique for mapping high-dimensional data to a low-dimensional latent space  lawrence  1 . in our context  the high-dimensional data corresponds to the signal strength information for all wifi access points in an environment. gp-lvms map these signal strength measurements to a two-dimensional latent space  which can be interpreted as the xy-coordinates of the device. our embedding technique considers the following constraints to solve this challenging slam problem.
1. locations ↙ signal strength: locations that are near each other should observe similar signal strength measurements.
1. signal strengths ↙ locations: similar signal strength measurements indicate that they were observed at locations near each other. this constraint is extremely important to close loops  i.e. to detect when the person returns to a previously visited location during the mapping process. while this constraint might be violated for individual access points  it is a good approximation for typical office envionments  where multiple access points are visible at each point in time.
1. locations ↙ locations: locations that follow each other in the data stream should be near each other. this constraint models the fact that mapping data is sequential  collected by a person walking through the building.
our approach incorporates these constraints in a single  statistically sound way. as a result  the technique is able to build topologically correct maps from raw signal strength measurements. furthermore  the resulting map provides a signal strength sensor model that can be used for bayesian filtering for location estimation.
﹛this paper is organized as follows. after discussing related work in the next section  we provide background on gplvms in section 1. their application to wifi-slam is described in section 1  followed by experiments and conclusions.
1 related work
wifi localization techniques fall into a number of broad categories. several location estimation techniques attempt to model directly signal propagation through space  bahl and padmanabhan  1   assuming known locations of access points and an exponential signal attenuation model. however  even when considering the location and material of walls and furniture inside buildings  the accuracy of signal propagation models is very limited. other techniques attempt to model reading likelihoods on a location-specific basis  haeberlen et al.  1; letchner et al.  1   representing signal strength at locations of interest with probability distributions learned from training data. while more accurate than signal propagation models  these methods are inherently discrete and have only limited capabilities for interpolation between locations.
﹛to overcome these limitations  schwaighofer and colleagues  showed how to apply gaussian processes to signal strength localization  resulting in a model that provided interpolation over continuous locations with direct modeling of uncertainty from the training data.  ferris et al.  1  extended this technique to wifi localization by combining the gp signal strength model with graph-based tracking  allowing for accurate localization in large scale spaces. our wifislam technique builds on these recent models and extends them to the case of mapping with unknown locations.
﹛the robotics community has developed various approaches for slam  see  thrun et al.  1 . however  these techniques typically rely on the ability to sense and match discrete entities such as visual landmarks or obstacles detected by sonar or laser range-finders. compared to these approaches  our slam problem is particularly challenging  since we have only very limited information about the person's motion  and since signal strength measurements vary extremely smoothly over the location space. in principle we could extract distance to access point estimates from signal strength measurements and then apply range-only slam  newman and leonard  1  to map the locations of access points. however  such techniques typically rely on rather accurate range measurements  which are clearly not available in our context.
﹛the wifi-slam problem can be seen as an applicationspecific case of the general dimensionality reduction problem. specifically  we wish to reduce high-dimensional signal strength to some two-dimensional location space. unfortunately  dimensionality reduction algorithms such as pca do not typically perform well with highly non-linear manifolds such as those found in wifi signal propagation. a very promising class of techniques extend non-linear dimensionality reduction methods to allow the specification of additional constraints that reflect the generative model of the underlying data process. one such technique is action respecting embeddings  are   bowling et al.  1   which extends semidefinite embedding  sde  by placing additional constraints on the sde similarity matrix. specifically  when the same control action  e.g.  robot motion  is applied to two different points in the latent space  their successive latent points should share a similar relative transformation. while are could be used in our context to represent time-series constraints between successive signal strength readings  we wish to more generally constrain higher level properties of the underlying generative process.
﹛a powerful technique for representing such constraints is proposed in gaussian process dynamical models  wang et al.  1 . the technique extends gp-lvm by including an additional likelihood model for the latent-space variables. specifically  the technique models dynamic constraints via a gaussian process mapping between consecutive data points. though their technique was specifically designed for visionbased motion tracking  we have extended it for our wifislam approach.
1 gaussian process latent variable models
in this section  we will first describe gaussian processes for regression. we will then illustrate their application to estimating a likelihood model of wireless signal strength measurements  assuming that the ground truth locations of the training data are known. finally  we will show how gaussian process latent variable models can be used to handle the case of unknown locations.
1 gaussian processes
gps can be derived in different ways. here  we follow closely the function-space view described in  rasmussen and williams  1 . let our data  d =
{ x1 y1   x1 y1  dots  xn yn }  be a set of training samples drawn from a noisy process
﹛﹛﹛﹛﹛﹛﹛﹛yi = f xi  + 汍   1  where each xi is an input sample in q and each yi is a target value  or observation  in . the noise  汍  is assumed to come from a zero mean  additive gaussian distribution with known variance 考n1. for notational convenience  we aggregate the n input vectors xi into a n ℅ q design matrix x  and the target values yi into the n ℅ 1 vector denoted y. thus  xi and yi are vectors that correspond to the i-th row of x and y  respectively. in the context of signal strength maps  x represents locations in the 1d plane  and y represents signal strength measurements of a single wifi access point.
﹛a gaussian process estimates posterior distributions over functions f from the training data d. these distributions are represented non-parametrically in terms of the training points. a key idea underlying gps is the requirement that the function values at different points are correlated  where the covariance between two function values  f xi  and f xj   depends on the covariance between the two input values  some xi and xj. this dependency can be specified via an arbitrary covariance function  or kernel k xi xj . the choice of the kernel function is typically left to the user  the most widely used being the squared exponential  or gaussian  kernel: cov here  考f1 is the signal variance and l is a length scale that determines the strength of correlation between points. both parameters control the smoothness of the functions estimated by a gp. as can be seen in  1   the covariance between function values decreases with the distance between their corresponding input values.
﹛since we do not have access to the function values  but only noisy observations thereof  it is necessary to represent the corresponding covariance function for noisy observations: cov yr ys  = k xi xj  + 考n1汛rs .  1 
here 考n1 is the gaussian observation noise variance and 汛rs is one if r = s and zero otherwise. for an entire set of input values x  the covariance over the corresponding observations
y becomes
             cov y  = k + 考n1i   1  where k is the n ℅ n covariance matrix of the input values  that is  k i j  = k xi xj .
﹛note that  1  represents a prior over functions: for any set of values x  one can generate the matrix k and then sample a set of corresponding targets y that have the desired covariance  rasmussen and williams  1 . the sampled values are jointly gaussian with y ‵ n 1 k +考n1i . more relevant  however  is the posterior distribution over functions given training data x y. here  we are intrested in predicting the function value at an arbitrary point x   conditioned on training data x y. from  1  follows that the posterior over function values is gaussian with mean 米x  and variance:
 where
 1  k 1k   1 .
herethe nktraining inputs  is the n ℅ 1xvector of covariances between  and k is the covariance matrix ofx  and the inputs x. as can be seen from  1   the mean function is a linear combination of the training observations y  where the weight of each observation is directly related tox  and the correspondingk   the correlation between the test point training input. the middle term is the inverse of the covariance function  1 . the covariance of the function estimate  考x1   is given by the prior covariance  k x  x    minus the information provided by the training data  via the inverse of the covariance matrix k . note that the covariance is independent of the observed values y 1.
﹛finally  in order to get the predictive distribution for a noisy observation  y   one simply has to add the observation noise:
this predictive distribution summarizes the key advantages of gps in the context of wireless signal strength models. in addition to providing a regression model based on training data  the gp also represents the uncertainty of the prediction  taking both sensor noise and model uncertainty into account.

figure 1: gp model for signal strength of one access point. black dots indicate training data along the ground truth path.
1 application to signal strength modeling
gps have been applied very successfully to signal strength modeling  where the input values x correspond to locations  and the observations y correspond to signal strength measurements obtained at these locations  schwaighofer et al.  1; ferris et al.  1 . here  the gp posterior is estimated from a trace of signal strength measurements annotated with their locations. assuming independence between different access points  these techniques estimate a gp for each access point separately.
﹛fig. 1 illustrates the gp signal strength model for one access point in an environment of size 1 ℅ 1 meters  including hallways  offices  and open areas. fig. 1 clearly demonstrates that signal strength propagation cannot be represented adequately by a parametric sensor model such as one that estimates the location of an access point and then assumes a radial signal propagation model. the gp on the other hand  smoothly approximates the data points  see  ferris et al.  1  for details .
1 latent variable models
so far we have assumed that the locations x of the training data are observed. the goal of our research is to build gp signal strength maps without relying on location data. to build such maps  we treat the locations x as hidden  or latent  variables. the resulting  much more challenging problem can be addressed by gaussian process latent variable models  gp-lvm   which were introduced by  lawrence  1; 1  in the context of data visualization.
﹛in the previous section we treated different access points individually  resulting in a 1-dimensional observation space. here  it will be necessary to jointly consider the signal strength of multiple access points  which results in ddimensional observations yi  reporting the signal strength s of d access points. the traditional probabilistic approach to latent variable techniques models the relationship between latent variables  x   and a set of observed data  y  through the parameterized function
		 1 
where yij is the element from the i-th row and j-th column of y  xi is the vector formed from the ith row of x  wj are the parameters of the  possibly non-linear  functionis a zero mean noise term. this function  which is the same as  1  with explicit parameters  implies a probabilistic relationship between the latent variables and the data  p yij|xi wj . if independence is assumed across the dimensions and instantiations of the data this relationship factorizes as
	.	 1 
since the latent variables are unknown  they must now be dealt with. traditionally this is done through marginalization  necessitating the definition of a prior distribution. a common choice of prior is the normalized zero mean gaussian . since the noise is assumed to be drawn from a zero mean gaussian with a given variance 考n1  the parametric relationship between the latent variables and the data can then be recovered through optimization of the marginal likelihood. if the functional relationship between the latent variables and the data is linear  f xi;wj  = wjtxi    1 
then the marginal likelihood is of the form  tipping and
bishop  1 
	p y|w  = n y;1 wwt + 考n1i .	 1 
the likelihood of this model can then be maximized with respect to w with the result that w spans the principal subspace of the data  tipping and bishop  1 . in the context of wifi mapping  however  f xi;wj  is clearly non-linear and thus the marginalization to obtain  1  cannot be performed without reverting to approximations.
﹛in the gp-lvm an alternative approach is proposed. the gp-lvm is inspired from the bayesian point of view. in the bayesian approach  rather than maximizing the likelihood of the parameters  they are treated as latent variables and marginalized. unfortunately  even for the linear case we have just described  it is not possible to marginalize both the latent variables and the parameters. if we do not wish to turn to approximate methods we are therefore faced with a choice of what to marginalize: the latent variables or the parameters. in  lawrence  1; 1  it was shown that if the prior distribution for the parameters is gaussian  p wij  = n wij;1  
  then maximizing the likelihood with respect to x still leads to principal component analysis. for this case the marginal likelihood takes the form
	.	 1 
by comparison with  1  this is recognized as a product of gaussian process models with a linear covariance function. we can extend this model to arbitrary covariance relationships by considering the covariance defined via a kernel function  as in  1 . thus  maximizing  1  with respect to x determines the xij values that maximize the data likelihood assuming an underlying gaussian process model.
1 gp-lvms for wifi slam
we utilize the gp-lvm framework to probabilistically model the relationship between wifi signal strength readings y and their underlying positions x in the two-dimensional coordinate space. the likelihood of our model takes the form:
	p x y  = p y|x p x 	 1 
in the gp-lvm framework  p y|x  is modeled by a gp and p x  is the expression of our latent-space dynamics model. the set of constraints we discussed in the introduction of the wifi-slam problem are nicely captured within these terms  as we shall describe below.
location ↙ signal strength: we wish to constrain that similar locations should have similar signal strengths. this property is captured by most dimensionality reduction techniques  including gp-lvm. specifically  the gp used to model p y|x  provides this property  where the similarity of points in the latent space is controlled by the underlying kernel function. for the wifi case  we use the squared exponential kernel  1  with parameter values trained from previously labeled wifi training data.
location ↙ location: we wish to model the motion of the person collecting the mapping data. these constraints encompass the dynamics component of the gp-lvm. for the wifi case  we do not have strong odometry data  so we additionally constrain x against a generative model of a generic office building. remember that x is an n ℅ q design matrix  where each row xi is the latent position of the wifi readings yi. we model three constraints in our dynamics models:
  distance between successive positions
  change in orientation between successive positions
  alignment of parallel line segments
we represent the constraints as a conjunction of probabilities: p x  = p distance p orientation p alignment .  1 
to constrain the distance between successive points  we apply a simple time-series constraint based on a gaussian prior on walking velocity n 米v 考v   which results in p distance  =
here  忖i is the time difference between consecutive measurements. we also consider the change in orientation between successive points  where 牟i is the change in orientation between ui = xi   xi 1 and ui+1 = xi+1   xi. we assume that for a general office environment  most time will be spent walking in a straight line along hallways  with periodic intersections. we place a prior on change in orientation as a zero-mean gaussian with sigma 考o. thus  we can model the likelihood of latent locations against our orientation model as
	p orientation  =.	 1 
we finally consider the alignment constraint. the intuition behind this constraint is that when a trace visits the same hallway twice  there will be two roughly parallel paths that should be aligned. to model this constraint  we consider the probability that two segments u = xi ↙ xi+1 and v = xj ↙ xj+1 are parallel as p parallel  = n 牟;1 考  where 牟 is the relative orientation between the two segments. we only align parallel segments which are already close to each other  as captured by p dp   1  where dp is the perpendicular distance between the two segments  measured in meters. the inequality is modeled as the likelihood that n dp 考1  is less than n 1 考1   defined as
.	if both segments
are parallel and close by  we constrain their separation distance to zero as p separation  = n dp;1 考 . thus  our full alignment constraint is
p alignment  = p parallel p dp   1    p separation .  1 
all told  we have defined the conjunction of three probabilistic models constraining distance  orientation  and alignment of latent space coordinates to provide p x  as the dynamics model. when combined with the gp model of p y|x   we have defined our full probability model. however  we have one constraint left.
signal strength ↙ location: we wish to constrain that similar signal strength readings should be mapped to similar locations. note that this constraint is only reasonable in dense wifi environments such as offices and urban areas. this constraint is not provided by default in gp-lvm. however  lawrence and quinonero-candela   demonstrate the use of back constraints to constrain local distance in y to local distances in x. back constraints are implemented as a smooth internal mapping of x = g y 耳  where 耳 is a set of mapping parameters. the smoothness of the mapping ensures that nearby points in y are also nearby in x.
﹛finally  we optimize the marginalized latent positions x by minimizing the negative log-likelihood of our full gp-lvm likelihood model p x y . we can do this efficiently with conjugate gradient-descent  where the gradient of the loglikelihood can be evaluated with respect to each element of x. performance is improved and local minima avoided if we initialize the starting point of the descent with a reasonable value. in our case  we apply isomap to generate an acceptable initialization. we will contrast the results of isomap with the full gp-lvm in the results section.
1 experimental results
our experimental evaluation consists of collecting a series of wifi signal-strength traces  generating a sensor model and map using the wifi-slam technique  and then crossvalidating the model by localizing the remaining traces and considering the error.
﹛we collected three traces over one floor of a university building. traces ranged in length from 1 meters to half a kilometer. traces were collected with an ipaq hand-held  a standard wifi card  and a click-to-map-based annotation program for establishing ground truth location. as seen in the ground truth path in fig. 1  traces included three loop closures and multiple trips through each hallway. for each trace  we initialized gp-lvm with an isomap embedding of x  which  as also seen in fig. 1  does a reasonable job of recovering the overall structure of the wifi trace. however  the embedding lacks finer resolution that would make it possible
	 	 	 

figure 1: comparison of ground truth gaussian process versus that constructed by gp-lvm.
to easily establish the topological connectivity graph for later localization. we will demonstrate these finer features in our gp-lvm results.
﹛we see in the final plot in fig. 1 the result of the latent space optimization of gp-lvm. the plot shows clear definition of intersections  correct alignment of paths  and a strong topographical similarity to the ground truth trace. we had similar results for our other test traces  though they are not displayed here for brevity. the plot also demonstrates the current limitations of our approach. the ground truth trace includes a non-right-angle intersection  which is simplified as a right angle in our gp-lvm result. while we have no explicit angular constraint in our motion model  the constraint emphasizing straight and aligned paths tends to prefer a grid like structure in the resulting map.
﹛given the resulting latent-space optimization  it is trivial to extract an intersection connectivity graph from this representation. the resulting graph and the gp sensor model produced as by-product of gp-lvm are immediately applicable to the task of bayesian localization  as described in  ferris et al.  1 . in fig. 1  we see a comparison of a gp sensor model resulting from the ground truth locations and a gp model resulting from the optimized gp-lvm latent space. we present these results as a demonstration that the two models are quite similar  suggesting our optimized latent space is reasonable.
﹛to evaluate localization accuracy  we cross-validated each gp-lvm result by performing localization using the remaining two test traces. since the mapping from the latent coordinate system x to the underlying ground truth coordinate system is not well-defined  we evaluated localization accuracy using the metric described in  bowling et al.  1 . specifically  to determine the location in the ground truth coordinate system  we find the closest training point in the latent space to our current location and use its ground truth location as our own location. put differently  whenever a person returns to a previously visited location  we estimate how accurately our system can detect this event.
	 	 		 
										 	 		 	 
figure 1: the results of an gp-lvm run for one of our traces. while the isomap result  center  shows general structure  the gp-lvm result  right  has clearer correspondence with the ground truth trace  left .﹛we calculated the mean localization error over six localization runs to be 1 ㊣ 1 meters. while the localization accuracy is not as high as those achieved with techniques based on labeled calibration data  the fact that reasonably accurate localization can be performed without any labeled training data indicates the success of our technique.
1 conclusion
we have a demonstrated a method for addressing the wifislam problem. the key idea of our approach is to apply gaussian process latent variable models  gp-lvm  in order to estimate the locations of wifi signal strength readings collected by a person walking through a building. gplvms provide a powerful framework for jointly modeling constraints on wifi signal strength measurements and on a person's motion. we have shown that gp-lvms in combination with a simple dynamics model can reconstruct topographically-correct connectivity graphs and gp sensor models that can be used directly for wifi localization.
﹛wifi-slam serves as a promising solution to the problem of collection and maintenance of wifi sensor models for large-scale localization. in our future work  we wish to integrate additional sensors  such as accelerometer  digital compass  and barometer  to increase the accuracy of our technique. we additionally wish to extend mapping into more complex office environments  enhancing our ongoing research in desktop and mobile activity recognition.
acknowledgments
the authors thank aaron hertzmann for useful discussions. this work has partly been supported by darpa's assist and calo programmes  contract numbers: nbch-c-1  sri subcontract 1 .
