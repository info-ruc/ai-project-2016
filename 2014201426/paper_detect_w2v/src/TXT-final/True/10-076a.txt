 
       the data s t r u c t u r e that d r i v e s the general probl em solver is the connection table. this paper describes the t h e o r e t i c a l basis for the a u t o matic c o n s t r u c t i o n of t h i s table by computer p r o grams. the programs f o r t h i s purpose have been developed at the case western reserve u n i v e r s i t y . they b a s i c a l l y i s o l a t e c e r t a i n a t t r i b u t e s of the problem states which are i n v a r i a n t under c e r t a i n moves and then put those a t t r i b u t e s together to   t r i a n g u l a r i z e   the connection table. 
d e s c r i p t i v e terms 
　theory of h e u r i s t i c s   general problem solver 1 . 	i n t r o d u c t i o n 
       according to our view of mechanical problem s o l v i n g   there are a number of d i f f e r e n t problem s o l v i n g methods each of which has problem dependent parameters. for each method there is a cond i t i o n which s p e c i f i e s the p r o p e r t i e s the paramet e r s should have in order f o r the method to  work . hence  we view problem s o l v i n g as the two phase process shown in figure 1. in the f i r s t phase  the method's c o n d i t i o n is used to generate  good  parameters f o r the method. the input to t h i s phase is the problem s p e c i f i c a t i o n   since the parameters are u s u a l l y problem dependent. the output is e i t h e r good parameters or an i n d i c a t i o n t h a t t h i s method should not be used on the given problem. the second phase attempts to solve the problem  as s p e c i f i e d at the input to the f i r s t phase  using the method w i t h the parameters generated in the f i r s t phase. of course  there is a dicture l i k e figure 1 f o r each method  and if the 
f i r s t method is not a p p l i c a b l e   we merely move on to the next method and attempt to use i t . 
       so f a r   a l l the methods s t u d i e d t h i s way  coray  1   ernst 1   banerj1   seem to depend on the r e c o g n i t i o n of c e r t a i n a t t r i b u t e s of the problem s t a t e s which remain i n v a r i a n t under some of the moves. we have p r e v i o u s l y published two r e p o r t s on the design and implementation of a program which would i s o l a t e some of these a t t r i butes on the basis of the problem d e s c r i p t i o n  ernst e♀a l 1    oyen 1    . 
       our present e f f o r t deals w i t h the combination of the i n v a r i a n t p r o p e r t i e s to y i e l d the connect i o n table of gps  newell & simon 1   ernst & n e w e l l   1 1     . our e f f o r t s in using our previous theory   e r n s t   1 1     f o r the purpose of mechanizing the h e u r i s t i c were not s u c c e s s f u l   because a 
d i f f e r e n c e  good or bad  was a binary r e l a t i o n between states and sets of s t a t e s   i . e .   a subset of s x 1s where s is the set of problem s t a t e s   which is a complicated concept. 
in an attempt to s i m p l i f y matters we s a i d   
 what if a d i f f e r e n c e were j u s t a set of s t a t e s     in t h i s case  a s t a t e s possesses d i f f e r e n c e d  if s i d. with t h i s simple view we can v i s u a l i z e 
gps's s t r a t e g y as f o l l o w s  figure 1   . 

1. find a path from so to some state s 	d. 
1. find a path from s to some state s1 e d1 but the path must be entirely inside d. 
1. find a path from s1 to s o m e state s e w but the path must be entirely inside d'. 
in step 1 gps is removing the most d i f f i c u l t d i f ference d. in step 1 the second most d i f f i c u l t difference is being removed without reintroducing d. the easiest difference w is being removed in step 1 without reintroducing either d or d'. 
　　　a point ought to be made here about the o r i g inal gps which was a somewhat more general device than the one we are describing here in that  

 'i♀i:re 1 while removing an easier difference  a more d i f f i c u l t difference could get reintroduced. the only search pruning involved in this general case was that involved in the relevance of moves to differences  vide u l t r a   . the extra constraint we have introduced here  and one which also characterizes our previous work  ernst 1    constrains the search for greater efficiency  while at the same time it neglects a certain class of solutions. our present analysis follows the same line. 
　　it is probably somewhat counterintuitive that the most d i f f i c u l t difference contains a l l of the other differences as subsets. one would normally think that the larger the set of states  the easier it would be to  get  inside of i t . also  one does not normally think of w as a difference. but this somewhat unintuitive picture works quite well. 
consider  for example the fool's disk problem. 
figure 1 gives the i n i t i a l state of the fool's disk problem  in which there are 1 concentric disks each containing 1 numbers. 	these numbers line up so as to form 1 columns radiating from the center of the disks. 	a move consists of rotating one of the disks independently of the others. 	the desired state is one in which each of the 1 radial columns sums to 1. 

figure 1 
the i n i t i a l state in the fool's disk problem 
     this problem f i t s the above picture exactly. d' is the set of states in which each diameter sums to 1  while d is the set of states in which the sum of the n  e  s  and w radii is 1. to keep the path from s  to s1 in d  gps only considers moves which rotate disks 1＜. to get from s1 to s 1   gps rotates disks by 1＜ only. 
     one might be disturbed that each difference contains a l l of the easier differences. this is not a d i f f i c u l t y   because any set of differences not possessing this property can be converted to differences which have this property.  in fact  our theory  banerji &. ernst  1   does not require this  nesting  of differences.  consider  for example  the 1 disk tower of hanoi in which we are trying to move a l l disks to peg p1. let d. be the set of states in which disk i is on p1 where disk 1 is the largest disk. then  one might think 
*of using d   d1  and d1 as differences for this problem. these are essentially the differences that were given to gps for this problem. certainly these sets are not perfectly nested. however  this set of differences can be converted to the above picture by intersecting them together  i . e .   d   d     d' =dd1 n d     and w 1 n d1  d1 n d1 n dx. 
   a more disturbing feature of this set of d i f ferences is that they are only useful when the set of desired states is w. in the original gps  as well as in our previous work  the same set of d i f ferences served to characterize a l l subgoals including  make such and such a move applicable.  this is not the case anymore. i f   for example  the set of desired states is the domain of the 
operator which moves disk 1 from p1 to p1  the d1 seems to be a useless set of differences. the d i f f i c u l t y is that we have  built  w into the d i f ferences. we did this on purpose to simplify the differences to allow mechanization. our original theory had differences as binary relations bet-
ween states and sets of states. if we specify the latter to be w  then we are l e f t with a monadic relation on states which is just a set of states. but how are we going to accommodate goals other than w  
   the key to answering this question is that not only w but also the domains of operators can be the goals of subproblems. since the number of operators is usually quite small  we w i l l use a d i f -

problem-so1vinr -1: banerj   
1 

ferent set of differences for the domain of each ween s and t. the higher i i s   the larger the operator being the goal of a subproblem. difference i s .    these modifications were introduced in our theory of gps to make it easier for person or 
machine to discover  good  differences. an added advantage of the modified gps is that it can easi l y handle problems in which the sets of differences for subproblems with different desired states are truly different. 
   the above discussions w i l l   we hope  serve as a motivation for the changes we have introduced in the theory. we do not plan to give a formal counterpart to these motivations or exhibit a for-
mal connection between the old and the new theories. instead  we shall exhibit and motivate the new theory ab i n i t i o so that readers unacquainted with our previous work w i l l find the discussion self-contained. we shall  of course  assume that the reader has had former acquaintance with gps  ernst & newell 1. 
     in the next section we give a formal d e f i n i tion of good differences. this is followed by an example of good differences and how they are used by gps. section 1 characterizes the class of solutions that gps can find given the kind of d i f ferences described in section 1. 
1  	definition of good differences 
     since gps builds its solution to a problem by setting up subproblems  we cannot build this theory by defining what a problem is but rather by defining a larger structure in which a class of subproblems can be embedded. also  this structure should contain the concepts which reflect the idea of differences and the connection table. we shall call this structure the problem domain   domain  for short. as in the previous models  we start with a set s of states and a subset w of s  consisting of winning states. we also have a set c of partial functions  mapping subsets of s into s  which we shall call moves or operators. if f e g is a move  we shall denote by sf i t s domain of def i n i t i o n   i . e .   states where f is an applicable 
move. since subgoals in gps have the form  make move f applicable   these sf  for various members f of g  serve as winning sets for subproblems just as w serves for a problem. the class of a l l these sets  w and sf for various f  we shall call x. for each set in this class we also define the d i f ferences which allow gps to work on them. that i s   for each t e x  t being either w or sf for some f e g  we define a class of sets t j   t     t1 .. t n with the property that tj n t n...t n  = t. the actual number n of specified differences of course depends on the set t chosen. so  instead of writing n we shall write n t  when there is any doubt as to which subproblem we are talking about. also  for reasons of convenience of discussion we shall often give the name tq to t and call s i t s e l f   t n   t   + 1 . 
　　it may be appropriate at this point to point out that the t  catches the idea of difference in that when a state s i t i $ a difference exists betpromerr -sol v 
　　　the next important concept in gps  of course  is that of relevance of a move to a difference. the major assumption on which gps theory is based is that a solution can be obtained by removing the higher   more d i f f i c u l t     differences before the lower differences and never reintroducing higher differences once they are removed. a d i f ference is considered higher than others  if fewer moves are available to remove i t . of course  s or t n   ' t   + i a r e the most d i f f i c u l t differences to remove  since no move changes a state to a nonstate. let h1 c g be the set of moves which  
when applicable  affects the position of the state with respect to t1. instead of making the very strong assumption that moves in h1 bring a l l states outside t1 into t   we shall make the more realistic assumption that these moves remove the states from ti when applied. this assumption seems  backward  to many  in spite of the fact that in most real problems  relevance of moves does appear that way and was used that way even in the original gps. in our difference-finding program  a state is characterized by giving the values of certain attributes for the state. a winning state is characterized by specifying that some of the attributes should have specific 
unique values. to find mechanically that a certain move is relevant to a certain difference t.  
we test whether the move changes the values of those attributes which characterize t.. 
　　　it is this  property-changing  characterization for moves which gives relevance the backward appearance. of the various values to which the attribute can change  only one characterizes the win states. hence  it is not to be expected that merely changing the value of a property yields a win value. on the other hand  if it already has a win value  changing it certainly changes it to a non-win value. 
     another important characteristic we demand of the moves in w＼  called triangularity of the d i f ference table in the previous theory  is that hi does not affect the differences higher than ti  
i . e .   is irrelevant to tj for j   i. thus  once a state is in t i   as long as we use moves in hj with j   i  t＼ w i l l not be reintroduced. 
　　　this effort shows up nicely in the difference transformation tables of gps. if we arrange the ti's from top to bottom in decreasing order of i and the h. from left to right in decreasing order  and mark the   i   j   cell with a 1 if moves in hj are relevant to t＼t then the upper right half of the table w i l l be blank. tables of this nature 
we call triangular tables  and differences which give rise to triangular tables we call good d i f ferences . 
　　　we define the maximum difference between t and s  m s  t   to be i i f s 1 t＼ and s t tj for a l l j greater than i. 
n p - 1 : 	banerjl 
1 
　　　implicit in the above definitions is an ordering of the t＼  and the hi  which corresponds to the difference ordering of gps. the most diff i c u l t difference is t n   while the easiest d i f ference is t＼. gps's basic problem solving strategy is to work on hard differences f i r s t and easy differences last. gps accomplishes this  as discussed in section 1  by using the following to guide its search: 
a state is a 1 place vector whose components are the monkey's position  the box's position  and the contents of the monkey's hand. 
a win is a state in which the bananas are in the monkey's hand. 
 walk  climb  push  grab  

1 to reduce the maximum difference t-j  use only operators in h . 
1 suppose a subproblem were generated to reduce difference t i 1 then do not use the operators in hj   i   j   n to solve the subproblem. 
rule si was in our previous theory. note that there may be many other operators besides h. which are relevant to t  because we have placed no conditions on hj for j   i. si causes gps to ignore such hj even though some of i t s operators may be relevant to tj . 
　　　the purpose of s1 is to require subproblems to be easier than the problem for which they are created. in our previous theory this was accomplished by requiring the differences of a problem to be harder than the differences of its subproblems. this is no longer possible  because we cannot compare subproblem differences to problem d i f ferences because they w i l l have different goals and hence different differences. however  s1 can be used  because a l l differences are reduced by the same operators. note that s1 is applied recursively. that i s   suppose fl and f1 are the sets of operators according to s1 that cannot be used on subproblems sp1 and sp1  respectively. if sp1 is a subproblem of sp1  then gps w i l l not use any operator in fl u f1 to solve sp1  because  the restrictions on spl are passed down to a l l of i t s subproblems. 
1. an example of good differences 
　　　the definitions above appear quite formidable and somewhat unlike gps. a simple example w i l l clarify things. for our example we have chosen that old chestnut about the monkey and the bananas  a formulation of which is given in figure 
1. we have chosen this example because it has  non-trivial  good differences  subproblems are created in solving i t   and it is simple. 
　　　one way to formalize the differences above is by positing that there is a separate table of connections for each goal which is either w or the domain of an operator. 	figure 1 illustrates monkey and bananas this way. 	the l's indicate which operators are relevant to which differences. 	the o's indicate irrelevance. 	a move is neither r e l evant nor irrelevant - we use a question mark. note that the bottom row heading of each table is just the goal and that each row is a subset of the row above i t . 	although our theory does not require these properties  they make things easier to visualize as discussed at the beginning of 
walk the monkey walks to someplace in the room. climb the monkey climbs onto the box  i . e .   the monkey's position becomes onbox. climb is applicable only when the monkey's position equals the box's position. push the monkey pushes the box to some in the room. push is applicable only when the monkey's position equals the box's position. grab the monkey grabs the bananas. 	grab is applicable only when the monkey is on the box  and the box is under the bananas. figure 1 
a formulation of the monkey and bananas problem 
section 1. 
　　　the row headings are the tj  in the d e f i n i tions of section 1  and the column headings are the hi. the definitions of the ta and the hi require that the tables of connection are triangular in the sense that the main diagonal and a l l entires above it are 1. in addition  the subdiagon-
al  the diagonal immediately below the main diagonal  contains a l l l ' s . 
　　　walk is a total function on s  hence i t s domain is s. we do not need a table of connections for such an operator  because a subproblem of getting into its domain w i l l never be created. we included the table of connection for walk in figure 1  because the degenerate case of a d e f i n i tion often helps one understand the definition. 
　　　if a column of an operator is a l l 1's  then that operator w i l l never remove a state from the 
goal set and w i l l never transform a state outside the goal set into the goal set. an a l l 1 row i n -
dicates that no operator w i l l add or remove a state to the t  which labels the row. 
　　　the above is an example of  difference i n formation  which satisfies our definition of good in section 1. the most important feature of the tables in figure 1 is that the triangularity constraint orders the rows  and the columns . this row ordering is the difference ordering - d i f f i cult differences are at the top of a table  and easy differences are at the bottom. of course  there may be several different row orderings 

prohler-solvin -1: 	banerj  u1 


figure 1 
　the table of connections for each goal in monkey and bananas 
which gives rise to a triangular table  in which case any one of them w i l l satisfy our formal def i n i t i o n of good. 
　　　now we can describe how gps solves monkey and bananas using the difference information in figure 1. suppose that in the i n i t i a l state s1 the 
monkey's hand is empty and the box is not under the bananas. then the largest difference  m s1 w   is that the monkey's hand is empty  hence gps 
attempts to apply grab. but so i sgrab  hence gps sets up the subprobiem of transforming s1 into sgrab  b u t grab cannot be used in solving the subproblem because of rule s1. 
　　　to solve the subprobiem  gps attempts to reduce the difference that the box is not under the bananas since this is m so  sgrat     hence  gps attempts to apply push which is not applicable  and the subprobiem of transforming sq into spush is generated  but s1 restricts the solution of this subprobiem to the operators walk & climb. the remaining part of solving this problem is quite straightforward and similar to the way the 
usual gps works. 
1. 	totally-ordered solutions 
　　　the above discussion raises the question   can gps solve a l l problems which have a solution   the answer is no  which can be shown quite easily   because'the differences  together with rules si and s1  prevent gps from looking at sequences of operators that may be necessary to find a solution. hence  the question becomes   can we somehow characterize the class of problems 
problem-sol ving;-1: banerj i 
1 



a solution whenever a triangular difference table exists; one has to be blessed with a totally ordered solution - totally ordered by the ordering 
mechanically or otherwise chosen in the connection table. we have had various problems in which more than one triangular connection table exist  and yet one can prove that some of the connection tables would not yield a solution. this problem has appeared in other  seemingly closely related  garbs in planning programs for robots  leading to the work on non linear plans  sacerdoti 1  . the analogous problem in our formalization would be the detection of the nonexistence of totally or-
dered solutions. one approach  that of the detection of  factorable subproblems   goldstein 1   
w i l l be reported on at a future date. 
1. 	acknowledgement s 
　　　the work described in this paper was supported by the national science foundation under grant mcs 1 to the case western reserve university. the preparation of the paper was partially supported by them under grant mcs1-1 to temple university. 
