
qualitative reasoning about mereotopological relations has been extensively investigated  while more recently geometrical and spatio-temporal reasoning are gaining increasing attention. we propose to consider mathematical morphology operators as the inspiration for a new language and inference mechanism to reason about space. interestingly  the proposed morpho-logic captures not only traditional mereotopological relations  but also notions of relative size and morphology. the proposed representational framework is a hybrid arrow logic theory for which we define a resolution calculus which is  to the best of our knowledge  the first such calculus for arrow logics.
1 introduction
intelligent agents sensing or exchanging information about the physical world need ways to represent and reason about space. for instance  humans navigating new areas may build 'cognitive maps' of the environment  redish  1   robots engaged in a soccer game may use monte-carlo-localization based on probabilistic representations from the raw sensory data  thrun et al.  1   and crawlers analyze web pages using relative position and size  such as in the lixto system  gottlob and koch  1   to index the pages. in fact  the way space is represented and reasoned upon varies tremendously depending on the nature of the agents and on their tasks.
모a paramount criterion for representing space is that of having an agile language able to capture basic qualitative aspects of space and providing simple reasoning mechanisms for making diagrammatic deductions. in this line is the study of part-whole and topological relationships for describing qualitative aspects of region connections. this study  known as mereotopology  has been widely investigated by philosophers  logicians and  recently  computer scientists. the best known proposal in the ai literature is the region connection calculus  rcc   randell et al.  1 : a calculus of regions based on 1 basic qualitative mereotopological relations. with rcc one may express that a region is contained into another one  that it overlaps with another one or that it is disconnected. reasoning is left to composition tables for determining the spatial relations among regions given the binary relations.
모in general  one wants more from spatial reasoning. a way of achieving more is that of considering the logic of some theory of space and then perform deduction using the logic's inference mechanisms.  bennett  1  showed that a decidable fragment of rcc can be embedded into a multimodal logic. in general  one is interested in logical theories of space: tarski's axiomatization of elementary geometry is the most successful example and is the motivation for the recent effort of considering logical theories of space  see  aiello et al.  1  for a wide set of spatial and spatio-temporal logics .
모our goal in the present treatment is to consider a logical approach to qualitative spatial reasoning that  without giving up on the mereotopological expressiveness  is also able to capture prominent morphological and geometrical properties of space. to fulfill this goal we turn our attention to a nifty mathematical theory.
모mathematical morphology  mm   developed in the 1s by matheron and serra for creating methods for the estimation of ore deposits  matheron  1; serra  1   underlies modern image processing  where it has a wide variety of applications. compared with classical signal processing approaches it is more efficient in image preprocessing  enhancing object structure  and segmenting objects from the background. the idea behind mm is that one can find objects with different properties by probing an image with so called 'structuring elements'. although serra and materhorn developed their theory for binary images  morphological operators exist for both grey scale and color images as well.
모the connections between mathematical morphology and logic were recently highlighted by bloch et al. for both spatial reasoning  bloch  1  and agent coordination  bloch and lang  1 ; while in  aiello and van benthem  1   we spelled out the connections with arrow and linear logics.
모we dig into the connections hinted in these works. we show how mathematical morphology sheds a new light on spatial reasoning by considering a novel encoding into hybrid arrow logic and by providing a complete reasoning method for the introduced logic. our proposal is not 'yet another modal rcc encoding' as the language we introduce is more expressive than rcc. for instance  we show that our morphologic is able to express the concept of relative size which is not expressible in rcc and which introduces a new notion of granularity. similarly to aiello and van benthem and differently from bloch  in our representation worlds are points in space  rather than abstract worlds  allowing to reason on actual images. in  aiello and van benthem  1  we presented only the initial connections among mm and modal logic with no further study  here we take it to the next step and turn mathematical morpho-logic into a powerful spatial reasoning tool. finally  we remark that the proposed logic increases the expressive power in the direction of morphology and vector spaces  and not towards incidence or projective geometries as in  e.g.   balbiani et al.  1 .
모the remainder of the paper is organized as follows. in section 1  after recalling basic mm definitions  we introduce the morpho-logic and show how to take advantage of its expressive power. in section 1 we introduce a resolution calculus for the morpho-logic which we implemented in haskell. final considerations are presented in section 1.
1 mathematical morpho-languages
honoring the mathematical in the name  mathematical morphology has an algebraic base  heijmans and ronse  1 . its two basic operators  the dilation and the erosion  work on a complete lattice. for example  the p ir1  together with the subset relation constitutes a complete lattice. dilation is an operator that distributes over the supremum  while erosion distributes over the infimum. given a group of automorphisms  translations  in a complete lattice  l 뫞  and a supgenerating subset l   l one can create a group structure on l  g :=  l +   e . using this group  the translation invariant dilation and erosion can be written in the following manner
dilation	 1  erosion	 1 
모an example of a dilation is shown in figure 1 where a binary image containing a region denoting india is dilated by a small disk region. applying the dilation and erosion successively  one can create the so called opening and closing. an opening is an erosion followed by a dilation with the same structuring element and is used to remove connections between regions. a closing is a dilation followed by an erosion with the same structuring element and is used to fill holes of a certain size in a region. if one then considers the group g for binary images  one is actually dealing with the vector space
1
ir . in this way  one sees how mathematical morphology is also a language for vector spaces.
1 morpho-logic
arrow logic is a form of modal logic where the objects  rather than being possible worlds  are transitions structured by various relations  venema  1   in particular there is a binary modality for composition of arrows and a unary modality for the inverse of an arrow. an arrow usually has the following structure w =  a b  with a the beginning of the arrow and b the end. such a language naturally models a vector space which  in turn  is the most intuitive underlying model of mathematical morphology. the connections between arrow logics and mathematical morphology were first highlighted in  aiello and van benthem  1 . let us first recall the basic arrow logic with its truth definition.
definition 1  arrow logic  let prop be a set of proposition letters  then the well-formed formulas f of the arrow logic are:
f := p|e|  |  뫈 뷍|   |  뷍 
where p 뫍 prop  e is a distinguished identity element  and   뷍 뫍 f
a model consists of a set of arrows  a ternary  a binary and unary relations  and a valuation function.
wdefinition 1  arrow logic semantics is a tuple뫄 w 뫄 w c r i 뷄w  r   w  뫄in whichw and뷄 : propiw is a set of arrows wan. furthermore arrow modelc뷄m is
a valuation function such that	 . the tuple
 w c r i  is called frame. the truth of formulas is defined in a model at a given arrow w in the following way  omitting the usual base case and boolean connectives .
iffiff  w  뫍 i such that there exists a and
		iff	there exists	such that
and
 thus  a formula of the form     is true in a modelv that one canm on a world w if and only if there exists a world 'reach' from w using the relation r such that v satisfies  . in the same manner  a formula of the form    뷍 is true in a model msuch thaton a world w if and only if there exist two worldsare connected via the relation
c  v satisfies satisfies 뷍. for a concrete example of arrow models  showing the link between vector spaces and mathematical morphology  consider the meaning of addition for the   eoperator  of vector negation for the  i.e.     and of identity vector to
   x y z  뫍 c if x = y + z
   x y  뫍 r if x =  y
   x  뫍 i if x = e
모in this way the definition of the interpretation of   뷍 goes from

to being

where we have lifted the valuation function to the formulas. considering the set defined by the dilation definition  equation 1   one appreciates the similarities with the interpretation of   뷍 using vectors. in axiomatizing the language such that the relations behave as described above  the axiom x +   x  = e poses a problem because it is not valid for arbitrary subsets of the universe. only if the subsets are singletons  the axiom is true. to avoid this problem and finally arrive to usual vector spaces  we introduce a set of nominals which provide the expressive power to differentiate among worlds  that is  among arrows. we thus have the power to force a singleton set. we are entering the realm of hybrid logics.
모where in modal logic there is no explicit reference to the world at the language level  in hybrid logic instead one can refer to specific worlds in a model. the nominals are labels for the elements of w. if syntactically  the nominals have the same function as propositions; semantically  nominals have the restriction that the valuation function maps a nominal to a singleton set. furthermore  the language contains the satisfaction operator  i   with the intuitive meaning of bringing the valuation of the formula   to the world labeled i  i.e.  a world that satisfies i.
모in addition  in a group the operation + must be defined for every pair of elements  i.e.   x y z s.t. z = x + y. thus we need a way to quantify over the set of worlds. this can be done by introducing the universal modality e. where in normal modal logic a formula is inherently local  modal logic extended with the universal modality has the power to talk about the entire model. for example  a formula of the form e  is true in a model if   is true somewhere in the model. note that the validity of a formula does not neccissarily depend on where in the model a formula is evaluated. the dual  u means that a formula must be true everywhere in the model.
모we are now in the position to define the morpho-logic. the morpho-logic is a theory in the hybrid arrow logic whose axioms are shown in table 1. we present it as an extension of the arrow logic of definition 1 in the following way.
definition 1  morpho-logic  let atom = prop뫋nom be a set of proposition letters and names  then the well-formed formulas f of the morpho-logic are:
모모모모f := a|e|  |  뫈 뷍|   |  뷍| i |e  where a 뫍 atom  i 뫍 nom and   뷍 뫍 f.
definition 1  morpho-model  a model m is a morphomodel if m is a model according to definition 1  with 뷄 extended to the nominals in such a way that 뷄 i  is a singleton set for every i 뫍 nom.
the semantics defined in definition 1 is straightforwardly extended by introducing truth definitions for the at   operator and for the nominals as follows:
	iff	w 뫍 뷄 a  with a 뫍 atom
	iff	there exists a v 뫍 w such that
	m v	i and m v
	iff	there exists a	such that
	 v	 
we note that the   operator becomes superfluous because one can define it using e  however  for readability we shall use the   operator.
remark 1  notation  we overload the terms dilation and erosion from mathematical morphology to the morpho-logic and define them as  respectively.
 ass1  i뇱 뇲 뫸 i j뇲  ass1 i  j k  뫸  i j  k comm i j 뫸 j i rev1     i  뫸     j  rev1     j  뫸     i  rev1 i   i 뫸 e rev1 e 뫸 i   i id1 i e 뫸 i id1 i 뫸 i e total ei 뫇 ej 뫸 ei j unique  ij1 j1  kj1 j1 ik	 	 	 	 
		뫇		뫸
table 1: the morphological axioms.
모having defined the morpho-logic and its axioms  the next natural question to ask is what are the laws which the operators of the morpho-logic obey. the answer comes from looking at their mathematical morphological counterparts. we do not report here the full axiomatization of the hybrid arrow language as it can be found in  de freitas et al.  1   but rather report the new axioms with morphological significance  table 1 .
remark 1  notation  as a point of notation  we use khal for the axiomatization of the hybrid arrow-logic.
모of all the axioms presented in table 1  the axiom  rev1  and  rev1  are the most notable ones. the purpose of the axioms is to give the relations c  r and i a group semantics. one of the group axioms is x +   x  = e. the algebraic counterpart of  the + operator lifted to the complex group of operates on sets  and 
only holds if a is a singleton. in axiom  rev1  and  rev1   the nominals represent the singleton sets. this is best seen by looking at the atoms as sets of worlds. since the set belonging to a nominal must be a singleton set we have met the precondition of the group axiom.
모we are now ready to state the completeness result and sketch its proof. here  by completeness we mean that given a set of frames f a set of axioms 붦 is complete with respect if for each formula   it is the case that f |=   implies
 .
theorem 1  completeness  the axioms presented in table 1  together with khal and the extended set of derivation rules  are complete with respect to the set of frames defined by the axioms in table 1.
proof. first  we note that the axioms in table 1 are pure formulas. then  we remark that every pure formula is dipersistent. generalizing theorem 1.1 in  cate  1  to the hybrid arrow logic  we have that the axioms are complete for the family of frames they define. qed
1 expressive power and qsr
the morpho-logic combines the power of talking about relational structures from a local perspective  typical of modal languages  with expressing global properties using the nominals to 'jump' globally from one point to another in the models  typical of hybrid ones.

figure 1: finding the ec  relation between china and india.
모let us now consider the expressive power in terms of qualitative spatial reasoning  qsr . the morpho-logic is able to express topological and morphological properties of points and regions. first  we turn our attention to the best-known example of topological calculus  the region connection calculus  randell et al.  1 . the rcc language uses the primitive c x y  holding among two regions x y if x and y are connected and then derives a number of relations indicating the overlapping  the being part or being disconnected of regions. in the morpho-logic  the concept of connectedness is encoded using dilations: two regions a and b are connected if a c overlaps with b. c denotes the notion of connectivity that is being used. in discrete binary images for example this could be 1- or 1-connectivity. one can define rcc-like relations  denoted with a terminating    using the morphologic as shown in table 1 where e is the existential modality defined as dual of the universal one: e  :=  u  .
dc  x y u  x 뫇 y ec  x y e   x c  뫇 y   뫇 u  x 뫇 y po  x y eu x y뫇뫸y x뫇    u x 뫸 y 뫇  x =  yu x   y tpp  x y uu x  뫸x yc  뫇  뫸uy  y 뫸 x 뫇  ntpp  x y uu   xx뫸 cy  뫸뫇  yu   y 뫸 x 뫇tp  1 x y uu y  뫸y xc  뫇  뫸ux  x 뫸 y 뫇  ntpp  1 x y uu   yy뫸 cx   뫇  xu   x 뫸 y 뫇모let us now consider an example in the domain of binary images using the rcc relations as defined via the morphologic. for instance  we want to check whether india and china are neighboring countries  i.e.  in the ec  relation  in the map shown in figure 1.a. suppose that china and india are denoted by the propositions 'china' and 'india'  figure 1.b and figure 1.c  respectively . then  we can consider the dilation of the india region by a relatively small disc c 	뫸
table 1: rcc-1 relations in the morpho-logic.
 figure 1.d .1 finally  considering the region denoted by  india c 뫇china  figure 1.e   we see that it is not empty  thus the image  the model  verifies the ec  relation and we safely conclude that indeed india and china are indeed neighboring countries.
모interestingly  one can use the geometric expressive power in the morpho-logic to go beyond mere topological relations and thus being more expressive than rcc. in fact  taking advantage of the dilation operation  one is able to define a notion of relative size. we say that x is smaller than y  and write st x y  if
st x y  = ei 뫇  tpp  x i y  뫈 ntpp  x i y  
where and tpp  and nttp  are the rcc tangential proper part and non-tangential proper part  respectively. this definition of smaller than takes advantage of the fact that a dilation with a singleton set is equivalent to a translation. in plain words  the region x is smaller than region y  if there exists a translation such that x is a proper part of y.
1 reasoning via resolution
the morpho-logic is an expressive formalism to represent spatial properties of points and regions of space capturing topological and morphological content. the next natural question to ask is how one can use it to reason about space. we introduce a resolution calculus for the morpho-logic that is also  to the best of our knowledge  the first resolution procedure for an arrow language.
1 resolution for reasoning in the morpho-logic
resolution is a refutation theorem-proving technique  bachmair and ganzinger  1 . if in model checking one works with a specific model and verifies whether a formula is true  in theorem proving one is concerned with verifying whether there is a model for a formula. in a refutation theorem prover the goal is to show that there is no model for its negation. before introducing the resolution calculus for the morpho-logic in the next section  we consider how theorem proving sheds light on mathematical morphology logical view on reasoning about space and benefits mathematical morphology in return.
모in traditional spatial reasoning calculi  such as rcc or allen's one dimensional interval calculus  cohn and hazarika  1   a paramount task is that of defining composition tables for the calculi relations. a composition table is a compact representation for assessing which relation holds among two locations based on knowledge of other relations. for example  suppose that there is a relation r1 between location a and b  and a relation r1 between b and c. the entry in the composition table tells us which relations are possible between a and c. composition tables are created resorting to human reasoning  an ad-hoc program performing exhaustive search  or a theorem prover. a successful example of the latter is bennett's use of resolution for reasoning with rcc relations encoded in intuitionistic logic  bennett  1 . by having resolution for the morpho-logic it is also possible to create composition tables for morphological relations. not only  it is also possible to check dynamically the validity of formulas and the composition of any two given relations expressible in the morpho-language.
모conversely  a resolution based theorem prover is also a powerful tool in the hands of the mathematical morphology expert. in mathematical morphology one of the typical tasks is that of identifying filters  verify their formulation  and then test experimentally their effectiveness on collections of images. for example  the salt-and-pepper filter  used to filter out noise from an image  is known to be idempotent. the task of design and verification of the filter is based on the expertise of the mathematical morphology scientist. with a resolution based theorem prover the verification of filter properties can be automated. furthermore  if one couples the theorem prover with a formula generator  one has a way of identifying new and potentially useful filters.
1 the resolution calculus
the resolution calculus for the morpho-logic builds on the fact that nominals are available  making it possible to perform resolution recursively inside the modal operators. resolution rules can be applied to clauses. a clause is a set of formulae and it is true if one of the formula in the clause is true. we extend the resolution calculus for the basic hybrid logic presented in  areces et al.  1  by means of the additional rules shown in tables 1  1  1. this calculus uses the assumption that all the formulas present in the clauses are given in negated normal form  i.e. only atoms can occur in the scope of a negation. the first set of rules  table 1  deals with the binary  and unary    modalities  where the symbol   is the dual of   and is defined as   뷍 =        뷍 . equiva-
 
lently     is the dual of     and is defined as     =       . the second set of rules  table 1  takes care of the universal modalities e and u. finally  the third set of rules  tables 1  1  deals with the axioms of the morpho-logic  definition 1 .
모in the case of morpho resolution  we have that a clause is a set of formulas of the form  i . as usual  the semantics of a clause is the disjunction of its elements. the resolution calculus then works on the clauses by applying the morpho resolution rules. given a set of formulas s =  1 ...  n  this

table 1: morpho resolution rules for the morpho modalities.

table 1: resolution rules for the universal modality
is satisfiable if and only if the set of clauses  i 1 ... i n is satisfiable. formally  we have the following definition of morpho resolution.
definition 1  morpho resolution  given    a refutation by morpho resolution of   is a sequence of morpho clauses
c1 ... cn such that for all i 뫍 {1..n} either
 1. ci is in    or
 1. ci is a resolvent of cj  ck according to a morpho rule where cn is the empty clause and a morpho rule is one of the rules in tables 1  1  1  or in  areces et al.  1 .
if there exists no such refutation    is satisfiable. we say that   is valid if there is a refutation of     i.e.     is unsatisfiable . we write    for a valid  .
모finally  we want to be sure that reasoning with the resolution calculus is correct and complete. the following theorem does the job. for the full proof we refer the reader to  ottens  1  and provide only a proof sketch here.
theorem 1  completeness  given a set of clauses  of the morpho-logic   is unsatisfiable if and only if there exists a refutation of  using the morpho resolution of definition 1.

table 1: morpho resolution rules for the morpho axioms i.
proof. the proof of refutational completeness works by showing that if there is no refutation  a model of  exists on which all the axioms are valid. qed
1 concluding remarks
driven by the mathematical morphology view of space  we introduced a language based on hybrid arrow logic to reason about space. the logic  which is a theory in the hybrid arrow logic defined by the axioms of table 1  is a powerful language to express morphological as well as mereotopological properties of space. to reason in the morpho-language we introduced a resolution calculus. to the best of our knowledge  this is the first resolution calculus for arrow logics. we proved completeness of our language and calculus  while leaving open for future research issues of complexity  renz and nebel  1 .
모we implemented the morpho resolution in haskell  http: //www.haskell.org  as an extension of the hylores theorem prover  areces and heguiabehere  1 . we used the theorem prover for the correctness of a number of theorems  including theorems based on the 'smaller than' definition of section 1 . we leave for future research the enhancement and evaluation of the implementation. the theorem prover is of particular usefulness when showing that the morpho-logic is not only interesting in ai for performing spatial reasoning  but is also a tool for the computer vision expert that needs to check  or perhaps even generate  new morphological filters.
ackowledgements
we thank marta cialdea mayer and the anonymous reviewers for suggestions and comments improving the presentation of the paper; rein van den boomgard  yde venema  carlos  comm 
  for i occurs in  
 total  and j occurs in뷍
 unique 
table 1: morpho resolution rules for the morpho axioms ii.
areces  and rosalie iemhoff for fruitful discussions. brammert ottens thanks illc  isla  and oi of the university of amsterdam for providing travel funding for participating in ijcai-1. finally  we thank schahram dustdar for hosting the authors at the distributed systems group  tuwien while the presented research was performed.
