 
object identification-the task of deciding that two observed objects are in fact one and the same object-is a fundamental requirement for any situated agent that reasons about individuals. object identity  as represented by the equality operator between two terms in predicate calculus  is essentially a first-order concept. raw sensory observations  on the other hand  are essentially propositional- especially when formulated as evidence in standard probability theory. this paper describes patterns of reasoning that allow identity sentences to be grounded in sensory observations  thereby bridging the gap. we begin by defining a physical event space over which probabilities are defined. we then introduce an identity criterion  which selects those events that correspond to identity between observed objects. from this  we are able to compute the probability that any two objects are the same  given a stream of observations of many objects. we show that the appearance probability  which defines how an object can be expected to appear at subsequent observations given its current appearance  is a natural model for this type of reasoning. we apply the theory to the task of recognizing cars observed by cameras at widely separated sites in a freeway network  with new heuristics to handle the inevitable complexity of matching large numbers of objects and with online learning of appearance probability models. despite extremely noisy observations  we are able to achieve high levels of performance. 
1 	introduction 
object identification-the task of deciding that two observed objects are in fact one and the same object-is a fundamental requirement for any situated agent that reasons about individuals. our aim in this paper is to establish the patterns of reasoning involved in object identification. to avoid possibly empty theorizing  we couple this investigation with a 
   'this work was sponsored by jpl's new traffic sensor technology program and by california path under mou 1 and 1. 
1 	probabilistic reasoning 
real application of economic significance: identification of vehicles in freeway traffic. each refinement of the theoretical framework is illustrated in the context of this application. we begin with a general introduction to the identification task. section 1 provides a bayesian foundation for computing the probability of identity. section 1 shows how this probability can be expressed in terms of appearance probabilities  and section 1 describes our implementation. finally  section 1 presents experimental results in the application domain. 
1 conceptual and theoretical issues 
the existence of individuals is central to our conceptualization of the world. while object recognition deals with assigning objects to categories  such as 1 toyota celicas or adult humans  object identification deals with recognizing specific individuals  such as one's car or one's spouse. one can have specific relations to individuals  such as ownership or marriage. hence  it is often important to be fairly certain about the identity of the particular objects one encounters. 
　formally speaking  identity is expressed by the equality operator of first-order logic. having detected an ob-
ject c in a parking lot  one might be interested in whether c = mycar. because mistaken identity is always a possibility  this becomes a question of the probability of identity: p c=mycar  all available evidence . there has been little work on this question in ai.1 the approach we will take  section 1  is the standard bayesian approach: define an event space  assign a prior  condition on the evidence  and identify the events corresponding to the truth of the identity sentence. the key step is the last  and takes the form of an identity criterion. once we have a formula for the probability of identity  we must find a way to compute it in terms of quantities that are available in the domain model. section 1 shows that one natural quantity of interest is the appearance probability. this quantity  which covers diverse domain-specific phenomena ranging from the effects of motion  pose  and lighting to changes of address of credit applicants  seems to be more natural and usable than the usual division into sensor and motion models  which require calibration against ground truth. 
   'in contrast  reasoning about category membership based on evidence is the canonical task for probabilistic inference. proposing that mycar is just a very small category misses the point. 
1 application 

figure 1: images from two surveillance cameras roughly two miles apart on highway 1 in sacramento  california. the top image is from the upstream camera  and the bottom image is from the downstream camera. the boxed vehicle has been identified at both cameras. 
the authors are participants in roadwatch  a major project aimed at the automation of wide-area freeway traffic surveillance and control  malik and russell  1 . object identification is required for two purposes: first  to measure link travel time-the actual time taken for traffic to travel between two fixed points on the freeway network; and second  to provide origin/destination  o/d  counts-the total number of vehicles traveling between any two points on the network in a given time interval. the sensors used in this project are video cameras placed on poles beside the freeway  figure 1 . the video streams are processed at each camera site by vehicle tracking software running on customized parallel hardware. the resulting streams of chronologically ordered vehicle reports are sent to the tmc  traffic management center . the tmc uses these reports to determine when a vehicle detected at one camera has reappeared at another. these matches are used to build up a path for each vehicle as it travels through the freeway network. the set of paths can be queried to compute link travel times and o/d counts as desired. the output of the system is a traffic information display  updated in real time for use by traffic operations managers or by individual drivers. 
　obviously  a license-plate reader would render the vehicle identification task trivial  but for political and technical reasons  this is not feasible. in fact  because of very restricted communication bandwidth  the vehicle reports sent to the tmc can contain only about one hundred bytes of information. in addition  the measurements contained in the reports are extremely noisy  especially in rainy  foggy  and night-time conditions. thus  with thousands of vehicles passing each camera every hour  there may be many possible matches for each vehicle. this leads to a combinatorial problem-finding most likely consistent assignments between two large sets of vehicles-that is very similar to that faced in data association  a form of the object identification problem arising in radar and sonar tracking. section 1 explores this connection in more detail. we adopt a solution from the data association literature  but also introduce a new  leave-one-out  heuristic for selecting reliable matches. this  together with a scheme for online learning of appearance models to handle changing viewing and traffic conditions  yields a system with performance good enough for practical deployment  section 1 . 
1 	inferring identity from observations 
this section shows how the probability of identity can be defined in terms of physical observations and events. we begin with the formal framework and then illustrate it in the traffic domain. 

   1 for the purposes of this paper  we will assume that each observation corresponds to exactly one physical object. this assumption can be relaxed  at the cost of introducing into the theory the mechanism whereby objects generate observations. 
   1 one is tempted to write this as p a = b o   ... o    i.e.  to condition on a conjunction of the  positive  observations. however  conditioning on the positive observations is not the same as conditioning on both positive observations and negative observations-that is  observations of no vehicles at a given time and place. the temptation therefore reflects a natural  semi-closed-world  assumption: one assumes that the stated positive observations are all that have been made in the past  and that all other observations were negative. obviously  one does not make this assumption regarding the future. 
	huang & russell 	1 


1 	probabilistic reasoning 


	huang & russell 	1 


figure 1: diagram showing observed upstream and downstream x-position data for a sample of 1 matched vehicles from the mack road and florin road cameras. the horizontal axis corresponds to upstream x-position and the vertical axis corresponds to downstream x-position. each marked point corresponds to a single matched vehicle. lane dividers are shown as horizontal and vertical lines. for example  1 vehicles are observed in lane 1  onramp  highest x values  upstream  of which 1 end up in lane 1  middle lane  downstream  indicating that 
1 online learning of appearance models 
because traffic and lighting conditions change throughout the day  our system uses online  recursive  estimation for the appearance probability model parameters. as new matches are identified by the vehicle matcher  the parameters are updated based on the observed feature values at the upstream and downstream sites. figure 1 shows a sample set of x values for matched vehicles  from which can be estimated. similarly  figure 1 shows a sample set of hue values for matched vehicles  from which can be estimated. to adapt to changing conditions  our system uses online exponential forgetting. for example  if a new match is found for a vehicle in lane xu upstream and lane xd downstream  with link travel time t  then the mean travel time is updated as follows: 

the r parameter  which ranges from 1 to 1  controls the effective  window size  over which previous readings are given significant weight. 
the above assumes that the match found is in fact correct. 

figure 1: diagram showing observed upstream and downstream hue data for a sample of 1 matched vehicles from the mack road and florin road cameras. the horizontal axis corresponds to upstream hue  and the vertical axis corresponds to downstream hue. the appearance probability for color  which includes hue  saturation  and value components  is modeled as a multivariate gaussian. 
the core of the approach is the observation  from  cox and 
hingorani  1   that a most probable assignment  pairing all n vehicles  can be found in time 1 n1  by formulating the problem as a weighted bipartite matching problem and using any of several well-known algorithms for this task. to do this  we construct an association matrix m of appearance probabilities  where each entry so that the assignment with least total weight in the matrix corresponds to the most probable assignment  according to eq.  1 . 
　for our purposes  knowing the most likely assignment is not enough. it can easily happen that some c of the n vehicles are all very similar and fairly close to each other on the freeway. in this case  there will be c! assignments all having roughly the same probability as the most probable assignment. since matches within this group may be very unreliable  we employ a leave-one-out heuristic that  forbids   in turn  each match contained in the best assignment. for each forbidden match  we measure the reduction in likelihood for the new best assignment. matches whose forbidding results in a significant reduction are deemed reliable  since this corresponds to a situation where there appears to be no other reasonable assignment for the upstream vehicle in question. 
for example  suppose we have the following matrix: 

in practice  we can never be certain of this. a better motivated approach to model updates would be to use em; this can be approximated by weighting each update by the probability that the match is correct. 
1 	matching algorithm 
we begin by describing the simplest case  where all vehicles detected at the upstream camera are also detected downstream  and there are no onramps or offramps. in this case  the aim is to find pairs of vehicles a and b such that for some small  this problem is intractable in the worst case  it relates to computing the permanent of a matrix   so we adopt a heuristic approach. 
1 	probabilistic reasoning 

we accept the a=x match  since no other reasonable choice seems to exist. on the other hand  if we forbid b = z  the best assignment has weight 1. if 1 - 1 =t  then we reject b=z  since there is another match for b that yields a good overall assignment. by increasing the threshold t  we obtain more reliable matches  i.e.  the error rate e is reduced; however  this reduces the overall number of accepted matches. 
1 new and missing vehicles 
in the general case  vehicles can appear from onramps between the cameras or can disappear onto offramps.  equivalently  they can fail to be detected at the upstream or downstream camera.  to handle this  we add extra rows and columns to the association matrix. with m upstream and n downstream vehicles  the matrix now has m + n rows and columns to allow for all possibilities. figure 1 illustrates the structure of the matrix for m = n = 1. here  is the probability that a vehicle exits the freeway  is the number of vehicles entering the freeway between the cameras per unit time  and p oi  refers to the prior probability of seeing a vehicle with features oi1 the formulas in the table explain the interesting fact that human observers feel far more confident matching unusual vehicles than typical vehicles: not only is the probability of confusion with other vehicles lower  but the probability that the upstream vehicle exited  only to be replaced by another vehicle of the same unusual appearance  can be discounted because the extra multiplicative p{oi  factor for an unusual vehicle would be tiny. 

figure 1: extended association matrix for two upstream and downstream observations  showing additional rows and columns to account for entering and exiting vehicles. each entry will be replaced by its negative logarithmic value before computing the minimum weight assignment. 
1 	relationship to data association 
the vehicle matching problem is closely related to the traditional  data association  problem from the tracking literature  in which new  observations*'  from the downstream camera  must be associated with already-established  tracks   from the upstream camera . radar surveillance for air traffic control is a typical application: the radar dish determines an approximate position for each aircraft every few seconds  and each new set of positions must be associated with the set of existing tracks. there is a large literature on data association- 
assignment and the observations given the best assignment with a forbidden match. 1 in our implementation  each of these models is learned online; and are also specific to individual lanes. 
typically over 1 papers per year. the standard text is by barshalom and fortmann  bar-shalom and fortmann  1   and recent developments appear in  bar-shalom  1 . ingemar cox  cox  1  surveys and integrates various developments  deriving formulas very similar to those in figure 1. cox's aim in his review paper is to present the ideas from the data association field to the computer vision and robotics community  where they might be used to resolve problems of identifying visual features seen in temporally separated images. 
　major differences between our work and  standard  data association include the following: 
1. sensor noise and bias are large  unknown  time-varying  site-dependent  and camera-dependent  and sensor observations are high-dimensional. 
1. successive observations of a vehicle are widely separated in time and space  and all observations are asynchronous. 
1. vehicle trajectories are highly correlated. 
1 	results 
we tested the vehicle matcher with data from a region-based vehicle tracker on video sequences from the sites in figure 1. 
　on any given run  the number of matches proposed by the vehicle matcher depends on the reliability threshold selected for that run. in the results discussed below  coverage refers to the percent of vehicles observed by both cameras for which matches were proposed  and accuracy refers to the percent of proposed matches that were in fact correct. in general  the coverage goes down as the reliability threshold is increased  but the accuracy goes up. 
　to verify the accuracy of the matcher  the ground-truth matches were determined by a human viewing the digitized sequences with the aid of a frame-based movie viewer. since this method required about 1 hours of viewing to match each minute of video  it was used only during the early stages of testing. in subsequent testing  we first ran the matcher on the vehicle report data and then used the frame-based movie viewer to verify whether the suggested matches were correct. testing our system involved a start-up phase during which it estimated the appearance probability models online. for the results shown in figure 1  we trained our system on a pair of 1-second video sequences and then ran it on the immediately following 1-second sequences. the sequences contained 1 vehicles upstream  along with numerous vehicles that either entered or exited the freeway in between the cameras. the resulting accuracy/coverage curve in figure 1 shows that despite very noisy sensors  the system achieved 1% accuracy with a coverage of 1%  and 1% accuracy with a coverage of 1%. incorporating additional features would probably improve system performance. the boxed vehicles in figure 1 show a pair of vehicles correctly matched by our system. 
　link travel times between each camera pair are currently calculated by averaging the observed travel times for matched vehicles. these times were accurate to within 1 % over a distance of two miles  over a wide range of coverage/accuracy tradeoff points. this suggests that matched vehicles are representative of the traffic flow-that is  the matching process does not select vehicles with a biased distribution of speeds. 
	huang & russell 	1 


figure 1: sample matching results: the graph shows accuracy versus coverage for a range of reliability threshold values. a low threshold implies high coverage and low accuracy  while a high threshold implies low coverage and high accuracy. 
　our results are comparable with those obtained by petty et al.  petty et a/.  to appear   who use an  ensemble  matching approach that detects downstream propagation of distinct arrival time patterns. the two approaches are complementary  in that our approach allows identification of individual vehicles  and hence the generation of o/d counts   whereas the petty et al approach provides a robust bootstrap method for initializing our arrival time models. 
1 	conclusions and further work 
this paper has described the patterns of reasoning involved in establishing identity from observations of objects. we proposed a formal foundation based on a prior over the space of physical events  together with an identity criterion defining those events that correspond to observations of the same object. in the case of vehicle matching  the events are the different sets of trajectories of vehicles in a given freeway network. when a single trajectory passes through two vehicle observations  that implies that the observations correspond to the same object. this general approach makes it possible to define the probability of identity and to integrate the necessary patterns of reasoning into an intelligent agent. 
　this research can be seen as another step in the carnapian tradition that views a rational agent as beginning with uninformative prior beliefs and then applying bayesian updating throughout its lifetime. the general relationship between perception and the formation of internal models is a subject that needs much more investigation  bacchus et al.  1 . 
　we showed that the abstract probability of identity can be expressed in terms of measurable appearance probabilities  which define how  when  or where objects that were observed at some point in the past are expected to appear at some point in the future. these appearance probabilities can be learned online to adapt to changing conditions in the environment- such as changing weather  lighting  and traffic patterns. 
　we have implemented and tested a system for vehicle matching using an efficient algorithm based on bipartite 
1 	probabilistic reasoning 
matching combined with a leave-one-out heuristic. despite very noisy feature measurements from the cameras  our system achieved a high level of accuracy in matching individual vehicles  enabling us to build the first reliable system for measuring link travel times. although experimental camera data were not available for the system to do so  it is already capable of tracking the path of a vehicle over a sequence of camera sites. thus  o/d counts for a time period can be computed by examining the complete set of recorded paths during that time period. for successful o/d measurement over a long sequence of cameras  however  we need to improve both matching coverage and the detection rate of the tracking subsystem. 
　the patterns of reasoning described here have broad applicability to other domains. for example  the object identification problem occurs in database management  where it is possible that two different records could correspond to the same entity. for example  us credit reporting agencies record over 1 million credit-using americans  of whom only about 1 to 1 million are actually distinct individuals. applying our approach to this problem could help with maintaining database consistency and with consolidating multiple databases containing overlapping information. 
