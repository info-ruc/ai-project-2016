
there has been a great deal of work on characterizing the complexity of the satisfiability and validity problem for modal logics. in particular  ladner showed that the satisfiability problem for all logics between k and s1 ispspace-hard  while for s1 it is np-complete. we show that it is negative introspection  the axiom  kp   k kp  that causes the gap: if we add this axiom to any modal logic between k and s1  then the satisfiability problem becomes np-complete. indeed  the satisfiability problem is np-complete for any modal logic that includes the negative introspection axiom.
1 introduction
there has been a great deal of work on characterizing the complexity of the satisfiability and validity problem for modal logics  see  halpern and moses  1; ladner  1; spaan  1; vardi  1  for some examples . in particular  ladner 1 showed that the validity  and satisfiability  problem for every modal logic between k and s1 is pspacehard; and is pspace-complete for the modal logics k  t  and s1. he also showed that the satisfiability problem for s1 is np-complete.
모what causes the gap between np and pspace here  we show that  in a precise sense  it is the negative introspection axiom:  k    k k . it easily follows from ladner's proof of pspace-hardness that for any modal logic l between k and s1  there exists a family of formulas  n  all consistent with l such that such that | n| = o n  but the smallest kripke structure satisfying   has at least 1n states  where | | is the length of   viewed as a string of symbols .

모모  this work was supported in part by nsf under grants ctc1  itr-1  and iis-1  by onr under grants n1-1-1 and n1-1  and by the dod multidisciplinary university research initiative  muri  program administered by the onr under grant n1-1. the second author was also supported in part by a scholarship from the brazilian government through the conselho nacional de desenvolvimento cient뫣 fico e tecnolo뫣gico  cnpq .
 
모모most of this work was done while the author was at the school of electrical and computer engineering at cornell university  u.s.a.by way of contrast  we show that for all of the  infinitely many  modal logics l containing k1  that is  every modal logic containing the axiom k-k  뫇 k     뷍    k뷍- and the negative introspection axiom  which has traditionally been called axiom 1   if a formula   is consistent with l  then it is satisfiable in a kripke structure of size linear in | |. using this result and a characterization of the set of finite structures consistent with a logic l containing k1 due to nagle and thomason 1  we can show that the consistency  i.e.  satisfiability  problem for l is np-complete. thus  roughly speaking  adding negative introspection to any logic between k and s1 lowers the complexity from pspace-hard to npcomplete.
모the fact that the consistency problem for specific modal logics containing k1 is np-complete has been observed before. as we said  ladner already proved it for s1; an easy modification  see  fagin et al.  1   gives the result for kd1 and k1 that the negative introspection axiom plays a significant role has also been observed before; indeed  nagle 1 shows that every formula   consistent with a normal modal logic1 l containing k1 has a finite model  indeed  a model exponential in | |  and using that  shows that the provability problem for every logic l between k and s1 is decidable; nagle and thomason 1 extend nagle's result to all logics containing k1 not just normal logics. despite all this prior work and the fact that our result follows from a relatively straightforward combination of results of nagle and thomason and ladner's techniques for proving that the consistency problem for s1 is np-complete  our result seems to be new  and is somewhat surprising  at least to us! .
모the rest of the paper is organized as follows. in the next section  we review standard notions from modal logic and the key results of nagle and thomason 1 that we use. in section 1  we prove the main result of the paper. we discuss related work in section 1.
1 modal logic: a brief review
we briefly review basic modal logic  introducing the notation used in the statement and proof of our result. the syntax of the modal logic is as follows: formulas are formed by starting with a set 붯 = {p q ...} of primitive propositions  and then closing off under conjunction  뫇   negation      and the modal operator k. call the resulting language .  we often omit the 붯 if it is clear from context or does not play a significant role.  as usual  we define  뫈뷍 and     뷍 as abbreviations of     뫇 뷍  and   뫈뷍  respectively. the intended interpretation of k  varies depending on the context. it typically has been interpreted as knowledge  as belief  or as necessity. under the epistemic interpretation  k  is read as  the agent knows   ; under the necessity interpretation  k  can be read    is necessarily true .
모the standard approach to giving semantics to formulas in  is by means of kripke structures. a tuple f =  s k  is a  kripke  frame if s is a set of states  and k is a binary relation on s. a situation is a pair  f s   where f =  s k  is a frame and s 뫍 s. a tuple m =  s k 뷇  is a kripke structure  over 붯  if  s k  is a frame and 뷇 : s 뫄 붯 뫸 {true false} is an interpretation  on s  that determines which primitive propositions are true at each state. intuitively   s t  뫍 k if  in state s  state t is considered possible  by the agent  if we are thinking of k as representing an agent's knowledge or belief . for convenience  we define k s  = {t :  s t  뫍 k}.
모depending on the desired interpretation of the formula k   a number of conditions may be imposed on the binary relation k. k is reflexive if for all s 뫍 s   s s  뫍 k; it is transitive if for all s t u 뫍 s  if  s t  뫍 k and  t u  뫍 k  then  s u  뫍 k; it is serial if for all s 뫍 s there exists t 뫍 s such that  s t  뫍 k; it is euclidean iff for all s t u 뫍 s  if  s t  뫍 k and  s u  뫍 k then  t u  뫍 k. we use the superscripts r  e  t and s to indicate that the k relation is restricted to being reflexive  euclidean  transitive  and serial  respectively. thus  for example  srt is the class of all situations where the k relation is reflexive and transitive.
모we write  m s  |=   if   is true at state s in the kripke structure m. the truth relation is defined inductively as follows:
 true
 m s  |=   뫇 뷍 if  m s  |=   and  m s  |= 뷍
 m s  |= k  if  m t  |=   for all t 뫍 k s 
모a formula   is said to be satisfiable in kripke structure m if there exists s 뫍 s such that  m s  |=  ;   is said to be valid in m  written m |=    if  m s  |=   for all s 뫍 s. a formula is satisfiable  resp.  valid  in a class n of kripke structures if it is satisfiable in some kripke structure in n  resp.  valid in all kripke structures in n . there are analogous definitions for situations. a kripke structure m =
 s k 뷇  is based on a frame and
. the formula   is valid in situation  f s   written  f s  |=    where f =  s k  and s 뫍 s  if  m s  |=   for all kripke structure m based on f.
모modal logics are typically characterized by axiom systems. consider the following axioms and inference rules  all of which have been well-studied in the literature  blackburn et al.  1; chellas  1; fagin et al.  1 .  we use the traditional names for the axioms and rules of inference here.  these are actually axiom schemes and inference schemes; we consider all instances of these schemes.
prop. all tautologies of propositional calculus
k.  k  뫇 k     뷍     k뷍  distribution axiom 
t. k       knowledge axiom 
1. k    kk   positive introspection axiom 
1.  k    k k   negative introspection axiom 
d.  k false   consistency axiom 
mp. from   and     뷍 infer 뷍  modus ponens 
rn. from   infer k   knowledge generalization 
모the standard modal logics are characterized by some subset of the axioms above. all are taken to include prop  mp  and rn; they are then named by the other axioms. for example  k1 consists of all the formulas that are provable using prop  k  1  mp  and rn; we can similarly define other systems such as kd1 or kt1. kt has traditionally been called t; kt1 has traditionally been called s1; and kt1 has traditionally been called s1.
모for the purposes of this paper  we take a modal logic l to be any collection of formulas that contains all instances of prop and is closed under modus ponens  mp  and substitution  so that if   is a formula in l and p is a primitive proposition  then   p/뷍  뫍 l  where   p/뷍  is the result of replacing all instances of p in   by 뷍. a logic is normal if it contains all instances of the axiom k and is closed under the inference rule rn. in terms of this notation  ladner 1 showed that if l is a normal modal logic between k and s1  since we are identifying a modal logic with a set of formulas here  that just means that k   l   s1   then determining if   뫍 l is pspace-hard.  of course  if we think of a modal logic as being characterized by an axiom system  then   뫍 l iff   is provable from the axioms characterizing l.  we say that   is consistent with l if    /뫍 l. since consistency is just the dual of provability  it follows from ladner's result that testing consistency is pspace-hard for every normal logic between k and s1. ladner's proof actually shows more: the proof holds without change for non-normallogics  and it shows that some formulas consistent with logics between k and s1 are satisfiable only in large models. more precisely  it shows the following:
theorem 1:  ladner  1 
 a  checking consistency is pspace complete for everylogic between k and s1  even non-normal logics .
 b  for every logic l between k and s1  there exists a family of formulas  ln  n = 1 1 ...  such that  i  for all n   ln is consistent with l   ii  there exists a constant d such that | ln| 뫞 dn   iii  the smallest kripke structure that satisfies   has at least 1n states.
모there is a well-known correspondence between properties of the k relation and axioms: reflexivity corresponds to t  transitivity corresponds to 1  the euclidean property corresponds to 1  and the serial property corresponds to d. this correspondence is made precise in the following well-known theorem  see  for example   fagin et al.  1  .
theorem 1: let c be a  possibly empty  subset of {t  1  1  d} and let c be the corresponding subset of {r t e s}. then {prop  k  mp  rn} 뫋 c is a sound and complete axiomatization of the language with respect to sc 붯 .1
모given a modal logic l  let sl consist of all situations  f s  such that   뫍 l implies that  f s  |=  . an immediate consequence of theorem 1 is that se  the situations where the k relation is euclidean  is a subset of sk1.
모nagle and thomason 1 provide a useful semantic characterization of all logics that contain k1. we review the relevant details here. consider all the finite situations   s k  s  such that either
1. s is the disjoint union of s1  s1  and {s} and k =  {s} 뫄 s1  뫋   s1 뫋 s1  뫄  s1 뫋 s1    where s1 =   if s1 =  ; or
1. k = s 뫄 s.
모using  a slight variant of  nagle and thomason's notation  let sm n  with m 뫟 1 and n 뫟 1 or  m n  =  1   denote all situations of the first type where |s1| = m and |s1| = n  and let sm  1 denote all situations of the second type where |s| = m.  the reason for taking -1 to be the second subscript for situations of the second type will become clearer below.  it is immediate that all situations in sm n for fixed m and n are isomorphic-they differ only in the names assigned to states. thus  the same formulas are valid in any two situations in sm n. moreover  it is easy to check that the k relation in each of the situations above in euclidean  so each of these situations is in sk1. it is well known that the situations in sm  1 are all in sk1 and the situations in sm  1 뫋sm 1 are all in skd1. in fact  s1  resp.  kd1  is sound and complete with respect to the situations in sm  1  resp.  sm  1 뫋 sm 1 . nagle and thomason show that much more is true. let t l =  뫋{sm n : m 뫟 1 n 뫟  1 or  m n  =  1 }  뫌 sl.
theorem 1:  nagle and thomason  1  for every logic l containing k1  l is sound and complete with respect to the situations in t l.
모the key result of this paper shows that if a formula   is consistent with a logic l containing k1  then there exists m n  a kripke structure m =  s k 뷇   and a state s 뫍 s such that   s k  s  뫍 sm n  sm n   t l  and m+ n   | |.
that is  if   is satisfiable at all  it is satisfiable in a situation with a number of states that is linear in | |.
모one more observation made by nagle and thomason will be important in the sequel.
definition 1 : a p-morphism  short for pseudoepimorphism  from situation  to situation   s k  s  is a functionsuch that
;
  if  s1 s1  뫍 k  then ;
  if  f s1  s1  뫍 k  then there exists some such that .

모this notion of p-morphismof situations is a variant of standard notions of p-morphism of frames and structures  blackburn et al.  1 . it is well known that if there is a pmorphism from one structure to another  then the two structures satisfy the same formulas. an analogous result  which is proved in the full paper  holds for situations.
theorem 1: if there is a p-morphism from situation 
  then for every modal logic
 .
now consider a partial order on pairs of numbers  so that
.	nagle and
 thomason observed that if   and   then there is an obvious p-morphism from   f s : if f =  s k   and
 are as in the definition of sm n   then define so that maps  and  if
s1   then f maps; otherwise  f maps to
s1 arbitrarily. the following result  which motivates the subscript  1 in sm  1  is immediate from this observation and theorem 1.
theorem 1: if   and
   then for every modal logic then  f s  뫍 t l.
1 the main results
we can now state our key technical result.
theorem 1: if l is a modal logic containing k1 and    /뫍 l  then there exist m  n such that m + n   | |  a situation
 f s  뫍 sl 뫌 sm n  and structure m based on f such that  m s  |=  .
proof: by theorem 1  if    /뫍 l  there is a situation  such that    . thus  there exists
a kripke structurebased on f such that 
suppose that  we are done  so suppose that. note that this means.
 1  1 	 	 	 	  	+	|  and  	  =
for some kripke structure based on f. this gives the desired result. the construction of m is similar in spirit to ladner's 1 proof of the analogous result for the case of s1.
모let c1 be the set of subformulas of   of the form k뷍 such that   and let c1 be the set of subformulas of   of the form k뷍 such that kk뷍 is a subformulaof   and
.  we remark that it is not hard to
show that if k is either reflexive or transitive  then c1 =  . 
모suppose that . for each formula k뷍 뫍 c1  there must exist a state such that
. note that if then.
define otherwise. let. note that
  so  then
kk뷍 뫍 c1  so there must exist a state such that . moreover  since   it must be the case that. let c1}. by construction   and s1 and s1 are disjoint. moreover  if s1 =    then c1 =    so c1 =   and s1 =  .
모let s = {s1}뫋s1뫋s1. define the binary relation k on s by taking k s1  = s1 and k t  = s1 뫋 s1 for t 뫍 s1 뫋 s1. in the full paper  we show that k is well defined; in particular  we show that  a  s1 뫍/ s1 and  b  if s1 뫍 s1  then s1 =  . we also show that k is the restriction of.
모let m =  s k 뷇   where 뷇 is the restriction of 뷇 to {s1}뫋s1뫋s1. it is well known  fagin et al.  1   and easy to prove by induction on    that there are at most | | subformulas of  . since c1 and c1 are disjoint sets of subformulas of    all of the form k뷍  and at least one subformula of   is a primitive proposition  and thus not of the form k뷍   it must be the case that |c1| + |c1| 뫞 | |   1  giving us the desired bound on the number of states.
모in the full paper we show  by a relatively straightforward induction on the structure of formulas  that for all states s 뫍 s and for all subformulas 뷍 of    including   itself    m s  |=
. the proof proceeds by induction on the structure of  .
by construction   f s  뫍 sm n  where m = |s1| and n =
|s1|. we havealready observedthat  and . thus  . it follows from theorem 1 that  f s  뫍 t l   sl. this completes the proof. 
모the idea for showing that the consistency problem for a logic l that contains k1 is np-complete is straightforward. given a formula   that we want to show is consistent with l  we simply guess a frame f =  s k   structure m based on f  and state s 뫍 s such that  f s  뫍 sm n with m+n   | |  and verify that  m s  |=   and sm n   t l. verifying that  m s  |=   is the model-checking problem. it is well known that this can be done in time polynomial in the number of states of m  which in this case is linear in | |. so it remains to show that  given a logic l containing k1  checking whether sm n   t l can be done efficiently. this follows from observations made by nagle and thomason 1 showing that that  although t l may include for infinitely many pairs  has a finite representation that makes it easy to check whether sm.n   t l.
say that  m n  is a maximal index of t l if m 뫟 1 
sm n   t l  and it is not the case thatfor some  with . it is easy to see that t l can have at most finitely many maximal indices. indeed  if  m n  is a maximal index  then there can be at most m+n 1 maximal indices  for if  is another maximal index  then either  for otherwise   contradicting the maximality of  m n  . say that m 뫟 1 is an infinitary first index of t l if sm n   t l for all n 뫟  1. similarly  say that n 뫟  1 is an infinitary second index of t l if sm n   t l for all m 뫟 1. note that it follows from
theorem 1 that if   then if m is an infinitary first index of t l  then so is m  and if n is an infinitary second index of t l  then so is n. suppose that m  is the largest infinitary first index of t l and n  is the largest infinitary second index of t l  where we take m  = n  =  if all first indices are infinitary  or  equivalently  if all second indices are infinitary   we take m  = 1 if no first indices are infinitary  and we take n  =  1 if no second indices are infinitary. it follows from all this that t l can be represented by the tuple  i m  n   m1 n1  ...  mk nk    where
  i is either 1 or 1  depending on whether s1 뫍 t l;
  m  is the largest infinitary first index;
  n  is the largest infinitary second index; and
    m1 n1  ...  mk nk  are the maximal indices.
given this representation of t l  it is immediate that sm n   t l iff one of the following conditions holds:
   m n  =  1  and i = 1;
  1 뫞 m 뫞 m ;
   1 뫞 n 뫞 n ; or
   m n  뫞  mk nk .
we can assume that the algorithm for checking whether a formula is consistent with l is  hardwired  with this description of l. it follows that only a constant number of checks  independent of    are required to see if sm n   t l.1
putting all this together  we get our main result.
theorem 1: for all logics l containing k1  checking whether   is consistent with l is an np-complete problem.
1 discussion and related work
we have shown all that  in a precise sense  adding the negative introspection axiom pushes the complexity of a logic between k and s1 down from pspace-hard to np-complete. this is not the only attempt to pin down the np-pspacegap and to understand the effect of the negative introspection axiom. we discuss some of the related work here.
모a number of results showing that large classes of logics have an np-complete satisfiability problem have been proved recently. for example  litak and wolter 1 show that the satisfiability for all finitely axiomatizatble tense logics of linear time is np-complete  and bezhanishvili and hodkinson 1 show that every normal modal logic that properly extends s1  where s1 is the modal logic that contains two modal operators k1 and k1  each of which satisfies the axioms and rules of inference of s1 as well as the axiom k1p   k1p  has a satisfiability problem that is np-complete. perhaps the most closely related result is that of hemaspaandra 1  who showed that the consistency problem for any normal logic containing s1 is also np-complete. s1 is the logic that results from adding the following axiom  known in the literature as d1  to s1:
d1. k k    뷍  뫈 k k뷍     
d1 is characterized by the connectedness property: it is valid in a situation   s k  s  if for all s1 s1 s1 뫍 s  if  s1 s1  뫍 k and  s1 s1  뫍 k  then either  s1 s1  뫍 k or  s1 s1  뫍 k. note that connectedness is somewhat weaker than the euclidean property; the latter would require that both  s1 s1  and  s1 s1  be in k.
모as it stands  our result is incomparable to hemspaandra's. to make the relationship clearer  we can restate her result as saying that the consistency property for any normal logic that contains k and the axioms t  1  and d1 is np-complete. we do not require either 1 or t for our result. however  although the euclidean property does not imply either transitivity or reflexivity  it does imply secondary reflexivity and secondary transitivity. that is  if k satisfies the euclidean property  then for all states s1 s1 s1 s1  if  s1 s1  뫍 k  then  s1 s1  뫍 k and if  s1 s1  and  s1 s1  뫍 k  then  s1 s1  뫍 k; roughly speaking  reflexivity and transitivity hold for all states s1 in the range of k. secondary reflexivity and secondary transitivity can be captured by the following two axioms: t

both t and 1 follow from 1  and thus both are sound in any logic that extends k1. clearly t and 1 also both hold in any logic that extends s1  since s1 contains t  1  and the inference rule rn. we conjecture that the consistency property for every logic that extends k and includes the axioms t  1  and d1 is np-complete. if this result were true  it would generalize both our result and spaan's result.
모vardi 1 used a difference approach to understand the semantics  rather than relational semantics. this allowed him to consider logics that do not satisfy the k axiom. he showed that some of these logics have a consistency problem that is np-complete  for example  the minimal normal logic  which characterized by prop  mp  and rn   while others are pspace-hard. in particular  he showed that adding the axiom k  뫇 k뷍   k   뫇 뷍   which is valid in k  to prop  mp  and rn gives a logic that is pspace-hard. he then conjectured that this ability to  combine  information is what leads to pspace-hardness. however  this conjecture has been shown to be false. there are logics that lack this axiom and  nevertheless  the consistency problem for these logics is pspace-complete  see  allen  1  for a recent discussion and pointers to the relevant literature .
모all the results for this paper are for single-agent logics. halpern and moses 1 showed that the consistency problem for a logic with two modal operators k1 and k1  each of which satisfies the s1 axioms  is pspace-complete. indeed  it is easy to see that if ki satisfies the axioms of li for some normal modal logic li containing k1  then the consistency problem for the logic that includes k1 and k1 must be pspace-hard. this actually follows immediately from ladner's 1 result; then it is easy to see that k1  viewed as a single operator  satisfies the axioms of k. we conjecture that this result continues to hold even for non-normal logics.
모we have shown that somewhat similar results hold when we add awareness to the logic  in the spirit of fagin and halpern 1   but allow awareness of unawareness  halpern and re go  1 . in the single-agent case  if the k operator satisfies the axioms k  1  and some  possibly empty  subset of {t 1}  then the validity problem for the logic is decidable; on other hand  if k does not satisfy 1  then the validity problem for the logic is undecidable. with at least two agents  the validity problem is undecidable no matter which subset of axioms k satisfies. we conjecture that  more generally  if the k operator satisfies the axioms of any logic l containing k1  the logic of awareness of unawareness is decidable  while if k satisfies the axioms of any logic between k and s1  the logic is undecidable.
모all these results strongly suggest that there is something about the euclidean property  or  equivalently  the negative introspection axiom  that simplifies things. however  they do not quite make precise exactly what that something is. more generally  it may be worth understanding more deeply what is about properties of the k relation that makes things easy or hard. we leave this problem for future work.
acknowledgments
we thank the ijcai reviewers for useful comments and for catching an error in the previous version of the paper.
