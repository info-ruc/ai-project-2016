s 
     the demand for second generation expert systems w i l l soon bring forward the demand for tools to build them. zdest-1 is b u i l t to test the authors' ideas on what characteristics such tools should have and how to reflect them consistently within a system. new concepts such as three-level control scheme and 1-d explanation are introduced;multiple representation methods and inference engines are offered and integrated. the most distinguished charact e r i s t i c s of zdest-1 are:  1  it is a general tool suitable for building various domain oriented expert systems ess .  1  the ess b u i l t by it can f u l l y reflect the nature of applicated domains.  1  welldeveloped environment is provided for the building and using of ess.  1  a user friendly interface is emphasized  explanations can be tailored to the elaboration needed  and  external procedure accesses are allowed. this paper gives a quite detailed description about how zdest-1 gains such characteristics. 
	i 	introduction 
     during the past decade  es technology has been developing rapidly  attracting a great number of researchers and cooperations. but s t i l l   it is f e l t that the f i r s t generation ess neglect the importance of simulating experts' problemsolving trains and the importance of meeting the needs of terminal users. thus begins the research on second generation es sges . to conform to this tendency  the problem challenging tool designers is how to build tools which are able to assist the procedure of building and using sgess. several important characteristics a sges w i l l have are discussed in c1. now as to the tools  what are their major charact e r i s t i c s   f i r s t of a l l   in order to have some background knowledge  let us examine what prior tools lack. prior tools pay l i t t l e attention to how to reflect the nature of problem domain. many tools are derived from domain-oriented ess  it is inevitable that they carry with them more or less features peculiar to application domain. other tools such as hearsay- 1 c1 and agec1  tend to be general aids  sacrifice efficiency to gain generality  so they are impractical to use. prior tools lack the intention to organize separate modules into a closely related tool set to provide l i f e long service for ess. domain experts t r y hard to f i n d tools providing good assistance to the use of ess  only to find those tools are not suitable for building their own ess. so we f e e l   future tools should have the following characteristics: f i r s t l y   they should 
have great f l e x i b i l i t y in combining v a r i ous different inference engines; secondly  ess b u i l t by them should f u l l y r e f l e c t the nature of application domain  the expert's reasoning trains and the ways expert giving explanation; thirdly they should be able to record rich-structured bookkeeping information for knowledge in order to support the maintaining and updating of sgess and to provide user friendly interface; and f o r t h l y   as the sges may be a sort of distributed problem-solving system  the tools should have the potentiality to build distributed systems. zdest-1 is b u i l t to explore the p o t e n t i a l i t y of having these characteristics within a system  in order to offer sgess l i f e long service. it results in a f a i r success. it has been used to build four ess from different domains: one for detecting blood defects  zclot ; one for repairing superheterodyne transistor radios  zrad ; one for prospecting mineral resources and estimating the quantity  zgpe ; and one for making up the best cotton composition for cotton 
mills  zcot . 
	i 	overview of zdest-1 
     according to the c l a s s i f i c a t i o n of c1  tools can be divided into several catalogs  and zdest-1 can be seen as a general system aid with well-developed supporting f a c i l i t i e s . zdest-1 has two d i s t i n c t functions. one is talking with experts interactively to extract domain knowledge and domain problem-solving procedures so as to build domain oriented ess. this process is called es building process. the other one is providing various supporting f a c i l i t i e s including 
tong  he and yu 
explanation based on 1-d t r u t h maintenance structure and meta-knowledge based knowledge base management to assist the using and maintaining of ess. 
     during es building process  by talking with domain experts i n t e r a c t i v e l y   zdest-1 gains knowledge about the conceptual structure of the domain  and builds upon that es components such as task  meta-ks and body-ks used by the es to be b u i l t . 
     task  meta-ks mks   body-ks bks  and inference engine are four main es component types  called es items. there is a comment frame associated with each item  which records control information and bookkeeping information relevant to the item. information in the comment frames is useful in scheduling the item or explaining the item's behavior. the comment frame is f i l l e d in under the guidance of the domain expert  and so the expert has the power of deciding the actual internal form of the es under the same three-level control architecture. 
     in order to gain the problem-solving efficiency and the capability of charact e r i z i n g application domain and to be generally applicable  we proposed the three-level control scheme.it is a general control architecture composed of planning  sketchy reasoning and concrete reasoning. it is a problem-solving architecture of es suitable for various application domains. a blackboard acts as the general data communication area  where es items record and look for needed data. 
     zdest-1 is currently running on vax1 and honeywell dps1  using franz lisp and lisp/1 respectively. i t s source code is about 1 lines long  not including the comment l i n e s   . ess b u i l t by it can be transferred to run on ibm pc. 
	ill 	es building process 
	the es building process 	is 	shown 	in 
|tjom un 
	 xp rtt  i 	t w f   n 
f i g . l  the single-line arrow indicates data flow  while the double-line arrow indicates control flow .at any time during es building process  zdest-1 is always in one of the following four es building stages:  1 conceptual structure descript i o n    1  es component description   1  knowledge acquisition   1  es refinement and assembly. the semantic and syntactic examination is performed from beginning to end for the purpose of eliminating errors occurred in es building process. 
a. 	conceptual structure description 
     conceptual structure is organized around concepts and context types  i n d i cating the property inheritance between context types. concepts stand for basic objects of the application domain  they are used to define problems  rules  goals and messages mentioned in es. context types describe the region within which certain concepts are applicable. context types themselves can be regarded as concepts which are applicable within certain regions  in other words  they are higher level concepts. for any application domain  the organization of conceptual structure may not be unique  it is influenced by the way experts intend to organize es components. 
     the properties of context types and concepts are recorded in the property l i s t associated with them.through the dialogue  expert enters the properties of each context type and concept. 
     part of the conceptual structure of zrad is shown in fig.1  where if  intermediate frequency   hf  high frequency  and lfa  low frequency amplifier  are context types  that i s   they are higher level concepts. the concepts which can be applied in lfa are tr1vc  the voltage of tr1 collector  itr the input transformer   otr  the output transformer  and so on. 


	f1. 1. 	 o#t of tk* c*notft *l structan j map 
	b. 	es component description 
     tasks  mkss  bkss and inference engines are es components  they are combined to form an executable es. the specificat i o n of them is done by f i l l i n g in the 
fi 1 .1. tht es bttiuma process comment frames associated with them and acquiring relevant knowledge pieces used by them. the comment frames have slots for 
	specifying 	the 	precondition 	of task 
1 	architectures and languages 

execution  relation between tasks  the meta rules used by mks  the peculiar inference engine used by ks  the domain rules used by ks  and so on  table 1  1 . 
table 1. comment frame of a bks of zclqt namei bcu knowledge form: production rules inference engine: goal-directed-inf context types: patient concepts included: finaldef . . . . rules: rule-1  rule-1  rule-1 father ks: mcu 
table 1. comment frync of an inf. engine name: goal-directed-inf glob parameters:  cntxt ddata qua-numb  cfcombine: cf-combine cfadjust: n i l usedby:  bcu  
description: this is a goal-directed inference engine  mycin like certainty measure is used. 
c. 	knowledge acquisition 
     during the es component description period  the related meta-knowledge and domain knowledge are acquired when mentioned. for the convenience of representation  three kinds of representat i o n methods are offered by zdest-1. 
	1. 	production rules 
     production rules can be expressed in simple expression language  sel  and restricted natural language  rnl . 
	a. sel-- sel uses concepts 	and 	their 
values as operands  predicates as operators to express logical relation between concepts and values. lisp expressions can be inserted in any place within a sel expression in case some operations exceed the representation power of sel. a rule of zrad expressed in sel is show as follows: 
if esc normal 1 ma  = ctfc   1 ma type  & con  o f f } 
then errmsg cl1t 
	  p r i n t l 	mc1 is through   
     b. rnl-- with the help of predicate description patterns  value function description patterns  acquired properties of concepts and a powerful pattern matcher  the production rules expressed in rnl can be translated without much difficulty.rnl can be extended dynamically by adding new predicate and value function description patterns. 
1. semantic networks 
	semantic 	network 	representation 	is 
also supported by zdest-1  a linear p a r t i tioned network representation language is provided. the implication relation is represented as a  space ci1  so in the logical l e v e l   the function of implication space is equivalent to that of production rule. this enables the easy transformation between them  makes it possible to allow the co-existence of knowledge represented in different methods. but u n t i l now  zdest-1 has merely allowed different kss to use different knowledge representation methods  while knowledge within a particu-
lar ks is encoded in the same form. 
1. procedure representation 
     zdest-1 also allows the knowledge to be represented in procedures written in franz lisp  fortran  pascal or c. external access a b i l i t y is very important to large problem solving a c t i v i t i e s . by this powerful characteristic  large systems containing tasks such as data processing  table drawing and others can also be b u i l t by zdest-1. 
d. 	es refinement and assembly 
     information and knowledge acquired during conceptual structure description  es component description and knowledge acquisition are stored in a data f i l e . the data f i l e describes the static organization of an es loosely. fig.1 shows the static organization of an example data f i l e . 

	f*1. 	es ttwns oryuu  in tkt m* jilt 
     because zdest-1 is a large tool set  it is composed of a great number of 
modules. for es to achieve high performance efficiency  a l l of the redundant modules and data must be discarded. after that  the newly b u i l t system is assembled and compiled into an executable es. the question answering module and knowledge base management module accompany the es  in order to support the possible future debugging  updating and maintaining. 
tong  he  and yu 

     since each ksj can select i t s own inference engine and representation method by choice  systems b u i l t by zdest-1 can be regarded as a combination of a number of the es cores by es core we mean the key components of an es  that i s   knowledge and inference engine   while different cores are different in representation or inference method or others. this distinguished characteristic strengthens the problem-solving capability of ess  attains great f l e x i b i l i t y for zdest-1 to build different types of ess  and also enables the reflection of domain nature. 
iv three level control architecture 
     ess b u i l t by zdest-1 use three level control scheme  which consists of planning period  sketchy reasoning period and concrete reasoning period  as the problemsolving architecture. 
     planning happens on task level. through dynamic planning  the execution sequence of tasks is dynamically ordered. during planning period  the scheduler controls the execution suspension of tasks according to the current control information in the blackboard and administers the interaction and message passing between tasks. this process is similar to the scheduling of control kss and domain kss 
by scheduler in blackboard control architecturec1. in blackboard control architecture  the scheduler activates control kss to determine the importance and necess i t y of executing certain domain kss  and then selects one to execute according to the current problem-solving strategy. such architecture has eight prominent charact e r i s t i c s   but it also has several severe disadvantages: f i r s t l y   the time used in scheduling is in proportion to the number of both control kss and domain kss; secondly  kss are r e l a t i v e l y independent  isolated components  the execution order of kss is purely opportunistic. but in app l i c a t i o n domain  expert's problem-solving procedure is often guided by i m p l i c i t t r a i n s   the relative order of some kss is determinable. so the es component  task  is introduced to administer several closely related kss cooperating to solve certain sub-problem  whose order can be determined when the task runs. the comment frames associated with tasks record a set of production rules used to describe the precondition of task execution or relation between tasks  and a set of production rules to describe the r e l a t i v e l y fixed dependency of mkss administered by the tasks. the function of planning period is to plan dynamically the task execution order in order to r e f l e c t the major problem solving steps taking by experts during problem solving. 
	each task controls several mkss. 	when 
1 	architectures and languages 
a task is chosen to run  the sketchy reasoning period starts. the comment frame associated with mks records the meta rules and meta inference engine. the role of mks is to make preliminary assessment of the sub-problem based on the clues already occurred on blackboard in order to choose the best suited lower level kss to run. for instance  it can determine useable rules used by lower level kss  modify the inference engines used by lower level kss and enable the execution of lower level kss. the idea of separating the sketchy reasoning process from the whole problemsolving process is also i n i t i a t e d by the goal of pursuing the s i m i l a r i t y of problem-solving between computer and domain experts  because many experts have the i n t u i t i o n of favoring one inference path while discarding others. the   i n t u i t i o n   probably is the result of tradeoff consideration of known clues. the meta knowledge plays various roles. one of the important roles is that it can be used to 
modify dynamically the comment frames of lower level kss. because of this role  when the inference engines used by lower level kss are so simple that the inference process is nearly determined only by meta rules  the execution of mks enables the problem-solving process of lower level kss to be self adaptive to the problem status. we believe the self-adaptive of inference is also an important feature of sgess. 
     concrete reasoning period is responsible for actually solving sub-problems. since after sketchy reasoning period  everything is tailored to the specific needs  so the concrete reasoning period is quite e f f i c i e n t   especially when the meta knowledge used by mks is excellent. 
     the d i s t r i b u t i o n of problem-solving a c t i v i t i e s at different control level in different time intervals is shown as follows: 
¡êsjlcumuli 1 ;   / . t  
                   1 sketchy if  i*  	1$  t   1 
1 concrete reasonincr: reasoninq: 1
 1 t where  at time i n t e r v a l : 
 l choose a task to f i r e   c a l l it t l . 
 1rder the mkss administered by tl as t l - m l   t1-m1  etc. 
 1 begin the sketchy reasoning of tl-ml. 
 1 choose a bks to run  c a l l it t1-m1-b1. 
 1 preview the rules used by t1-m1-b1. 
 1 adjust inference engine to suit the current state of the blackboard if necessary. 
 1 execute t1-m1-b1. 
 1 repeat  1  to  1   u n t i l the sub-problem is solved. 
 1 begin the sketchy reasoning of t1-m1. 
 lo repeat  1  to  1   choose another 

task to f i r e   u n t i l the whole problem is solved. 
it is not d i f f i c u l t to f i n d out that the three-level control architecture is a general  e f f i c i e n t problem-solving architecture. for example  the mobt often used inference engines: goal-directed and data-directed  can be implemented on the concrete reasoning l e v e l ; and the more complex mixed-chaining inference engine can be implemented on the sketchy reasoning l e v e l . besides  the symptom based inference enginec1 can be implemented on the planning l e v e l . the three level control architecture is an amelioration to the blackboard control architecture. it is more suited to be used in practical systems. further more  because of the introduction of comment frames  the kss' structure is loosely organized.through the f i l l - i n of comment frames  domain experts are free to choose whatever suited inference engines to reflect the exact nature of problem solving. 
     because the three level control architecture is a framework capable of charact e r i z i n g the general problem solving a c t i v i t i e s of application domain  and because zdest-1 provides great f l e x i b i l i t y for experts in building an actual system  so zdest-1 is a tool worthwhile to use for almost any domain. 
v the supporting facilities offered 
a. 	question answering 
     the sges must be able to give appropriate system performance explanations based on user's domain f a m i l i a r i t y . zdest-1 has made great efforts to provide 
ess with a user friendly interface. the es b u i l t by zdest-1 encourages user to ask  how    why  questions and to demand help from the system during problem-solving process  and also encourages user to use question answering module provided by zdest-1 to examine and to understand the evolution of problem-solving process. during the planning  sketchy reasoning and concrete reasoning period  the control transfer information is automatically recorded in a t r u t h maintenance structure  tms . the tms is of 1-d structure  indicating control transfer locus between tasks  mkss and bkss  fig.1 . according to 
t
	 i 	si tn.tn.hi. pa*  w  p1 	&  n ptt  td. pm  1it fw 

r j . 1. control twisjer from si to st. 
user's f a m i l i a r i t y   the question can be answered at t  m or b orientation. the locus in any horizontal plane indicates the control transfer within the same task  while the cross plane locus shows control transfer between different tasks. the t level explanation is based on the role of production rules stored in the task's comment frame  it gives the highest level control transfer information. the m level explanation is based on the known clues in the blackboard and the activation record of the production rules stored in the task's comment frame  and it gives the explanation of meta rules' function  i n d i cating the causality concluded by the sketchy reasoning. the b level explanation is based on the a c t i v i t y of each r u l e   giving the detailed domain rule level explanation. although the rationale of explanation is based on rule level explanation  the method used is similar to that of c1  but because the explanation could be given at three l e v e l   the needs of users with different background can be s a t i s f i e d . the question types which can be answered by question answering module include the following ones: 
.trace the performance at three level. 
.at t  m or b level investigate the success or f a i l of rules caused by certain blackboard information. 
.interrogate the conclusions reached at m or b level. 
.investigate how certain conclusions are reached or not reached. 
	fig.1 shows the control transfer 	from 
s i : task t l   mks ml  bks bl to s1: task t l   mks ml  bks b1. it is control transfer within same task and mks. pt1  pm1  pb1 and pb1 point to the sub-explanation structure associated with t l   ml  bl and b1 in place s i   s1 respectively. 
b. 	knowledge base management 
     zdest-1 pays lots attention to knowledge base management in order to give user a we1-developed environment of maintaining ess. we use meta-knowledge about the semantics of predicates and value functions and meta-knowledge about the logical calculus to check s t a t i c a l l y the consistency between rules. a knowledge base inquiry language is also provided to assist user browsing through the knowledge base. 
	v i 	conclusions 
     from the start of zdest-1 project  great emphases have been l a i d on the four characteristics mentioned above. now we can say  zdest-1 reflects them quite w e l l . the three level control architecture focuses on opportunistic inference at the planning l e v e l   focuses on meta level reasoning at the sketchy reasoning level and focuses on solution based inference at the concrete reasoning l e v e l . by proper combi-
tong  he  and yu 

nation and organization  almost a l l kinds of application domain can be properly characterized by such three level control architecture. further more  systems b u i l t by zdest-1 can r e f l e c t the domain nature as much as possible by allowing expert to use particular inference engine and part i c u l a r representation method to characterize the problem-solving methods pecul i a r to certain portions of the domain. the maintenance of b u i l t systems is also taken cared of by zdest-1 since question answering module and knowledge base management module are provided. 
     compared with tools b u i l t in last several years  a number of these tools' designers recognized the importance of providing two or three kinds of represent a t i o n language to support d i f f e r e n t ways of representing domain knowledge c1. a number of them also recognized the usefulness of making various typical inference engines available for expert's choice ¡ê1  but few of them explored the possib i l i t y of integrating multiple representat i o n methods and inference engines within an es. mostly because of t h i s d i s t i n c t difference  we believe zdest-1 is a second generation t o o l . on the other hand  tools which are general enough to be applied to a group of different domains  such as hearsay-   age  seldom provide w e l l developed environment for the building and maintaining of es together. zdest-1 can provide 1-d explanation for ess regardless of whatever inference engines are used as far as the needed control transfer information is properly recorded  this can be easily done  for the inference engines supplied by zdest-1 have already had such function  if the inference engines are supplied by domain experts  then it is 
necessary to embed codes to f i l l in cont r o l transfer information at relevant points of inference . 
     several experiments have been made to test the a b i l i t i e s of zdest-1. f i r s t l y   we chose emycin system. the clot system b u i l t by emycinc1  was r e - b u i l t by zdest-1  called zclot  zclot acts almost exactly the same as clot at concrete reasoning l e v e l . the building and debugging of zclot takes merely about three hours. 
secondly  we chose the kas 	system  	since 
kas was derived from prospector and we have already b u i l t an es to prospect mineral resources  called gpe  which is similar to prospector in structure and performance. gpe was again r e - b u i l t by zdest-1  called zgpe. zgpe takes only one week's time to b u i l t . it uses semantic network and procedure as i t s major representation methods. it has 1 concepts  1 knowledge pieces  1 specific procedures and several context types. usua l l y it takes about two minutes for zgpe to get a positive conclusion but less than 
1 	architectures and languages 
one minute to get a negative result. so  it is certain that zdest-1 is more powerf u l than emycin and kas. thirdly  we t r i e d an es for multi-factor planning. this is an es used to f i n d the best composition of d i f f e r e n t kinds of cotton for cotton m i l l s . in this system  about 1 factors of d i f f e r e n t importance convoluted make the problem-solving d i f f i c u l t . much work is done on the planning level and the results are satisfactory. fourthly  we t r i e d mixed-chaining inference by building an trouble shooting system for radio repair. a l l of these systems are accomplished successfully. 
