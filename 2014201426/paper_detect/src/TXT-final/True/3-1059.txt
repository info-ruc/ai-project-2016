
we present a novel method for indoor-location estimation using a vector-space model based on signals received from a wireless client. our aim is to obtain an accurate mapping between the signal space and the physical space without incurring too much human calibration effort. this problem has traditionally been tackled through probabilistic models trained on manually labeled data  which are expensive to obtain. in this paper  we present a novel approach to building a mapping between the signalvector space and the physical location space using kernel canonical correlation analysis  kcca . its training requires much less human labor. moreover  unlike traditional location-estimation systems that treat grid points as independent and discrete target classes during training  we use the physical location as a continuous feedback to build a similarity mapping using kcca. we test our algorithm in a 1 wireless lan environment  and demonstrate the advantage of our method in both accuracy and its ability to utilize a much smaller set of labeled training data than previous methods.
1 introduction
location estimation is a major area of pervasive computing applications that range from context-dependent content delivery to people monitoring . however  accurate location information may not be always available. for example  many buildings cannot be reached by location-determination devices such as gps. in such environments  a commonlyused technique is to leverage the signal strength values of a wireless network such as the ieee 1b wireless lan network  wlan . many systems utilize the signal strength values received from the access points to infer the location of mobile devices  based on deterministic or probabilistic techniques  ladd et al.  1; gentile and berndt  1; youssef et al.  1; bahl and padmanabhan  1; ni et al.  1 . similarly  in a sensor network  the location information must also be inferred from signals received from various deployed sensors. a major issue in these applications is how to build an accurate mapping between the signal space and the physical space while incurring minimal human effort.
¡¡in general  location-estimation systems using  rf -based signal-strength values function in two phases: an offline training phase and an online  localization phase. in the offline phase  a probabilistic model is trained by considering the signal strength values received from the access points at selected locations in the area of interest. these values comprise the training data gathered from a physical region  which are used to calibrate a probabilistic location-estimation system. in the online localization phase  the real-time signal strength samples received from the access points are used to estimate the current location based on the learned model.
¡¡in the training phase  the learned model is essentially a mapping function f s p  between the signal space s and the physical location space p. deterministic techniques build such a mapping function by assuming a signal propagation model based on properties of electro-magnetic fields. these signal-propagation models often cannot accurately describe a realistic environment due to uncertainty in the devices and the obstacles in the signal paths. probabilistic techniques are often more accurate by directly handling the uncertainty. these techniques construct the function f ¡¤ ¡¤  by maximizing the likelihood of the observation given the probabilistic distribution of the training data used for calibration.
¡¡however  the probabilistic methods suffer from several major shortcomings. first  these techniques require a huge amount of labeled data for the trained model to be accurate. in reality  the data collection is a time-consuming process. in our experience  for example  in our earlier test it took many hours to collect and label the signal-strength data in a limited indoor environment. second  the mapping between the signal and physical spaces are very difficult to construct due to nonlinearity. nonlinearity exists when similar locations have very different signal signatures. therefore  a direct mapping between the two spaces may not always work well  even when much data are collected. third  many probabilistic techniques adopt a classification-based approach  by treating the locations as discrete classes to be classified. however  this approach ignores the important information inherent in the physical proximity of the locations. furthermore  previous methods that apply regression based techniques treat the physical dimensions  x y  separately  they cannot fully exploit the geometric information imparted by considering x and y together.
¡¡in this paper  we present a similarity-based approach to building a mapping function. our main intuition is to perform a kernel-based transformation of the signal and physical spaces to capture the nonlinear relationship between the signals and locations. furthermore  we perform a kernel canonical correlation analysis  kcca  in the two spaces for feature extraction. this allows the pairwise similarity of samples that are measured in both spaces to be maximally correlated. we apply a gaussian kernel to adapt the noisy characteristic of signal strength and use a matern kernel to sense the change¡ä in physical locations.
¡¡a major advantage of our proposed technique is that we can obtain higher accuracy while reducing the training cost by requiring only a fraction of the labeled samples as compared to previous methods. we demonstrate this result in a series of tests on wlan location estimation using the data collected in a realistic environment.
1 related work
1 location estimation
location-estimation systems are an integral component for probabilistic plan-recognition systems in ai  liao et al.  1; bui et al.  1 . in general  they operate in two phases: an offline training phase and an online localization phase. during the offline phase  a radio map is built which tabulates the signal strength received from the access points at selected locations in the area of interest. during the localization phase  the signal strength samples received from the access points are used to search the radio map to estimate a user's location. in building the radio maps  two techniques have been attempted: deterministic and probabilistic.
¡¡deterministic techniques rely on radio propagation models which take into account such environmental factors as pathloss functions  roos et al.  1a; kaemarungsi and krishnamurthy  1 . when this is possible to do where uncertainty is relatively low  signal distribution models can be derived with a relatively small number of samples using knowledge on propagation channels  hashemi  1 . this also enables the nearest neighbor or triangulation techniques to be used  bahl and padmanabhan  1; smailagic and kogan  1; bhasker et al.  1 . for example  the radar system by microsoft research  bahl and padmanabhan  1  uses nearest neighbor heuristics and triangulation methods to infer a user's location. each signal strength sample is compared against the radio map and the coordinates of the best matches are averaged to give location estimation. the accuracy of radar is about three meters with fifty percent probability. in  bhasker et al.  1   an online procedure based on feedback from users was employed to correct the location estimation of the system. a similar technique for sensor networks has been applied; for example  the landmarc system  ni et al.  1  utilizes the concept of reference tags to alleviate the effects caused by the fluctuation in rf signal strength. the method first computes the distance between the signal-strength vectors received from the tracking tags and those from different reference-tags' respectively. it then uses k nearest reference tags' coordinates to calculate the approximate coordinate of the tracking tag.
¡¡probabilistic techniques confront the uncertainty in an indoor wireless environment  by constructing the signalstrength distributions over different locations in the radio map and use probabilistic inference methods for localization  roos et al.  1b; youssef et al.  1 .  youssef et al.  1  used a joint clustering technique to group locations together in order to reduce the computational cost of the system. the method first determines a most likely cluster within which to search for the most probable location  then applies a maximum likelihood estimation  mle  method to infer the most probable location within the cluster.
¡¡more recently  intense research efforts have been spent to seek additional knowledge in order to boost the accuracy of the location determination systems. for example  to handle the sequential characteristic of user traces   ladd et al.  1  suggest a sensor fusion model and shows a strong correlation between consecutive samples. the robotics-based location sensing system in  ladd et al.  1  applies bayesian inference to compute the conditional probabilities over locations based on received signal-strength samples from various access points. then a postprocessing step  which utilizes the spatial constraints of a user's movement trajectories  refines the location estimation and rejects the estimates that show significant changes in the location space. depending on whether the postprocessing step is used or not  the accuracy of this method is 1% or 1% within 1 meters.  yin et al.  1; ni et al.  1  study the dynamic features of signal strength and build a regression model to adapt the change of radio map with reference points. a radio map is constructed using data mining methods in an effort to reduce the samples collected for calibration chai and yang  1 .
¡¡in contrast to the above works  our approach builds a similarity based mapping function by making full use of the continuous location information in kernel-based transformation. in the next section  we first review kernels and kernel canonical correlation analysis.
1  kernel  canonical correlation analysis
canonical correlation analysis
given two sets of variables  canonical correlation analysis  cca   hotelling  1  attempts to find a basis for each set such that the correlation between the projections of the variables onto these basis vectors are mutually maximized. mathematically  given n instances s = { x1 y1   x1 y1  ...  xn yn } of the pair  x y   cca finds directions  canonical vectors  wx and wy so that the transformed variables
 canonical variates   and
  are maximally corre-
lated. now  define the total covariance matrix by
	c e 	ccxxyx ccxyyy  
where e  ¡¤  is the empirical expectation operator  cxx cyy are the within-sets covariance matrices and cxy yx is the between-sets covariance matrix. it can be shown that wx can be obtained by solving the generalized eigenproblem cxyc yy1cyxwx = ¦Ë1cxxwx  and then subsequently obtain wy as wy yy1cyxwx  hardoon et al.  1 .
kernel canonical correlation analysis
a major limitation of cca is that it can only exploit linear relationships between x and y. as is now well-known  the use of kernels offers an efficient  nonlinear extension of cca. kernel canonical correlation analysis  kcca   hardoon et al.  1  implicitly maps x and y to ¦Õx x  and ¦Õy y   and then performs traditional cca in the two high-dimensional feature spaces. to control the flexibility of the projections  the norms of the associated weight vectors are penalized.
¡¡using the dual representations for the projection directions w¦Õx x  and w¦Õy y :
     w  and w where s
  and ¦Á ¦Â ¡Ê rn. denote the corre-
sponding kernel functions by kx ¡¤ ¡¤  and ky ¡¤ ¡¤   and the kernel matrices  defined on all n instances  by kx and ky. it can be shown that ¦Á can be obtained by solving the generalized eigenproblem
	 kx + ¦Êi  1ky ky + ¦Êi  1kx¦Á = ¦Ë1¦Á 	 1 
where i is the identity matrix and ¦Ê is a user-defined regularization parameter. subsequently  ¦Â can be obtained as
	.	 1 
given any x   its projection on w¦Õx x  is given by
		 1 
where kx  . similarly  the projection of any y  onto w¦Õy y  is py  where ky  =  ky y  y1  ky y  y1  ... ky.
¡¡the generalized eigenproblem in  1  can be solved by using the  complete  cholesky decomposition. however  the kernel matrices kx and ky are of size n  and so obtaining the cholesky decomposition can become computational expensive for large training sets. in that case  the incomplete cholesky decomposition or the partial gram-schmidt orthogonalization can be used instead  hardoon et al.  1 .
1 location estimation using kcca
1 motivation
consider the two-dimensional location estimation problem1. its goal is to obtain a mapping between the space of signal strengths obtained at p access points s = {s ¡Ô  and the physical space p = { ¡Ô
. traditional approaches typically learn the two mappings  s ¡ú {x} and s ¡ú {y}  independently  brunato and battiti  1 . in this paper  we consider x and y together and emphasize the correlation between signal and physical spaces  observing that the pairwise similarity in the signal space should match the pairwise similarity in the physical space. for example  in figure 1  signal sa should be more similar to sb than sc  since a is closer to b in the physical space. consequently  we consider both x and y together and use kcca to learn the mapping between the two spaces.
1 the le-kcca algorithm
offline training phase
in the training phase  the following steps are taken:

figure 1: correlation between the signal and physical spaces.
1. signal strengths are collected at various grid locations.
1. kcca  with appropriate choices for the two kernels section 1   is used to learn the relationship between the signal and physical spaces. in particular  ¦Ëi's and ¦Ái's are obtained from the generalized eigenproblem in  1   and the corresponding ¦Âi's from  1 .
1. for each training pair   its projections
		 1 
on the t canonical vectors are obtained from  1 .
online localization phase
in the localization phase  the location of a new signal strength vector  s is estimated as follows:
1. use  1  to project sonto the canonical vectors and obtain
.
1. among the projections  1  from the training samples find the m neighbors closest to p  s . in this paper  the weighted euclidean distance pj si  1 is employed.
1. interpolate these neighbors' physical locations to predictthe physical location of  s. in this paper  we simply output the median  or mean for continuous location estimation  of the  x y  coordinates of these m neighbors.
1 choice of kernels
signal-strength values are often noisy. the empirical distribution  radio map  is difficult to obtain  especially when the training samples are scarce. as a first approximation  the gaussian distribution has been used in characterizing the nonlinearity of the signal strengths  roos et al.  1b . hence  in this paper  we also use the gaussian kernel g x1 x1 :
		 1 
for the s space. here  wg is a user-defined parameter that reflects the smoothness of the radio map.
¡¡on the other hand  measurements of the physical locations are relatively clean. as in  schwaighofer et al.  1   we adopt the matern kernel¡ä m x1 x1   figure 1 :
	 	 1 
where ¦Í is a smoothness parameter  ¦£ ¦Í  is the gamma function and k¦Í r  is the modified bessel function of the second kind. it can be shown that when ¦Í ¡ú ¡Þ  the matern ker-¡ä nel degenerates to the gaussian kernel  and to the exponential kernel x when ¦Í = 1. note that both the gaussian and matern kernels are isotropic and so are in-¡ä variant to the location of origin and to arbitrary rotation.

figure 1: the matern kernel.¡ä
1 experiments
in this section  experiments are performed to measure the accuracy of le-kcca  and also test whether this is useful in reducing calibration effort. for comparison  we also run:  1  support vector machine  svm   brunato and battiti  1 ;  1  maximum likelihood estimation  mle   youssef et al.  1 ; and  1  radar  bahl and padmanabhan  1 .
1 setup
experiments are performed based on the office layout in the department of computer science   the hong kong university of science and technology  figure 1 . there are four hallways with a total of 1 grids  where each grid measures 1m ¡Á 1m. there are only three access points in figure 1  though a total of eight access points  including some from other floors  are detected. each sample is thus an 1dimensional signal strength vector  with the measurements averaged in one second. 1 such samples are collected at the center of each grid  with a total of 1 samples obtained. we randomly use 1% of the 1 samples for training and the rest for testing. to reduce statistical variability  results here are based on averages over 1 repetitions.

figure 1: office layout used in the experiments.
we set wg in  1  to 1  wm in  1  to 1  and m
 the number of neighbors used in the localization phase  to
1. preliminary studies show that the accuracy only changes slightly  within 1%  when m varies in the range 1 to 1. moreover  ¦Í in  1  is set to 1  and thus the matern kernel¡ä degenerates to the exponential kernel.
1 location estimation accuracy
figure 1 plots the average testing accuracies  and the corresponding standard deviations  at different acceptable error distances. at an error distance of 1m  the accuracy of lekcca is 1% while those of svm  mle and radar are 1%  1% and 1% respectively. thus  by utilizing the pairwise distance similarities in physical locations  lekcca obtains better performance than the other methods.

figure 1: testing accuracies at different error distances.
1 reduction in calibration effort
in the first experiment  we use all the 1 grid locations but only a random subset of the signal samples available at each location for training. figure 1 shows the testing accuracies at error distances of 1m or 1m. as can be seen  by using only 1 random training samples at each location  le-kcca can already outperform the other methods that use a full set.
¡¡in the second experiment  we select a subset of the available grid locations  and then use all the training signal samples at those selected locations for training. evaluation is performed on both the unseen signal samples at the selected grid locations and also at the unseen locations. again  figure 1 shows that le-kcca yields better performance. thus  le-kcca  by maximizing the correlation between signal and physical spaces  can reduce the calibration effort dramatically. with the physical location similarity as feedback  samples from the same locations move closer together  while those from different locations are pushed away under the feature-space mapping built by le-kcca.
¡¡we believe that le-kcca performs well. to validate this claim  we conduct another three experiments for comparison. the first one treats all the grid locations separately  which can be achieved by using a large value for wm in the matern ker-¡ä nel  in this experiment  we set wm = 1 . this is denoted as isolated-kcca in the sequel. another extreme case is to modify the le-kcca algorithm so that the signal space is correlated with x and y separately  denoted 1d-kcca . a third experiment is to modify both gaussian and matern ker-¡ä nels to linear ones  linear cca . experiments are performed in the same setting as for figure 1. as can be seen in figure 1  all three variants lead to degraded performance as expected.


figure 1: effect on varying the number of training samples at each grid location.

figure 1: effect on varying the number of grid locations in training.

figure 1: the effect when the information in both physical dimensions  x and y  are not used together. isolated-kcca considers each grid location as independent  while 1d-kcca considers x and y as independent. linear cca has even lower accuracy and the curve is not shown in the figure.

linear cca has an accuracy that is lower than 1% on every test set  and so its results are not shown in the figure.
1 conclusions and future work
this paper focuses on using kcca to improve the accuracy of location estimation in wireless lans. we have found that kernel transformation and cca allow the construction of an accurate mapping between the physical space and the signal space. one advantage is the higher accuracy obtained in localization with much less calibration effort. we use a gaussian kernel for the signal space to adapt to the noisy characteristic of radio-propagation channels  and a matern kernel for¡ä the physical space. the advantage of kcca is shown through extensive experimental tests in a realistic environment. in this paper  we constructed the mapping without considering the additional information of user motion profiles. in the future  we plan to take the user-motion profiles into account  which may lead to higher accuracy with even less calibration effort. likewise  we wish to experiment more with other environmental and contextual factors to boost the performance. acknowledgment
we would like to thank hong kong rgc for supporting this work under grant hkust1 / 1e. we would also like to thank jie yin and xiaoyong chai for their effort in collecting the data and discussing the research problems.
