 
     we show that an intelligent approach to color can be used to significantly improve the capabilities of a vision system. in previous work  we adopted general physical models which describe how objects interact with light. these models are far more general than those typically used in computer vision. in this report  we use our physical models to derive powerful algorithms for extracting invariant properties of objects from images. the first algorithm is used for the generic classification of objects according to material. the second algorithm provides a solution to the color constancy problem. these algorithms have been implemented and produce correct results on real images. some examples of experimental results are presented. 
1. introduction 
     a general vision system must be capable of generating meaningful descriptions of a scene in any of the diverse environments for which human vision is useful. nearly all existing artificial vision systems are special purpose. they rely heavily on domain-specific constraints and special-case engineering. although significant progress has been made in machine vision  the best artificial vision systems still fall far short of achieving the capabilities associated with general vision. 
     in this paper  we analyze the role and use of color in a general vision system. we have previously examined the physics of reflection to develop general models which describe the formation of color images . using these models  we isolate the invariant properties of objects with respect to color. once these invariant properties are understood  we derive general procedures which reliably extract these invariant properties from images. 
1. the physics of reflection 
     there are several ways an object can modify incident light. an object can change light spatially by reflecting it into a small or large angle. incident light can be modified spectrally. also  the energy of incident light can be reduced if a large fraction of the light is absorbed by an object. 
     for this work  we use the specular reflectance model developed by torrance and sparrow  and the body reflection model developed by kubelka and munk . our use of these models is described in detail in . given these models of both specular and body reflection  we can quantify reflectance r as 
		 1  
where rs is the fresnel reflection term and rb is the kubelka-munk body reflection term. the power of the light reflected from a surface towards a viewer is then given by 

where  quantifies the power of the incident light. 
     in   we describe methods for color recovery and representation. in the next three sections  we derive algorithms to extract invariant properties of objects from images. in section 1  we present experimental results. 
1. physical segmentation 
     while locating irradiance discontinuities has attracted much attention in computer vision  less work has been done on the important problem of identifying the underlying causes of these discontinuities. the most common physical causes of image irradiance discontinuities are illumination discontinuities  surface orientation discontinuities  specular discontinuities  pigment density discontinuities  and material discontinuities. we will refer to the problem of classifying image irradiance discontinuities according to their physical cause as the physical segmentation problem. some approaches to this problem are described in . 
     some progress has been made in using color to classify edges. rubin and richards  have proposed a method for rinding material discontinuities  but their assumptions and physical models appear limiting. gershon  jepson  and tsotsos  discuss a more general method for distinguishing material changes from shadow boundaries. shafer  has developed a method to separate diffuse scattering from specular reflection using color. 
     we restrict ourselves to discussing distinctive properties of the image irradiance discontinuities which occur 
	healey and binford 	1 

 where the specular component of the reflected light becomes significant. the most conspicuous feature of specular reflection is that it is invariably associated with image irradiance values which are much larger than those in neighboring image regions. moreover  the expected magnitude of the difference in irradiance is directly related to properties of the imaging system which are often known. another quasi-invariant property of specular features is that they are typically small  especially for curved surfaces. thus unless a specularity occurs at the edge of a surface  it will be surrounded on all sides by diffusely reflected light of approximately the same color and power. finally  we observe that most specular discontinuities occur in places where the reflecting surface is continuous. it has been shown that image irradiance for diffusely reflected light can be used to compute local descriptions of a surface to at least second order . it has also been shown that image irradiance for specularly reflected light can be used to compute similar local surface descriptions . at specular image irradiance discontinuities  we usually expect the first few derivatives of the surface to be continuous. thus by comparing the local surface descriptions generated by  and  we have another way to verify the presence of a specular image irradiance discontinuity. 
1. generic classification of materials 
     in this section and the next  we describe procedures for using color to extract distinctive invariant properties of objects from images. in this section  we show how color can be used to recover a symbolic description of the material an object is made of. in section 1  we describe a method for recovering an object's surface spectral reflectance. 
     classifying objects according to material is important because material is an invariant property of an object. it is very valuable  for example  to be able to decide that an object is metal rather than plastic or painted wood rather than dyed cloth. 
     an important property of a material is whether it is optically homogeneous or optically inhomogcneous. by examining the physics of reflection  we have derived a procedure for classifying a material as either homogeneous or inhomogeneous. 
     homogeneous materials reflect light only from the surface. the color of this reflected light is determined by the fresnel equations from the complex index of refraction of the material as a function of wavelength. for a single color of illumination 1 x   the color of light reflected from a homogeneous material will be nearly constant with only slight variations due to changing geometry. 
     inhomogeneous materials both reflect light from the surface and scatter light from the body of the material. the color of the light reflected from the surface is determined by the index of refraction of the vehicle. the color of the light scattered from the body is determined by the selective absorption properties of the colorant particles embedded in the vehicle. in genera   the color of the surface reflected 
1 	perception 
light will be different from the color of the body scattered light. therefore  given a single color of illumination l a   there will be two distinct colors of light reflected from an inhomogeneous material. 
     using the technique discussed in section 1  we are able to find image irradiance discontinuities corresponding to the places where the power of the specularly reflected light becomes significant. using our metric for color space   we can examine whether these image irradiance discontinuities coincide with discontinuities in color space. if a color discontinuity is not detected  there is strong evidence for a homogeneous material. if we do detect a color discontinuity  then the material is probably optically inhomogeneous. 
     we see that in most situations  it is possible to distinguish homogeneous materials from inhomogeneous materials using techniques in color space. once the homogeneousinhomogeneous classification has been made  it is possible to use color to distinguish different homogeneous materials  e.g. aluminum and copper  and to distinguish different inhomogeneous materials  e.g. white plastic and red plastic. our method to achieve this additional level of classification is based on recovering surface spectral reflectance. we describe our method in the next section. 
1. recovering surface spectral reflectance 
     another invariant property of an object which is valuable for recognition is the object's surface spectral reflectance. unfortunately  surface spectral reflectance is not determined by the spectral distribution of the light reflected by a surface. it is this reflected light which is directly sensed by a vision system. the light which is reflected by a surface is the product of the spectral distribution of the incident light and the spectral reflectance of the surface. to recover the spectral reflectance of a surface  some mechanism must be available to factor out the effects of the incident light. many experiments have shown that the human vision system is capable of making this computation. this ability of humans to see objects as having a constant color despite varying illumination conditions is called color constancy. 
     many theories have been advanced to explain color constancy  l . our approach is based on the physics of reflection. another class of approaches views the task as an underconstrained mathematical problem   . these approaches identify the assumptions about incident illumination and surface spectral reflectance which are required to make color constancy possible from a purely computational point of view. in other work  psychologists have suggested that the eye selectively adapts to the color of the ambient light. experiments have shown that this selective adaptation might be partly responsible for human color constancy 
. 
     our method for recovering surface spectral reflectance is applicable to instances of surfaces which are illuminated by the same spectral distribution of light as that which illuminates an inhomogeneous object in the scene. this condition is quite general  and is almost always satisfied in real situations where a small number of different illuminants contribute to the image forming process. 
     for inhomogeneous materials the complex index of refraction is nearly constant across the visible spectrum. from the fresnel equations  the specular reflectance of an inhomogeneous material is a constant function of wavelength for fixed geometry. moreover  the fresnel equations tell us that the specular reflectance for fixed wavelength is constant with respect to geometry for almost all incidence angles. therefore  for inhomogeneous objects the fresnel component of the reflectance can be regarded as constant with respect to both geometry and wavelength. 
     given the physical segmentation technique  section 1  and our technique for classifying inhomogeneous materials  section 1   we can recover surface spectral reflectance up to a multiplicative constant. we use the previously described procedures to locate a specular-body reflection boundary on an inhomogeneous object. from  1  and  1   the measured function / a  is given by 
	/ a  =  rs x  + rb l   l    	 1 . 
on the body reflection side of the boundary  rs x  = 1 giving 
	/' a  = rb x l x  	 1  
where rb x  can be considered to be the same as in  1  since rb x  changes slowly with respect to geometry. we can solve for rs x l x  using 
	rs a i a  = /   a   - / '   a   	 1  
but rs x  is constant with respect to a and geometry. let rs x  = k. therefore  using  1  we can compute l x  up to the constant k by 
	kl    = / a  - /' a  	 1  
from  1   rb x  can now be computed up to the constant l/k by 
for a homogeneous material in the scope of 1 a   we have 
	/ a  = rs   l x  	 1  
because rb a  = 1. thus we can compute rs a  to within 1/kby 
therefore  using  1  and  1  we can compute the surface spectral reflectance for any surface illuminated by l x  up to a multiplicative constant. examples of the performance of this method on real images will be given in section 1. 
     it should not be surprising that there is a fundamental ambiguity in the computed spectral reflectance corresponding to the constant k. from  1  
	/ a  = l x r x  	 1 . 
we see that an arbitrary constant t can be introduced into both l a  and r x  such that the resultant / a  will be indistinguishable from 1 a  in  1 : 
	/ a  =   m    ir     	 1  
thus without using additional assumptions  we cannot expect to determine r x  better than to within a multiplicative constant. we note that our notion of normalized physical color  is independent of these scaling constants. 
1. experimental results 
     a simple laboratory setup has been used to test our color methods. we digitize color images using a solid-state camera and four gelatin filters. the camera is equipped with an infrared cutoff filter. 
     two different light sources have been used for experiments. one is a tungsten halogen lamp of color temperature 1буk which is typical of indoor illumination. the other lamp has color temperature 1бу and is intended to simulate daylight. 
     several simple objects have been used to test our color methods. our objects include plastic cups  metal cylinders  and painted wooden blocks. 
     in figure 1  we show the performance of our algorithms on color images of plastic cups illuminated by the 1бу a' color temperature lamp. since the image irradiance corresponding to the specular reflection is markedly larger than the image irradiance corresponding to the diffuse reflection  the physical segmentation process of section 1 easily locates the specular-diffuse boundaries. the method of  is then used to recover the function / a  for both the specularly reflected light and the diffusely reflected light. figure 1 a  is i x  for the fresnel reflection from a blue cup. it agrees well with the actual color of the light source. figure 1 b  is / a  for the diffuse reflection from the blue cup. from the large color difference between figure 1 a  and figure 1 b   the algorithm of section 1 easily is able to identify the plastic cup as being made of an inhomogeneous material. we remark that it would be very difficult to infer that the cup is blue by simply inspecting the color of the reflected light / a  in figure 1 b . in fact  the largest amount of power is in the red part of the visible spectrum  near 1 nm . to 
	healey and blnford 	1 

determine the color of the cup  as distinct from the color of the light reflected from the cup   we must compute the surface spectral reflectance. this is done using the method of section 1. figure 1 c  shows the spectral reflectance computed for the blue cup. from figure 1 c   we can tell that the cup is blue. 
acknowledgements 
     this work has been supported by an nsf graduate fellowship  afosr contract f1-c-1  and arpa contract n1-1-c-1. 
