 
   this paper describes a method for maintaining the relationships between temporal intervals in a hierarchical manner using constraint propagation techniques. the representation includes a notion of the present moment  i.e.   now    and allows one to represent intervals that may extend indefinitely into the past/future. 
this research was supported in part by the national 
science foundation under grant number ist-1  and in part by the office of naval research under grant number n1-o1. 
i. introduction 
   this paper describes a method for representing and reasoning about temporal knowledge. while most work in artificial intelligence would appear to require some reasoning about time  this problem is typically avoided and delegated to  future research.*' in order to make further progress in the areas of problem solving and natural language understanding  these problems cannot be ignored any longer. 
   the techniques for modeling time that have been developed in problem-solving systems seem too weak for our purposes. the predominant temporal models in these systems are those using state variables and state spaces. in this world  time is represented as a sequence of instantaneous time slices. each time slice is described by the set of facts that hold at that time. this has been a successful mode  in problem solving systems that deal with a single agent operating in a simple discrete world  such as the blocks world . unfortunately  current problem solving work is attempting to deal with multiple agents  each acting not only on what is true now  but on what each expects to be true in the future. to treat these issues adequately  one needs a more flexible model of time. for further discussion of these issues  see  mcdermott  1  and  hayes  1 . 
   the techniques for modeling time developed in natural language understanding systems are typically 
cruder than those in problem solving systems. in part  this is because many efforts have been directed at question answering systems in a static world  with no conception of time   or in domains small enough so that simple beforeafter chains of relations are computationally feasible. 
   recently  there has been a growing interest in systems that use problem solving techniques as an essential part of the natural language understanding task  e.g.  allen  1; wilensky  1; grosz  1  . this work appears to have great promise  but cannot continue much further without a general model of temporal relations. 
   let us consider what general characteristics such a temporal model should have. the following seem particularly relevant: 
-- the model should allow significant imprecision of scale. many temporal relations are strictly relative and have little relation to some absolute sense of time. 
- t h e model should allow uncertainty. on many occasions  the exact relationship between two time intervals is not known  but some constraints are known about how they could be related. 
- the model should have a strong sense of now. this must be done in a manner that allows the present moment  now  to change without requiring major changes to the knowledge base. 
- the model should allow a sense of persistence. it should facilitate default inferences of the form   if p is true now  it will remain true until 1 notice otherwise.  
   with a few notable exceptions  there has been little work done on computer representations of time. the work that there is  however  contains many interesting ideas which will be freely used in this paper. kahn and gorry  suggest that the temporal aspects of knowledge can be separated out for individual treatment. they describe a system that is a time specialist; it maintains temporal relations and provides the rest of the system with the tools to test  retrieve  add  and delete temporal information. the time specialist knows nothing else about the knowledge representation. a similar approach is taken here: the model knows only about temporal relations  and provides the tools for manipulating this knowledge. this is one part of a larger effort to design and implement a temporal logic- which can describe and reason about temporally qualified propositions  events  actions  and plans  allen  in progress   thus  the long-term goal of this work is similar to that in hayes  1  and mcdermott . 
1 
   the model described here differs from the model of kahn and gorry  as well as that of bruce  1   in that it emphasizes the aspects of temporal reasoning that are not concerned with dale lines. in particular  it allows relative temporal relationships to be maintained in a highly 
structured fashion  furthermore  it includes a notion of the present time  i.e.   now    which is maintained in a manner that does not require knowledge of the exact present time  and that does not involve extensive modifications to the knowledge base every time  now  is updated. 
the system described here has been implemented in 
lisp on a vax 1. in particular  the constraint propagation with reference intervals and the manipulations of the  now  are completed and fully tested. all examples in sections ii through v inclusive have actually been run on the system. 
ii. 'lime points vs. time intervals 
   the references to temporal relations in english are often both implicit and vague. in particular  the majority of temporal references are implicitly introduced by tense and by the description of how events are related to other events. thus we have 
 we found the letter while john was away.  
 we found the letter after we made the decision.  
   these sentences arc introducing temporal relations between the limes  intervals  at which the events occurred. for example  the temporal connective  while  indicates that the time when the find event occurred is during the time when john was away. the tense indicates that john being away occurred m the past  i.e.  before now . 
   although some events appear to be instantaneous  e.g. one might argue that the event  finding the letter  is instantaneous   the majority of events described take place over a time interval. thus  our representation is designed to maintain these interval relations conveniently and 
concisely. 
   the most apparent scheme for representing intervals seems to be modeling the endpoints. thus  if we assume a model consisting of a fully ordered set of points of time  thus we can now map our intervals and interval relations onto the simpler time point representation. 
   i am not going to implement intervals using this scheme. the main reason is that the representation is too uniform and does not facilitate structuring the knowledge in a way which is convenient for typical temporal reasoning tasks. the central issue here is the importance of the during relation. a major part of our temporal knowledge is of the form 
 event f' occurred during event e  
and that our knowledge of the during relation allows a highly structured representation of time. in particular  a 
key fact used in testing whether some condition p holds during an interval t is that if l is during an interval t  and p holds during t  then p holds during l. thus the during relation can be used to define a hierarchy of intervals in which properties can be inherited. 
   furthermore  such a during hierarchy allows reasoning processes to be localized so that irrelevant facts are never considered. for instance  if one is concerned with what is true  today   one need consider only those intervals that are during  today.  or above  today  in the during hierarchy. if a fact is indexed by an interval wholly contained by an interval representing  yesterday   then it cannot affect what is true now. 
   whenever we need to refer to points  they will be explicitly related to an interval. thus  we can talk about the beginning of an interval t  t-   the end of t  t+   or any arbitrary point during t. the only difference between such points and a standard interval is that points cannot participate in the overlaps relation  and the meets relation indicates that the point is an endpoint of the interval. 
iii. maintaining temporal relations: the simple view 
   we saw above five relations that can hold between intervals. considering the inverses of these relations  there arc a total of nine ways in which an ordered pair of intervals can be related. these are shown in figure 1. 
   
then an interval is an ordered pair of points with the first point less than the second. we then can define the following relations between intervals  for any interval t  the lesser endpoint is denoted by t-; the greater by t+ : 
1 
   
   these relationships between intervals are maintained in a network where the nodes represent individual intervals. each arc is labelled to indicate the relationship between the two intervals represented by its nodes. in cases where there is uncertainty about the relationship  all possible cases are entered on the arc. note that since the nine possible relationships are mutually exclusive  there is no ambiguity in this notation. figure 1 contains some examples. throughout  let ni be the node representing interval i. notice that the third set of conditions captures the one sense of the notion of disjoint intervals. 

figure 1: representing knowledge of temporal relations in a network 
   throughout this paper  both the above notations will be used for the sake of readability. in general  if the arc asserts more than one possible relationship  the network form will be used  and in the case where only one relationship is possible  the relation form will be used. 
   in. this simple view  it is assumed that the network always maintains complete information about how the intervals in it could be related. thus when a new fact is entered  its full consequences must be computed. this can be done by computing the transitive closure on the temporal relations as follows: the new fact adds a constraint about how the two intervals could be related  which may in turn introduce new constraints between other intervals because of the transitivity behavior of the temporal relationships. for instance  if the fact that i is during j is added  and j is before k  then it is inferred that i must be before k. this new fact is then added to the network in an identical fashion  possibly introducing further constraints on the relationship between other intervals. a few of the transitivity relations are summarized in figure 1. the full transitivity table can be found in  allen  1 . 
   as an example of using this table: if a after b  and b during c  then follow the 1nd row       to the 1rd column   d    to obtain a -    oi d mi  --  c. 
   a nice property of this transitive closure algorithm is that it only continues to operate as long as it is inferring new relations between intervals. if the intervals involved were previously related  then the algorithm only continues while it is further constraining the old values. the bad property is that it requires vast amounts of memory  since every interval is explicitly related to every other interval. this problem is addressed in the next section. 

iv. maintaining temporal relations using reference 
intervals 
   we need some method in which to restrict the propagation of constraints throughout the network but to allow the inferences locally. furthermore  we should later be able to infer the relationships that were not produced by the original propagation of constraints. this latter condition eliminates the possibility of restricting the propagation by only allowing propagation paths of some fixed length  for there seems to be no method available to recover the information not inferred except by a brute force search. a more structured view of the network is needed. 
   the solution described here allows the user of the system to determine what inferences are important to perform  automatically   and what ones can be deferred. it entails introducing the concept of reference intervals. each time a relation is added  it is added with respect to a reference interval. the user of this system may set up the reference intervals as desired. in general  they probably will often reflect part of the during hierarchy  but also may reflect the semantic clustering of events. 
   the constraint propagation is then restricted to inferring new relationships between points that share a 
   common reference interval. we shall allow time intervals to have more than one reference interval. in the graphical notation  reference intervals will be indicated in parentheses following each node. thus the situation described above would be captured by the nodes 
i1 r1 r1   i1 r1   i1 r1   i1 r1  
throughout the paper  nodes will indicate their reference intervals only when it is relevant to the discussion. since there is a fixed set of reference intervals for any one node  no confusion should arise. 
   
　　reference intervals are simply other intervals themselves  and so have their own reference intervals as well. while it is up to the user of this system to choose what reference intervals are present  there are some particularly useful techniques worth mentioning. 
　　the first type of interval useful as a reference is an interval that more or less divides a large set of time intervals into those before and those after. kahn and gorry  use these types of reference intervals  and give examples such as  the birthdate of a person    my graduation from school.  these events divide the set of intervals relating to a person's life into those before and those after. in the representation here we get this behavior using two reference intervals  one for the lime before the event  and one for the time after. 
　　as a simple example. let g be the time of my graduation from school  from which gb  before g  and ga  after g  are defined as reference intervals. let l be the time of my learning to play chess  and w be the time of my winning a state lottery. assume further that 1. is before g. so is stored wiih respect to the reference interval gb  and that w is after g  so is stored with respect to the reference interval ga. since and w do not share a common reference interval  the explicit relationship between them is not computed or stored. this information is summarized below  using x as a dummy reference interval for ga and gb. 
gb x  before ga x  
l gb  during gb x  
w ga duringga x  
to find the relation between l and w  we follow up the reference interval chains until we find an explicit relationship. thus  from l we first find gb  and from w we find ga. it is explicitly asserted that gb is before ga. the trace of this search path indicates the facts relevant to infer that l is before w using the transitivity table  figure 1 . of course  the real benefit of this approach is only realized when there are many intervals that either reference ga or that reference gb. 
　　reference intervals can also be used to control inference that is more semantically or pragmatically based. for instance  in a dialogue system  one needs to keep track of the focus and topic of discussion. the discussion of one topic may introduce many facts that should be treated as a unit. explicit signals are often given to indicate changes in topic. in general  we do not want to examine the relationships between time intervals introduced across topics as closely as those introduced within a single topic. thus we should introduce a new reference interval for each topic. 
v. maintaining the present 
　　for this representation to be truly useful in a dialogue system it must be able to capture the notions of past  present  and future. furthermore  since the  the present  is continually moving into  the future   this updating must not involve a large-scale reorganization of the data base each time it is done. 
　　the method used here is simply to map  now  onto an interval that is maintained in a similar manner to all other intervals in the system. if we are clever about using its reference interval  so that most relations are inferred via the reference interval rather than directly  then updating  now  to a new interval that has the same reference interval should not be too expensive. 
　　for example  let  now  be interval n l   which is during its reference interval rl. an example state of the data base would be 
n1 r1  during rl 
rl before 1  rl after 1  rl during 1 
from this we can infer easily that the present  i.e.  nl  is during 1. before i i   and after 1. if  now  then is updated  slightly   n1 can be defined as the new  now  using the same reference interval by adding the facts 
n1 r1  during rl. n1 r1  after n1 r1  
thus   now  has been updated but most of the relations in the data base have been unaffected  for the effects of n1 will only propagate to intervals referenced by rl. the reference interval rl has  protected  the rest of the data base from minor- change in the present moment. of 
course  eventually  now  will cease to be during rl and a new reference interval will be needed. this will involve a more major update to the data base  but the amount of work can be reduced if rl itself has a reference interval that  protects  much of the data base from it. 
　　thus we need a hierarchy of reference intervals  each containing the present moment. this hierarchy should be designed to mirror the set of english terms that can be used to refer to the present. for example  in english we can refer to the exact moment of an utterance  as well as to larger intervals such as  this morning    today    during this lecture   and  while at this bar.  these intervals typically have well defined starting and termination points. thus it is reasonable to assume that the temporal data base will receive explicit notification when one of them ceases to contain the present. this allows the following important assumption: 
when updating the  now  interval  unless otherwise stated  its relationship to its reference intervals  remains constant. 
　　when one of the reference intervals in the hierarchy ceases to contain the present moment  a new reference interval is selected.  this new interval should usually be provided by the user.  this update is done in the identical fashion as described above with  now.  in particular  the relationship with the higher level reference interval remains constant. a new  now  interval  below the new reference interval in the hierarchy  must be introduced. for example  the beginning of a new day would make much of the old hierarchy part of the past  i.e.   yesterday  . 
　　while many intervals will be generated by this succession of  nows   a large number of them will have been used only to index the time of an utterance. thus  they generally can be deleted without harm. 
   
1 
   
   consider the simple example in figure s  which describes a possible hierarchy for the present  where my uttering the present sentence is during interval now1. let indentation indicate a during relationship and the ordering from top to bottom indicate the before relation. 
   in addition  when the reference node talk is updated  some of the old nodes that represented  now  could be deleted. in particular  nowl  now1  and now1 might not be needed any longer. the new hierarchy is shown in figure 
1. 

   

figure 1: a possible hierarchy indicating the present 
   thus  day1  which is today  contains the intervals am1 and pm1  and is also their reference interval. interval am1 is before pm1. in turn  am1 contains ii and amtalks  and is their reference interval. the intervals of the form nowi are the intervals that at one time or another were/will be part of the present. the underlined intervals give the structure that is currently present. thus  now  refers to interval now1. 
   given this state  we can infer that interval 1 is part of the past by tracing up the hierarchy from 1 until we find an explicit relationship with the present  the underlined nodes . since 1 is during am1  which is before pm1  we can infer that 1 is before the present. 
   to update  now  without changing its reference point  we simply add a new interval now1  assert that now1 during talk and now1 before now1. the fact that 1 is still in the past after this update is calculated in the identical manner as before. the result is shown in figure 1  omitting the reference interval information . 

figure 1: the hierarchy after a minor  now  update 
   to update a reference interval  say to update the interval talk when 1 finish my talk  the same operation as with a minor update is performed  and then a new interval to represent the new  now  is added. in many cases  however  the user will specify an already known interval to be the new reference  e.g. updating  today  to  tomorrow  . assuming that aftertalk is the newly specified reference interval  we need only create a new  now  node  say now1. 
figure 1: the hierarchy after a major  now  update 
vi. persistence of intervals 
   the last requirement described in the introduction was that the representation should facilitate plausible inferences of the form  if fact p is true now  it will remain true until noticed otherwise.  most of the issues concerning this fall outside the range of this paper  as this system only knows about time intervals. however  a simple trick using this representation makes inferences of the above form easy to implement. 
   typically  when a new fact is learned  its exact extent in time is not known. for instance  when i parked my car in the parking lot this morning i knew its location. sitting at my desk now  i assume it is still there  though i have no proof of that fact in general  i assume it will remain where it is until i pick it up. thus  although 1 don't know the extent of the interval in which my car is parked  i want to be able to assume that this fact holds later in the day. 
   the temporal representation is already based on the observation that most time intervals do not have precisely defined limits. if we allow the user to specify that some intervals should be assumed to extend as far as possible given the constraints  then we can use such intervals to index facts that are assumed to persist until discovered otherwise. 
   thus  if we let a fact p be indexed by a persistent interval tp  then testing p later during an interval l will succeed  by assumption  if it is possible that t is during tp. checking whether relationships between intervals are possible is easy  since the representation explicitly maintains this information. 
   for example  let tp represent the interval in which my car is in the parking lot. i know that tp is met by tarrive  where tarrive is the time that i arrived at school today. then  let  now  be represented by the interval tnow  where tnow after tarrive. we can conclude that my car is in the parking lot as follows. since it is there during tp  we are interested in whether it is possible that tnow is during tp. the known constraints allow us to infer the following: 
tp met by tarrive  tarrive before tnow 
=   tp--   o di m -  tnow 
   
thus it is possible that tnow is during tp  since it is possible that tp contains   di   tnow. so the test succeeds. 
　　of course  if it is later learned that the car was found to be missing during some time interval tmiss  then tp is constrained to be before tmiss  even though it is still persistent . if tnow is then after or during tmiss  then it is not possible any longer that tnow is during tp. 
　　mcdermott  introduces a similar notion that he also cutis persistence  must be a good term! . his scheme involves specifying a  numeric  duration over which the proposition will be assumed to hold after it becomes true. in my scheme described here  limits are introduced by constraining the persistent interval to be before  or some other relation  some other interval. thus our approaches differ on how central a role explicit duration information plays. i have explicitly avoided all duration scales here  but deal with them briefly in  allen  1 . 
　　managing a system such as this is a difficult problem that requires some form of truth maintenance  e.g. see  doyle  1  . these issues  however  are independent of the temporal representation. all that is shown here is that the necessary temporal calculations are easily done within this framework. 
vii. summary 
　　this paper argues that a model for representing temporal information such as that acquired in dialogues is more naturally interval-based rather than point-based. it describes a method of representing the relationships between temporal intervals in a hierarchical manner using constraint propagation techniques. by using a notion of reference intervals  the amount of computation involved when adding a fact can be controlled in a predictable manner. 
　　evidence for the viability of this representation is presented by discussing a few important problems that arise in dialogues involving temporal reference. the first problem involved the representation of the present moment  which must be able to be updated frequently and thus must be done efficiently. the use of reference intervals to insulate the present moment from the bulk of the facts in the knowledge base was suggested as a promising technique. 
　　the other problem discussed involved the ability to assume various conditions would hold until explicitly discovered otherwise. since the techniques suggested already computed the set of possible relationships that could hold between two intervals  it was easy to implement this assumption mechanism. if an interval was labelled as persistent  then it was assumed to extend as far as possible given its constraints. 
1* 
acknowledgements 
many thanks to jerry feldman  alan frisch  don 
ferlis  ken sloan  and the ai study group for their comments on a draft version of this paper  and for other general discussions of issues while the research was in progress. 
references 
allen  j.f.   a 	plan-based approach to speech act 
recognition   ph.d. thesis. department of computer science  university of toronto  1. 
allen  j.f.   a general model of action and time   in progress. 
allen  j.k   maintaining knowledge about temporal intervals   tr1  computer science department. university of rochester  january 1. 
bruce. b.c.   a model for temporal 