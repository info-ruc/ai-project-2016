                     Generalization Error of Linear Neural Networks
                               in an Empirical Bayes Approach
                             Shinichi Nakajima   ‚Ä†‚Ä° and Sumio Watanabe     ‚Ä†
                                    ‚Ä† Tokyo Institute of Technology
          Mailbox R2-5, 4259 Nagatsuda, Midori-ku, Yokohama, Kanagawa, 226-8503 Japan
                         nakajima.s@cs.pi.titech.ac.jp, swatanab@pi.titech.ac.jp
                                          ‚Ä° Nikon Corporation
                     201-9 Oaza-Miizugahara, Kumagaya, Saitama, 360-8559 Japan
                    Abstract                          is neglected, was proposed [Hinton and van Camp, 1993;
                                                      MacKay, 1995; Attias, 1999; Ghahramani and Beal, 2000].1
    It is well known that in unidentiÔ¨Åable models, the  In this paper, we consider another alternative, which we
    Bayes estimation has the advantage of generaliza- call a subspace Bayes (SB) approach. An SB approach is an
    tion performance to the maximum likelihood esti-  empirical Bayes (EB) approach where a part of the parame-
    mation. However, accurate approximation of the    ters of a model are regarded as hyperparameters. If we re-
    posterior distribution requires huge computational gard the parameters of one layer as hyperparameters, we can
    costs. In this paper, we consider an empirical Bayes analytically calculate the marginal likelihood in some three-
    approach where a part of the parameters are re-   layer models. Consequently, what we have to do is only to
    garded as hyperparameters, which we call a sub-   Ô¨Ånd the hyperparameter value maximizing the marginal like-
    space Bayes approach, and theoretically analyze   lihood. The computational costs of an SB approach is thus
    the generalization error of three-layer linear neu- much less than that of posterior distribution approximation by
    ral networks. We show that a subspace Bayes ap-   MCMC methods. At Ô¨Årst in this paper, we prove that in three-
    proach is asymptotically equivalent to a positive- layer linear neural networks, an SB approach is equivalent
    part James-Stein type shrinkage estimation, and be- to a positive-part James-Stein (JS) type shrinkage estimation
    haves similarly to the Bayes estimation in typical [James and Stein, 1961]. Then, we clarify its generalization
    cases.                                            error, also considering delicate situations, the most important
                                                      situations in model selection problems and in statistical tests,
                                                      when the Kullback-Leibler divergence of the true distribution
1  Introduction                                       from the singularities is comparable to the inverse of the num-
                                                                          2
UnidentiÔ¨Åable parametric models, such as neural networks, ber of training samples. We conclude that an SB approach
mixture models, and so on, have a wide range of applica- provides as good performance as the Bayes estimation in typ-
tions. These models have singularities in the parameter space, ical cases.
hence the conventional learning theory of the regular sta- In Section 2, neural networks and linear neural networks
tistical models does not hold. Recently, generalization per- are brieÔ¨Çy introduced. The framework of the Bayes estima-
formance of some unidentiÔ¨Åable models has been theoreti- tion, that of an EB approach, and that of an SB approach are
cally clariÔ¨Åed. In the maximum likelihood (ML) estimation, described in Section 3. The signiÔ¨Åcance of singularities for
which is asymptotically equivalent to the maximum a poste- generalization performance and the importance of analysis of
rior (MAP) estimation, the generalization error of linear neu- delicate situations are explained in Section 4. The SB solu-
ral networks was proved to be greater than that of the reg- tion and its generalization error are derived in Section 5. Dis-
ular models whose dimension of the parameter space is the cussions and conclusions follow in Section 6 and in Section 7,
same when the model is redundant to learn the true distri- respectively.
bution [Fukumizu, 1999]. On the other hand, in the Bayes
estimation, the generalization error of neural networks, lin- 2 Linear Neural Networks
ear neural networks, mixture models, and so on was proved x ‚àà RM                         y ‚àà RN
                                    [                 Let        be an input (column) vector,    an output
to be less than that of the regular models Watanabe, 2001;      w
Aoyagi and Watanabe, 2004; Yamazaki and Watanabe, 2003]. vector, and a parameter vector. A neural network model
                                                      can be described as a parametric family of maps {f(¬∑; w):
  However, the Bayes posterior distribution can seldom be RM ‚Üí RN }                             H
exactly realized. Furthermore, Markov chain Monte Carlo          . A three-layer neural network with hidden
(MCMC) methods, often used for approximation of the pos- 1We have just derived the variational Bayes solution of linear
terior distribution, require huge computational costs. As an neural networks and clariÔ¨Åed its generalization error and training
alternative, the variational Bayes approach, where the corre- error in [Nakajima and Watanabe, 2005b].
lation between parameters and the other parameters, or the 2We have also clariÔ¨Åed the training error, which is put into
correlation between the parameters and the hidden variables [Nakajima and Watanabe, 2005a].units is deÔ¨Åned by                                    where
                                                                    
                      H
                                  t                         n   n                     q(y|x)
             f(x; w)=   h=1 bhœà (ahx),          (1)     G X  ,Y       q x q y|x                 dxdy
                                                          (      )=    ( ) (  )log p y|x, X n,Yn      (9)
                      M     N                                                       (          )
where w = {(ah,bh) ‚àà R  √ó R  ; h =1,...,H}  summa-
rizes all the parameters, œà(¬∑) is an activation function, which is the Kullback-Leibler (KL) divergence of the predictive dis-
is usually a bounded, non-decreasing, antisymmetric, nonlin- tribution from the true distribution, and ¬∑q(Xn,Y n) denotes
ear function like tanh(¬∑),andt denotes the transpose of a the expectation value over all sets of n training samples.
matrix or vector. Assume that the output is observed with a
                     2                                3.2  Empirical Bayes Approach
noise subject to NN (0,œÉ IN ),whereNd(¬µ, Œ£) denotes the
d-dimensional normal distribution with average vector ¬µ and         and Subspace Bayes Approach
covariance matrix Œ£,andId denotes the d√ód identity matrix. We often have little information about the prior distribution,
Then, the conditional distribution is given by        with which an EB approach was originally proposed to cope.
                                          
                              y ‚àí f x w 2           We can introduce hyperparameters in the prior distribution;
  p y|x, w       1          ‚àí       ( ; )    .        for example, when we use a prior distribution that depends
   (     )=      2 N/2 exp           2          (2)
             (2œÄœÉ )                2œÉ                 on a hyperparameter œÑ1 such as
                                                                                            
In this paper, we focus on linear neural networks, whose ac-               1            w2
tivation function is linear, as the simplest multilayer models.3 œÜ(w)=           exp  ‚àí        ,     (10)
                                                                         œÄœÑ2 K/2         2œÑ 2
A linear neural network model (LNN) is deÔ¨Åned by                       (2  1 )             1
                                                                                              œÑ
                 f(x; A, B)=BAx,                (3)   the marginal likelihood, Eq.(5), also depends on 1.InanEB
                                                      approach, œÑ1 is estimated by maximizing the marginal likeli-
                     t
where A =(a1,...,aH ) is an H √ó M input parameter ma- hood or by a slightly different way [Efron and Morris, 1973;
trix and B =(b1,...,bH ) is an N √ó H output parameter Akaike, 1980; Kass and Steffey, 1989]. Extending the idea
matrix. Because the transform (A, B) ‚Üí (TA,BT‚àí1) does above, we can introduce hyperparameters also in a model dis-
not change the map for any non-singular H √ó H matrix T , tribution. What we call an SB approach is an EB approach
the parameterization in Eq.(3) has trivial redundancy. Ac- where a part of the parameters of a model are regarded as hy-
cordingly, the essential dimension of the parameter space is perparameters. In the following sections, we analyze two ver-
given by                                              sions of SB approach: in the Ô¨Årst one, we regard the output
                                  2                   parameter matrix B of the map, Eq.(3), as a hyperparame-
               K = H(M   + N) ‚àí H  .
                                                (4)   ter and then marginalize the likelihood in the input parameter
We assume that H ‚â§ N ‚â§ M throughout this paper.       space (MIP); and in the other one, we regard the input pa-
                                                      rameter matrix A, instead of B, as a hyperparameter and then
3  Framework of Learning Methods                      marginalize in the output parameter space (MOP).
3.1  Bayes Estimation
     n                    n                           4   UnidentiÔ¨Åability and Singularities
Let X  = {x1,...,xn} and Y = {y1,...,yn} be arbitrary
n training samples independently and identically taken from We say that a parametric model is unidentiÔ¨Åable if the map
the true distribution q(x, y)=q(x)q(y|x). The marginal con- from the parameter to the probability distribution is not one-
ditional likelihood of a model p(y|x, w) is given by  to-one. A neural network model, Eq.(1), is unidentiÔ¨Åable be-
                                                     cause the model is independent of ah when bh =0,orvice
                          
           n  n             n                         versa. The continuous points denoting the same distribution
       Z(Y  |X )=    œÜ(w)      p(yi|xi,w)dw,    (5)
                            i=1                       are called the singularities, because the Fisher information
                                                      matrix on them degenerates. When the true model is not on
where œÜ(w) is the prior distribution. The posterior distribu-
                                                      the singularities, asymptotically they do not affect prediction,
tion is given by
                                                      and therefore, the conventional learning theory of the regular
                           n
                      œÜ(w)      p(yi|xi,w)            models holds. On the other hand, when the true model is on
        p(w|Xn,Yn)=          i=1          ,     (6)
                           Z(Y n|Xn)                  the singularities, they signiÔ¨Åcantly affect generalization per-
                                                      formance as follows: in the ML estimation, the extent of the
and the predictive distribution is deÔ¨Åned as the average of the set of the points denoting the true distribution increases its
model over the posterior distribution as follows:
                                                     neighborhoods and hence the Ô¨Çexibility of imitating noises,
           n   n                   n   n              and therefore, accelerates overÔ¨Åtting; while in the Bayes es-
   p(y|x, X ,Y  )=    p(y|x, w)p(w|X ,Y )dw.    (7)   timation, the large entropy of the singularities increases the
                                                      weights of the distributions near the true one, and therefore,
The generalization error, a criterion of generalization perfor- suppresses overÔ¨Åtting. In LNNs, the former property appears
mance, is deÔ¨Åned by                                   as acceleration of overÔ¨Åtting by selection of the largest singu-
                        n   n                         lar value components of a random matrix, and in the SB ap-
            G(n)=G(X    ,Y  )q(Xn,Y n),       (8)
                                                      proaches of LNNs, the latter property appears as James-Stein
  3A linear neural network model is not a toy but an useful model, type shrinkage, as shown in the following sections.
known as a reduced-rank regression model, in many applications Suppression of overÔ¨Åtting accompanies insensitivity to the
[Reinsel and Velu, 1998].                             true components with small amplitude. There is a trade-off,which would, however, be ignored in asymptotic analysis if (The proof is given in Appendix A.)
we would consider only situations when the true model is dis- Because the independence between A and B makes the
tinctly on the singularities or not. Therefore, in this paper, we posterior distribution localized, the following lemma holds.
also consider delicate situations when the KL divergence of
the true distribution from the singularities is comparable to Lemma 1 The predictive distribution in the SB approaches
the inverse of the number of training samples, n‚àí1,which can be written as follows:
                                                                                ‚àí1/2
are important situations in model selection problems and in    n   n        N
statistical tests with Ô¨Ånite number of samples for the follow- p(y|x, X ,Y )= (2œÄ) |VÀÜ |
                                                                                       

ing reasons: Ô¨Årst, that there naturally exist a few true compo-            ‚àí1
                               n‚àí1/2                                    t VÀÜ                   ‚àí3/2
nents with amplitude comparable to  when neither the   ¬∑ exp ‚àí(y‚àíVÀÜ BÀÜAxÀÜ )  (y‚àíVÀÜ BÀÜAxÀÜ ) +O(n    ), (17)
smallest nor the largest model is selected; and secondly, that            2
whether the selected model involves such components essen-
                                                                         ‚àí1
tially affects generalization performance.            where VÀÜ = IN + O(n   ), and |¬∑|denotes the determinant
                                                      of a matrix.
5  Theoretical Analysis
                                                      (Proof) The predictive distribution is written as follows:
5.1  Subspace Bayes Solution
                                                                 n  n
                                           œÑ            p(y|x, X ,Y )=p(y|x, AB)p(A|Xn,Y nB)
By   we, hereafter, distinguish the hyperparameter from                                
the parameter w, for example, p(y|x, wœÑ). Assume that the                 t        ‚àó ‚àó
                                                            ‚àù q(y|x) exp  y (BÀÜAÀÜ ‚àí B A )x  ,        (18)
variance of a noise is known and equal to unity. Then, the                                 p(A|Xn,Y nB)
conditional distribution of an LNN in the MIP version of SB
approach is given by                                  where ¬∑p denotes the expectation value over a distribution p.
                                                                  ‚àó ‚àó       ‚àí1/2
                               y ‚àí BAx2             Since (BÀÜAÀÜ ‚àí B A )=O(n     ) in the SB approaches, we
  p y|x, AB       1         ‚àí              .
   (        )=    œÄ N/2 exp                    (11)   can expand the predictive distribution as follows:
                (2 )                2                                         
We use the following prior distribution:                p y|x, X n,Yn ‚àù q y|x      yt BÀÜAÀÜ ‚àí B‚àóA‚àó x
                                                       (          )    (   ) 1+   (           )
                                    t                                                 
                    1           tr (A A)                                         t  t
        œÜ(A)=            exp  ‚àí          .     (12)                             y vv y        ‚àí3/2
                (2œÄ)HM/2           2                                          +         + O(n     ), (19)
                                                                                 2n   p(A|Xn,Y nB)
                               p(y|x, BA)    œÜ(B)
Note that we can similarly prepare        and                   ‚àö
for the MOP version. We assume that the true conditional where v = n(BÀÜAÀÜ‚àí B‚àóA‚àó)x is an N-dimensional vector of
            p y|x, A‚àóB‚àó        B‚àóA‚àó
distribution is (       ),where      is the true map  order O(1). Calculating the expectation value and expanding
         H‚àó  ‚â§  H               ‚àó
with rank        .Wedenoteby      the true value of a the logarithm of Eq.(19), we arrive at Lemma 1. (Q.E.D.)
parameter as above, and by a hat an estimator of a parameter, Comparing Eq.(16) with the ML estimator
            ÀÜ ÀÜ
for example, A, bh, etc.. For simplicity, we assume that the              
                                     t                                        H      t    ‚àí1
input vector is orthonormalized so that xx q(x)dx = IM .          BÀÜAÀÜ           œâ  œâ  RQ
                                                                      MLE =   h=1 bh bh              (20)
Consequently, the central limit theorem leads to the following
two equations:                                        [Baldi and Hornik, 1995], we Ô¨Ånd that the SB estimator of
                  
          n    ‚àí1   n    t            ‚àí1/2            each component is asymptotically equivalent to a positive-
     Q(X   )=n         xx  = IM + O(n     ),   (13)
                  i=1                                part JS type shrinkage estimator. Moreover, by virtue of
      n   n    ‚àí1   n    t    ‚àó  ‚àó      ‚àí1/2
  R(X  ,Y  )=n      i=1 yx = B A  + O(n     ), (14)   Lemma 1, we can substitute the model at the SB estimator
where Q(Xn)   is an M   √ó  M  symmetric matrix and    for the predictive distribution with asymptotically insigniÔ¨Å-
R(Xn,Yn)  is an N √ó M  matrix. Hereafter, we abbreviate cant impact on generalization performance. Therefore, we
Q(Xn)  as Q,andR(Xn,Yn)  as R.                        conclude that the SB approach is asymptotically equivalent to
  Let Œ≥h be the h-th largest singular value of the matrix the shrinkage estimation. Note that the variance of the prior
RQ‚àí1/2  œâ                                             distribution, Eq.(12), asymptotically has no effect upon pre-
       ,  ah the corresponding right singular vector, and
œâ                                                     diction and hence upon generalization performance, as far as
 bh the corresponding left singular vector. We Ô¨Ånd from
                   ‚àó                         ‚àí1/2     it is a positive, Ô¨Ånite constant. We call L thedegreeofshrink-
Eq.(14) that Œ≥h for H <h‚â§    H  is of order O(n  ).
                                                      age. Remember that we can modify all the theorems in this
Hence, combining with Eq.(13), we get
                                                      paper for the ML estimation only by letting L =0.
   œâ  RQœÅ    œâ  R   O n‚àí1       H‚àó  <h‚â§   H,
    bh     =  bh  +   (   )  for               (15)
where ‚àí‚àû  <œÅ‚àà     R <  ‚àû  is an arbitrary constant. The 5.2 Generalization Error
SB estimator, deÔ¨Åned as the expectation value over the SB Using the singular value decomposition of the true map
posterior distribution, is given by the following theorem: B‚àóA‚àó, we can transform arbitrary A‚àó and B‚àó without change
Theorem 1 Let L = M  in the MIP version or L = N in the of the map into a matrix with its orthogonal row vectors and
                              2
MOP version, and Lh =max(L, nŒ≥h). The SB estimator of another matrix with its orthogonal column vectors, respec-
the map of an LNN is given by                         tively. Accordingly, we assume the above orthogonalities
        
          H        ‚àí1      t    ‚àí1      ‚àí1           without loss of generality. Then, Lemma 1 implies that the
  BÀÜAÀÜ =     (1 ‚àí L  L)œâb  œâ  RQ    + O(n   ). (16)
          h=1      h      h bh                        KL divergence, Eq.(9), with a set of n training samples isgiven by                                              5.3  Large Scale Approximation
                                 
                     ‚àó ‚àó         2                    In a similar fashion to the analysis of the ML estimation in
                 (B  A  ‚àí BÀÜAÀÜ)x
   G(Xn,Yn)=                         + O(n‚àí3/2)       [Fukumizu, 1999], the second term of Eq.(23) can be analyt-
                         2
                                   q(x)               ically calculated in the large scale limit when M, N, H,and
                                                        ‚àó
                H                                    H   go to inÔ¨Ånity in the same order. We deÔ¨Åne the following
                     G   Xn,Yn     O n‚àí3/2 ,                                  ‚àó         ‚àó          
             =    h=1  h(       )+  (     )    (21)   scalars: Œ± = N /M =(N  ‚àíH  )/(M ‚àíH   ), Œ≤ = H /N =
                                                      (H ‚àí  H‚àó)/(N  ‚àí H‚àó),andŒ∫   = L/M   = L/(M  ‚àí  H‚àó).
where                                                                                          
                                                    Let W  be a random matrix subject to WN  (M ,IN  ),and
      n   n   1     ‚àó ‚àót     t t ‚àó  ‚àót     t                                         ‚àí1
Gh(X   ,Y  )=  tr (bhah ‚àí ÀÜbhaÀÜh) (bhah ‚àí ÀÜbhaÀÜh) (22) {u1,...,uN  } the eigenvalues of M W . The measure of
              2                                       the empirical distribution of the eigenvalues is deÔ¨Åned by
                     h                    ¬∑
is the contribution of the -th component. Here tr( ) denotes       ‚àí1
                                                         p u du  N    {Œ¥ u     Œ¥ u    ¬∑¬∑¬∑  Œ¥ u  } ,
the trace of a matrix. We denote by Wd(m, Œ£, Œõ) the d-    ( )  =        ( 1)+   ( 2)+    +  ( N )    (24)
dimensional Wishart distribution with m degrees of freedom, Œ¥ u                         u
          Œ£                       Œõ                   where  ( ) denotes the Dirac measure at . In the large scale
scale matrix , and noncentrality matrix , and abbreviate as limit, the measure, Eq.(24) , converges almost everywhere to
Wd(m, Œ£) the central Wishart distribution.                       
Theorem 2 The generalization error of an LNN in the SB             (u ‚àí um)(uM ‚àí u)
                                                       p(u)du =                    Œ∏(um <u<uM   )du, (25)
approaches can be asymptotically expanded as                           2œÄŒ±u
                                                                   ‚àö                   ‚àö
                       ‚àí1      ‚àí3/2                                        2                   2
             G(n)=Œªn      + O(n    ),                 where um  =(   Œ± ‚àí 1) and uM  =(   Œ± +1)   [Watcher,
                                                      1978]. Calculating moments of Eq.(25), we obtain the fol-
where the coefÔ¨Åcient of the leading term, called the general- lowing theorem:
ization coefÔ¨Åcient in this paper, is given by
                                                      Theorem 3  The generalization coefÔ¨Åcient of an LNN in the
 2Œª =(H‚àó(M    + N) ‚àí H‚àó2)
                                                    large scale limit is given by
                H‚àíH‚àó                  
                                   L   2                                                  ‚àó        ‚àó
                        2                2                     ‚àó            ‚àó2    (M ‚àí H  )(N ‚àí H  )
            +        Œ∏(Œ≥h >L)   1 ‚àí  2 Œ≥h   . (23)      2Œª =(H   (M + N) ‚àí H   )+
                                    Œ≥h                                                      œÄŒ±
                 h=1                        q({Œ≥2})                                      2    
                                               h                                      2
                                                                 J(st;1)‚àí 2Œ∫J(st;0)+Œ∫  J(st; ‚àí1) ,   (26)
                                              2
Here Œ∏(¬∑) is the indicator function of an event, Œ≥h is
the h-th largest eigenvalue of a random matrix subject to where
               ‚àó                                                       
WN‚àíH‚àó  (M  ‚àí H  ,IN‚àíH‚àó ), and ¬∑q({Œ≥2}) denotes the ex-                     2     ‚àí1
                                  h                      J(s;1)=2Œ±(‚àís    1 ‚àí s +cos    s),
pectation value over the distribution of the eigenvalues.           ‚àö  
                                                         J(s;0)=‚àí2    Œ±  1 ‚àí s2 +(1+Œ±)cos‚àí1  s
(Proof) According to Theorem 1, the difference between the                              ‚àö
SB and the ML estimators of a true component with a posi-                            ‚àí1  Œ±(1 + Œ±)s +2Œ±
                            ‚àí1                                           ‚àí (1 ‚àí Œ±)cos        ‚àö         ,
tive singular value is of order O(n ). Furthermore, the gen-                            2Œ±s +  Œ±(1 + Œ±)
eralization error of the ML estimator of the component is the J(s; ‚àí1)
same as that of the regular models because of its identiÔ¨Åabil- Ô£±  ‚àö                          ‚àö
                                                             ‚àö         2                      Œ±(1+Œ±)s+2Œ±
                                                          Ô£¥    Œ± ‚àö  1‚àís   ‚àí    ‚àí1s  1+Œ±    ‚àí1    ‚àö
ity. Hence, from Eq.(4), we obtain the Ô¨Årst term of Eq.(23) Ô£≤2   2 Œ±s+1+Œ±   cos   + 1‚àíŒ± cos  2Œ±s+ Œ±(1+Œ±)
as the contribution of the Ô¨Årst H‚àó components. On the other
                                                         =                             (0 <Œ±<1)       ,
hand, we Ô¨Ånd from Eq.(15) and Theorem 1 that for a redun- Ô£¥
                                                          Ô£≥     1‚àís ‚àí   ‚àí1 s               Œ±
dant component, identifying RQ‚àí1/2 with R affects the SB     2  1+s   cos                 (  =1)
                   O n‚àí1                                                         ‚àö               
estimator only of order ( ), which, hence, does not affect                             ‚àí1
                                     U                and st =max   (Œ∫ ‚àí (1 + Œ±))/2 Œ±, J  (2œÄŒ±Œ≤;0) .Here
the generalization coefÔ¨Åcient. We say that is the general ‚àí1
diagonalized matrix of an N √ó M matrix T if T is singular J (¬∑; k) denotes the inverse function of J(s; k).
                   T    ‚Ñ¶ U‚Ñ¶          ‚Ñ¶      ‚Ñ¶
value decomposed as  =   b   a,where   a and  b are        Delicate
an M √ó M  and an N √ó N orthogonal matrices, respectively. 5.4       Situations
Let D be the general diagonalized matrix of R,andD the In ordinary asymptotic analysis, one considers only situations
(N ‚àí H‚àó) √ó (M ‚àí  H‚àó) matrix created by removing the Ô¨Årst when the amplitude of each component of the true model is
H‚àó columns and rows from D. Then, the Ô¨Årst H‚àó diagonal zero or distinctly-positive. Also Theorem 2 holds only in such
elements of D correspond to the positive true singular value situations. However, as mentioned in the last paragraph of
components and D consists only of noises. Therefore, D is Section 4, it is important to consider delicate situations when
                                                                  ‚àó  ‚àó
the general diagonalized matrix of n‚àí1/2R,whereR is an the true map B‚àöA has tiny but non-negligible singular values
       ‚àó           ‚àó                                                 ‚àó
(N ‚àí H  ) √ó (M ‚àí H  ) random matrix whose elements are such that 0< nŒ≥h <‚àû. Theorem 1 still holds in such situa-
                                       t                                                         ‚àí1/2
independently subject to N1(0, 1),sothatR R is subject tions by replacing the second term of Eq.(16) with o(n ).
                 ‚àó                                               ‚àó
  W     ‚àó M  ‚àí H  ,I    ‚àó
to  N‚àíH  (          N‚àíH  ). The redundant components  We regard H as the number of‚àödistinctly-positive true singu-
       ‚àí1/2                                                            ‚àó‚àí1
imitate n  R  . Hence, using Theorem 1 and Eq.(22), we lar values such that Œ≥h = o( n). Without loss of general-
obtain the second term of Eq.(23) as the contribution of the ity, we assume that B‚àóA‚àó is a non-negative, general diagonal
last (H ‚àí H‚àó) components. Thus, we complete the proof of matrix with its diagonal elements arranged in non-increasing
Theorem 2. (Q.E.D.)                                   order. Let R‚àó be the true submatrix created by removing the     2                                                     2
                                   SB(MIP)                                               SB(MIP)
    1.8                           SB(MOP)                 1.8                           SB(MOP)
    1.6                               ML                  1.6                               ML
                                    Bayes                                                Regular
    1.4                            Regular                1.4
    1.2                                                   1.2
     1                                                     1
    0.8                                                   0.8

   2  lambda / K 0.6                                     2  lambda / K 0.6
    0.4                                                   0.4
    0.2                                                   0.2
     0                                                     0
      0   2   4   6   8   10  12  14  16  18  20            0      2      4     6      8     10     12
                          H*                                                sqrt(n) gamma*
            Figure 1: Generalization error.                   Figure 2: With delicate true components.

    H‚àó                     B‚àóA‚àó        D                  2
Ô¨Årst   columns and rows from    .Then,   ,deÔ¨Ånedin                                       SB(MIP)
the proof of Theorem 2, is the general diagonalized matrix of 1.8                       SB(MOP)
 ‚àí1/2                                    t        1.6                             Bayes
n    R  ,whereR   is a random matrix such that R R is                                 ML(=Regular)
                       ‚àó          ‚àó ‚àó                 1.4
        W     ‚àó M  ‚àí H ,I     ‚àó ,nR R
subject to N‚àíH (         N‚àíH            ). Therefore,     1.2
we obtain the following theorem:                           1
Theorem 4 The generalization coefÔ¨Åcient of an LNN in the  0.8
general situations when the true map B‚àóA‚àó may have delicate 2  lambda / K 0.6
                         ‚àö   ‚àó                            0.4
singular values such that 0 < nŒ≥h < ‚àû is given by
                                                         0.2
                         H         H‚àíH‚àó                  0
       ‚àó            ‚àó2        ‚àó2           2              0      2      4     6      8     10     12
2Œª=(H   (M +N)  ‚àíH    )+    nŒ≥h +       Œ∏(Œ≥h >L)                            sqrt(n) gamma*
                       h=H‚àó+1        h=1                           Figure 3: Single-output LNN.
                                     
        L  2            L        ‚àö
   1 ‚àí      Œ≥2‚àí2 1 ‚àí      Œ≥œât nR‚àóœâ  , (27)   which might seem to be inconsistent with the proved superior-
       Œ≥2  h         Œ≥2  h bh       ah
        h               h                    q(R )  ity of the Bayes estimation to any other learning method when
                                                      we use the true prior distribution. This suspicion is cleared by
     Œ≥ œâ    œâ       h
where h , ah , and bh are the -th largest singular value of consideration of delicate situations in the following.
R, the corresponding right singular vector, and the corre- Using Theorem 4, we can numerically calculate the SB,
sponding left singular vector, respectively, of which ¬∑q(R ) as well as the ML, generalization error in delicate situa-
denotes the expectation value over the distribution.  tions when the true distribution is near the singularities. Fig-
                                                      ure 2 shows the coefÔ¨Åcients of an LNN with M =50input,
6  Discussions                                        N  =30output, and  H  =5hidden units on the assump-
                                                      tion that the true map consists of H‚àó =1distinctly-positive
6.1  Comparison with the ML Estimation                component, three delicate components whose singular val-
             and with the Bayes Estimation
                                                      ues are identical to each other, and the‚àö other one null com-
                                                                                          ‚àó        ‚àó    ‚àó
Figure 1 shows the generalization coefÔ¨Åcients of an LNN with ponent. The horizontal axis indicates nŒ≥ ,whereŒ≥h = Œ≥
M  =50input,  N =30output, and  H =20hidden units.    for h =2,...,4. The Bayes generalization error in deli-
                                       ‚àó
The horizontal axis indicates the true rank H . The verti- cate situations was previously clariÔ¨Åed [Watanabe and Amari,
cal axis indicates the coefÔ¨Åcients normalized by the param- 2003], but unfortunately, only in single-output (SO) LNNs,
eter dimension K, given by Eq.(4). The lines correspond to i.e., N = H =1.5 Figure 3 shows the coefÔ¨Åcients of an
the generalization coefÔ¨Åcients of the SB approaches, clariÔ¨Åed SOLNN with M =5input units on the assumption that
in this paper, that of the ML estimation, clariÔ¨Åed in [Fuku- H‚àó =0and the true singular value of the one component,
mizu, 1999], that of the Bayes estimation, clariÔ¨Åed in [Aoyagi indicated by the horizontal axis, is delicate.WeseeinFig.3
and Watanabe, 2004], and that of the regular models, respec- that the SB approaches have a property similar to the Bayes
tively.4 The results in Fig. 1 have been calculated in the large estimation, suppression of overÔ¨Åtting by the entropy of the
scale approximation, i.e., by using Theorem 3. We have also singularities. We also see that in some delicate situations, the
numerically calculated them by creating samples subject to MIP is worse than the Bayes estimation, which shows consis-
the Wishart distribution and then using Theorem 2, and thus tency with the superiority of the Bayes estimation. We con-
found that the both results almost coincide with each other so clude that in typical cases, the suppression by the singularities
that we can hardly distinguish. We see in Fig. 1 that the SB in the MIP is comparable to, or sometimes stronger than, that
approaches provide as good performance as the Bayes esti-
                                                         5
mation, and that the MIP, moreover, has no greater general- An SOLNN is regarded as a regular model at a view point of the


                                                                                   b           M
                                                                                    a  ‚Üí w ‚àà √ä
ization coefÔ¨Åcient than the Bayes estimation for arbitrary H‚àó, ML estimation because the transform 1 1 makes the
                                                      model linear and hence identiÔ¨Åable, and therefore, the ML general-
  4In the regular models, the normalized generalization coefÔ¨Åcient ization error is identical to that of the regular models. Nevertheless,
is always equal to one, which leads to the penalty term of Akaike‚Äôs an SOLNN has a property of unidentiÔ¨Åable models at a view point
information criterion [Akaike, 1974].                 of the Bayesian learning methods, as shown in Fig. 3.