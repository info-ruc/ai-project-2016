      The   computational      complexity     of dominance      and  consistency     in CP-nets

    Judy  Goldsmith             Jer¬¥ omeÀÜ Lang        Miroslaw  Truszczynski¬¥          Nic Wilson
  Dept. of Comp.   Sci.              IRIT               Dept. of Comp.  Sci.         Cork Constraint
 University of Kentucky    Universite¬¥ Paul Sabatier  University of Kentucky       Computation  Centre
     Lexington, KY          31062  Toulouse Cedex         Lexington,  KY         University College Cork
   40506-0046,  USA                 France               40506-0046,  USA                Ireland
  goldsmit@cs.uky.edu            lang@irit.fr            mirek@cs.uky.edu          n.wilson@4c.ucc.ie

                    Abstract                            We study the computational complexity of these two prob-
                                                      lems. The results obtained so far concerned only restricted
    We  investigate the computational complexity of   classes of CP-nets, all requiring that the graph of variable de-
    testing dominance and consistency in CP-nets. Up  pendencies implied by preference statements in the CP-net be
    until now, the complexity of dominance has been   acyclic. Under certain assumptions, the dominance-testing
    determined only for restricted classes in which the problem is in NP and, under some additional assumptions,
    dependency graph of the CP-net is acyclic. How-   even in P [Domshlak and Brafman, 2002; Boutilier et al.,
    ever, there are preferences of interest that deÔ¨Åne 2004a]. Its complexity in the general case has remained until
    cyclic dependency graphs; these are modeled with  now an open problem. We show that it is in fact PSPACE-
    general CP-nets. We show here that both domi-     complete, even for the propositional case, by exhibiting in
    nance and consistency testing for general CP-nets Section 4 a PSPACE-hardness proof for dominance testing.
    are PSPACE-complete. The reductions used in the     We  then turn to consistency testing. While acyclic CP-
    proofs are from STRIPS planning, and thus estab-  nets are guaranteed to be consistent, this is not the case
    lish strong connections between both areas.       with general CP-nets (see [Domshlak and Brafman, 2002;
                                                      Brafman and Dimopoulos, 2004] for detailed examples and
1  Introduction                                       discussions). In Section 5, we show that consistency testing
The problems of eliciting, representing and reasoning with is as hard as dominance testing.
preferences over a multivariable (or, multiattribute) domain To prove the hardness part of the results, we Ô¨Årst establish
                                                         PSPACE
arise in many Ô¨Åelds such as planning, design, and group de- the  -hardness of some problems related to proposi-
cision making. An explicit representation of a preference or- tional STRIPS planning. We then show that these problems
dering of elements (we refer to them as outcomes) of such can be reduced to CP-net dominance and consistency testing
multivariable domains is exponentially large in the number by exploiting connections between actions in STRIPS plan-
of attributes. Therefore, AI researchers have developed lan- ning and preference statements in CP-nets.
guages for representing preference orderings succinctly. The We assume some familiarity with the complexity class
                                                      PSPACE             [                 ]
formalism of CP-nets [Boutilier et al., 1999] is among the     (we refer to Papadimitriou, 1994 for details). In
                                                                                             NPSPACE   =
most popular ones. A CP-net provides a succinct represen- particular, we rely later on the equivalences
                                                      PSPACE   = coPSPACE
tation of preference ordering on outcomes in terms of local                .
                                                        The complexity results in this paper address cyclic CP-
preference statements of the form p : xi > xj , where xi, xj
are values of a variable X and p is a logical condition. Infor- nets. Most earlier work has concentrated on the acyclic
mally, a preference statement p : x > x means that given model. However, we argue that acyclic CP-nets are not suf-
                              i    j                  Ô¨Åciently expressive to capture human preferences on even
p, xi is (strictly) preferred to xj ceteris paribus, that is, all
other things being equal. The meaning of a CP-net is given some simple domains. Consider, for instance, a diner who
by a certain ordering relation (dominance) on the set of out- has to choose either red or white wine, and either Ô¨Åsh or meat.
comes, derived from such reading of preference statements. Given red wine, they prefer meat, and conversely, given meat
If one outcome dominates another, we say that the dominant they prefer red wine. On the other hand, given white wine,
one is preferred.                                     they prefer Ô¨Åsh, and conversely, given Ô¨Åsh they prefer white
  Reasoning about the preference ordering (dominance rela- wine. This gives a consistent cyclic CP-net, and there is no
tion) expressed by a CP-net is far from easy. The key prob- acyclic CP-net giving rise to the same preferences on out-
lems include dominance testing and consistency testing. In comes. So, such cyclicity of preference variables does not
the Ô¨Årst problem, given a CP-net and two outcomes Œ± and Œ≤, necessarily lead to a cyclic order on outcomes.
we want to decide whether Œ≤ dominates Œ±. The second prob-
lem asks whether there is a dominance cycle in the dominance 2 Generalized propositional CP-nets
ordering deÔ¨Åned by an input CP-net, that is, whether there is Let V = {x1, . . . , xn} be a Ô¨Ånite set of variables. For each
an outcome that dominates (is preferred to) itself.   variable x ‚àà V , we assume a Ô¨Ånite domain Dx of values. Anoutcome is an n-tuple (d1, . . . , dn) of Dx1 √ó ¬∑ ¬∑ ¬∑ √ó Dxn . DeÔ¨Ånition 3
  In this paper, we focus on propositional variables: vari- A GCP-net C over V is locally consistent if for every x ‚àà
                                                                    ‚àí       +
ables with binary domains. Let V be a Ô¨Ånite set of propo- V , the formula pC (x) ‚àß pC (x) is unsatisÔ¨Åable. It is locally
                        x    V       D       x, x                                         ‚àí      +
sitional variables. For every ‚àà , we set x = { ¬¨ }    complete if for every x ‚àà V , the formula pC (x) ‚à® pC(x) is a
(thus, we overload the notation and write x both for the vari- tautology.
able and for one of its values). We refer to x and ¬¨x as liter-
                                                      DeÔ¨Ånition 4 (Propositional CP-net) A CP-net over the set
               l        ¬¨l                       l
als. Given a literal we write to denote the dual literal to . V of (propositional) variables is a locally consistent and lo-
The focus on binary variables makes the presentation clearer cally complete GCP-net over V .
and has no impact on our complexity results.
  A conditional preference rule (or, for short, a [preference] Problems CP-DOMINANCE and CP-CONSISTENCY are de-
rule) over V is an expression p : l > ¬¨l, where l is a literal Ô¨Åned analogously to DeÔ¨Ånition 2.
of some atom x ‚àà V and p is a propositional formula over V This deÔ¨Ånition of a CP-net differs from the one given in
that does not involve variable x.                     [Boutilier et al., 2004a], which uses explicit conditional pref-
                                                      erence tables. Our representation is often more compact, but
DeÔ¨Ånition 1 (Generalized CP-net) A generalized CP-net C it is easy to verify that it is equivalent in that it gives rise to
(for short, a GCP-net) over V is a set of conditional prefer-
                             +         ‚àí              the same deÔ¨Ånition of dominance.
ence rules. For x ‚àà V we deÔ¨Åne pC (x) and pC (x), usually When deÔ¨Åning a decision problem, it is critical to specify
            +        ‚àí               +
written just: p (x) and p (x), as follows: pC (x) is equal to the way to represent its input instances, as the representation
the disjunction of all p such that there exists a rule p : x > ¬¨x may affect the complexity of the problem. Unless stated oth-
      ‚àí
in C; pC(x) is the disjunction of all p such that there exists erwise, we assume that GCP-nets (and so, also CP-nets) are
a rule p : ¬¨x > x in C. We deÔ¨Åne the associated directed represented as a set of preference rules, as described in DeÔ¨Å-
graph GC (the dependency graph) over V to consist of all nition 1. Therefore, the size of a GCP-net is given by the total
                                              +
pairs (y, x) of variables such that y appears in either p (x) size of the formulas p‚àí(x), p+(x), x ‚àà V .
or p‚àí(x).
  In our complexity results we will also need the following 3 Propositional STRIPS planning
representation of GCP-nets: a GCP-net C is said to be in con- In this section we derive some technical results on proposi-
junctive form if C only contains rules p : l > ¬¨l such that p tional STRIPS planning which form the basis of our complex-
is a (possibly empty) conjunction of literals. In this case all ity results in Sections 4 and 5. We establish the complexity of
formulas p‚àí(x), p+(x) are in disjunctive normal form, that plan existence problems for propositional STRIPS planning,
is, a disjunction of conjunctions of literals (including > ‚Äì the under restrictions on input instances that make the problem
empty conjunction of literals).                       useful in the studies of dominance and consistency in GCP-
  GCP-nets determine a transitive relation on outcomes, in- nets.
terpreted in terms of preference. A preference rule p : l > ¬¨l Let V be a Ô¨Ånite set of variables. A state over V is a com-
represents the statement ‚Äúgiven that p holds, l is preferred to plete and consistent set of literals over V (which we often
¬¨l ceteris paribus‚Äù. Its intended meaning is as follows. If view as the conjunction of its members). A state is therefore
outcome Œ≤ satisÔ¨Åes p and l, then Œ≤ is preferred to the out- equivalent to an outcome, deÔ¨Åned in a CP-nets context.
come Œ± which differs from Œ≤ only in that it assigns ¬¨l for
                                                      DeÔ¨Ånition 5 (Propositional STRIPS planning) A proposi-
variable x. In this situation we say that there is an improv-
                                                      tional STRIPS instance is a tuple hV, Œ± , Œ≥, ACT i, where
ing Ô¨Çip from Œ± to Œ≤ sanctioned by the rule p : l > ¬¨l. If                              0
                                                        1. V is a Ô¨Ånite set of propositional variables;
Œ±0, . . . , Œ±m is a sequence of outcomes with m ‚â• 1 and each
next outcome in the sequence is obtained from the previous 2. Œ±0 is a state (over V ), called the initial state;
                                    Œ± , . . . , Œ±
one by an improving Ô¨Çip, then we say that 0 m is an     3. Œ≥ is a state called the goal;
improving sequence (from Œ±0 to Œ±m) for the GCP-net, and
                                                        4. ACT  is a Ô¨Ånite set of   , where each action a
that Œ±m dominates Œ±0, written Œ±0 ‚â∫ Œ±m.                                        actions                  ‚àà
  Finally, A GCP-net is consistent if there is no outcome Œ± ACT is described by a consistent conjunction of literals
which is strictly preferred to itself, i.e., such that Œ± ‚â∫ Œ±. pre(a) (a precondition) and a consistent conjunction of
  The main objective of the paper is to establish the com- literals post(a) (a postcondition, or effect).
plexity of the following two problems concerning the notion An action a is executable in a state Œ± if Œ± |= pre(a). The ef-
of dominance associated with GCP-nets (sometimes under re- fect of a in state Œ± is the state Œ±0 containing the same literals
strictions on the class of input GCP-nets).           as Œ± for all variables not mentioned in post(a), and the liter-
                                                      als of post(a) otherwise. We assume that an action can be ap-
DeÔ¨Ånition 2
                                                           to any state, but that it has no effect if its preconditions
               : given a GCP-net C and two outcomes Œ± plied
GCP-DOMINANCE                                         do not hold (this assumption has no effect on complexity).
and Œ≤, decide whether Œ± ‚â∫ Œ≤ in C.
                                                      The                                      problem, or
                 : given a GCP-net C, decide whether C    PROPOSITIONAL  STRIPS PLAN EXISTENCE
GCP-CONSISTENCY                                                    for short, is to decide whether for a given
is consistent.                                        STRIPS PLAN
                                                      propositional STRIPS instance hV, Œ±0, Œ≥, ACT i there is a
  There are two properties of GCP-nets that are essential in successful plan, that is, sequence of actions leading from the
linking them to the original notion of CP-nets [Boutilier et initial state Œ±0 to a state satisfying the goal Œ≥.
al., 1999; 2004a].                                    A plan is irreducible if its every action changes the state.We assume, without loss of generality, that for any action a, We will denote states over V 0 by pairs (Œ±, k), where Œ± is
no literal in post(a) also appears in pre(a); otherwise we can a state over V and k is an integer, 0 ‚â§ k ‚â§ 2n ‚àí 1. We
omit the literal from post(a) without changing the effect of view k as a compact representation of a state over variables
the action; (if post(a) then becomes an empty conjunction, z1, . . . , zn: assuming that the binary representation of k is
the action a can be omitted from ACT as it has no effect). d1 . . . dn (with dn being the least signiÔ¨Åcant digit), k repre-
  We have the following result, proved in [Bylander, 1994] : sents the state which contains zi if di = 1 and ¬¨zi, otherwise.
                                                           0                                  ACT  0
Proposition 1 ([Bylander, 1994])                        PE  is acyclic, since executing any action in incre-
                                                      ments the counter k and no action can be executed once the
STRIPS PLAN is PSPACE-complete.
                                                      counter has reached the value 2n ‚àí 1.
  Typically, propositional STRIPS instances do not require We claim that there is a plan for PE if and only if there is
that goals be complete. We restrict consideration to com- a plan for PE0. First, assume that there is a plan in PE. Let
plete goals. This restriction has no effect on the complex- œÄ be a shortest plan in PE and let m be its length. We have
ity: the plan existence problem remains PSPACE-complete m ‚â§ 2n ‚àí1, since no state along œÄ repeats (otherwise, shorter
under the goal-completeness restriction [Lang, 2004]. plans than œÄ for PE would exist). Let Œ±0, Œ±1, . . . , Œ±m =
                                                      Œ≥ be the sequence of states obtained by executing œÄ. Let a
3.1  Acyclic STRIPS
                                                      be the action used in the transition from Œ±k to Œ±k+1. Since
DeÔ¨Ånition 6 (Acyclic sets of actions) A set of actions ACT k < 2n ‚àí 1, there is exactly one i, 1 ‚â§ i ‚â§ n, such that
is acyclic if there is no state Œ± such that hV, Œ±, Œ±, ACT i has the action ai applies at the state (Œ±, k) over V 0. Replacing a
                                                            i
a non-empty irreducible plan (informally, if there are no non- with a in œÄ yields a plan that when started at (Œ±0, 0) leads
trivial directed cycles in the space of states induced by ACT ). to (Œ±m, m) = (Œ≥, m). Appending that plan with appropriate
                                                            b                        2n ‚àí 1
We will now consider the following two problems:      actions i to increment the counter to yields a plan for
                                                      PE0. Conversely, if œÑ is a plan for PE0, the plan obtained from
 1. ACYCLIC STRIPS PLAN: given a propositional STRIPS œÑ by removing all actions of the form bj and replacing each
    instance hV, Œ±0, Œ≥, ACTi such that ACT is acyclic action ai with a is a plan for PE.
    and Œ±0  6=  Œ≥, decide whether there is a plan for   Thus, the claim and the assertion follow.      
    hV, Œ±0, Œ≥, ACTi.
 2. ACTION-SET ACYCLICITY: given a set ACT of actions, Proposition 3
                 ACT
    decide whether    is acyclic.                     ACTION-SET  ACYCLICITY is PSPACE-complete.
We will show that both problems are PSPACE-complete.  Proof: The argument for the membership in PSPACE is
Proposition 2                                         standard. To  prove PSPACE-hardness,  we proceed as
ACYCLIC STRIPS PLAN is PSPACE-complete.               follows. Let PE = hV, Œ±0, Œ≥, ACT i be a STRIPS instance
                                                      such that ACT is acyclic and Œ± 6= Œ≥. Let a be a new action
Proof: Membership in PSPACE is evident as the problem is a                       0
                                                      deÔ¨Åned by pre(a) = Œ≥ and post(a) = Œ± . It is easy to see
                               PSPACE                                                    0
restriction of STRIPS PLAN. To prove   -hardness, we  that ACT ‚à™ {a} is not acyclic if and only if there exists a
exhibit a polynomial-time reduction from STRIPS PLAN. Let
                                                      plan for PE. Thus, the PSPACE-hardness of the complement
PE = hV, Œ± , Œ≥, ACTi be an instance of STRIPS PLAN. The
          0                                           of the ACTION-SET  ACYCLICITY  problem follows from
                                     counter
idea behind the reduction is to introduce a , so that Proposition 2. Since PSPACE = coPSPACE,  this sufÔ¨Åces
each time an action is executed, the counter is incremented.
                                                      to prove the hardness part of the assertion.     
The counter may count up to 2n, where n = |V |, making
use of n additional variables. The counter is initialized to 0.
Once it reaches 2n ‚àí 1 it can no longer be incremented and 3.2 Mapping STRIPS plans to single-effect
no action can be executed. Hence, the set of actions in the STRIPS  plans
resulting instance of STRIPS PLAN is acyclic.
                                                      Versions of the STRIPS PLAN and ACYCLIC STRIPS PLAN
  To describe the reduction, we write V as {x1, . . . , xn}. We
deÔ¨Åne PE0 = hV 0, Œ±0 , Œ≥0, ACT 0i as follows:         problems that are important for us allow only single-effect ac-
                 0                                    tions (actions with exactly one literal in their postconditions)
      0
  ‚Ä¢ V  = {x1, . . . , xn, z1, . . . , zn}, where zi are new vari- in input propositional STRIPS instances. We refer to these re-
    ables we will use to implement the counter;       strictions as SE STRIPS PLAN and ACYCLIC SE STRIPS PLAN.
     0                                                           PSPACE
  ‚Ä¢ Œ±0 = Œ±0 ‚àß ¬¨z1 ‚àß ¬∑ ¬∑ ¬∑ ‚àß ¬¨zn;                        To prove         -hardness of both problems, we de-
     0                                                scribe a mapping from STRIPS instances to single-effect
  ‚Ä¢ Œ≥ = Œ≥ ‚àß z ‚àß ¬∑ ¬∑ ¬∑ ‚àß zn;
             1                                        STRIPS instances.
                                          0
  ‚Ä¢ for each action a ‚àà ACT , we include in ACT n actions Consider an instance PE = hV, Œ±0, Œ≥, ACT i of the STRIPS
     i
    a , 1 ‚â§ i ‚â§ n, such that                          PLAN problem (where ACT  is not necessarily acyclic). For
         i
    pre(a ) = pre(a) ‚àß ¬¨zi ‚àß zi+1 ‚àß ¬∑ ¬∑ ¬∑ ‚àß zn        each action a ‚àà ACT we introduce a new variable xa. We
    post ai   post a   z    z           z
        ( ) =     ( ) ‚àß i ‚àß ¬¨ i+1 ‚àß ¬∑ ¬∑ ¬∑ ‚àß ¬¨ n       set X =  Va‚ààACT  ¬¨xa.  That is, X is the conjunction of
                                0
  ‚Ä¢ Furthermore, we include in ACT n actions bi, 1 ‚â§ i ‚â§ negative literals of all the additional variables. In addition,
    n, such that                                      for each a ‚àà ACT we set Xa = xa ‚àß Vb‚ààACT‚àí{a} ¬¨xb. We
                                                                             0     0  0  0
    pre(bi) = ¬¨zi ‚àß zi+1 ‚àß ¬∑ ¬∑ ¬∑ ‚àß zn                 now deÔ¨Åne an instance PE = hV , Œ±0, Œ≥ , S(ACT )i of the
    post(bi) = zi ‚àß ¬¨zi+1 ‚àß ¬∑ ¬∑ ¬∑ ‚àß ¬¨zn               SE STRIPS PLAN problem as follows:                    0
  ‚Ä¢ Set of variables: V = V ‚à™ {xa : a ‚àà ACT };        the GCP-DOMINANCE  and GCP-CONSISTENCY  problems by
                0                                     constructing a reduction in the other direction.
  ‚Ä¢ Initial state: Œ±0 = Œ±0 ‚àß X;
               0                                        This reduction is much more complex than the one used in
  ‚Ä¢ Goal state: Œ≥ = Œ≥ ‚àß X;                            [Boutilier et al., 1999], due to the fact that CP-nets impose
  ‚Ä¢ Set of actions: S(ACT ) = {ai : a ‚àà ACT  , i =    more restrictions than STRIPS planning. Firstly, STRIPS
    1, . . . , 2|post(a)| + 1}.                       planning allows multiple effects, but GCP-nets only allow
    Let a ‚àà  ACT   and post(a) =  l1 ‚àß ¬∑ ¬∑ ¬∑ ‚àß lq. For Ô¨Çips x > ¬¨x or ¬¨x > x that change the value of one vari-
    i = 1, . . . , q, we deÔ¨Åne:                       able; this is why we constructed the reduction from STRIPS
        i                          i
    pre(a ) = pre(a) ‚àß X ‚àß ¬¨li; post(a ) = xa;        planning to single-effect STRIPS planning in the last section.
        q+i              q+i
    pre(a  ) = Xa; post(a   ) = li.                   Secondly, CP-nets impose two more restrictions, local con-
    We also deÔ¨Åne:                                    sistency and local completeness, which do not have natural
        2q+1                          2q+1
    pre(a   ) = Xa ‚àß l1 ‚àß ¬∑ ¬∑ ¬∑ ‚àß lq; post(a ) = ¬¨xa. counterparts in the context of STRIPS planning.
  Let œÄ be a sequence of actions in ACT . We deÔ¨Åne S(œÄ) to For all dominance and consistency problems considered in
be the sequence of actions in S(ACT ) obtained by replacing the paper, the membership in PSPACE can be demonstrated
each action a in œÄ by a1, . . . , a2q+1 (where q = |post(a)|). by considering nondeterministic algorithms consisting of re-
Now consider a sequence œÑ of actions from S(ACT ). Re- peatedly guessing appropriate improving Ô¨Çips. Such algo-
move from œÑ any action ai such that i 6= 2|post(a)| + 1, and rithms work in polynomial space and show the membership
replace actions of the form a2|post(a)|+1 by a. We denote the of problems they solve in NPSPACE and consequently in
resulting sequence of actions from ACT by S0(œÑ). The fol- PSPACE, since NPSPACE = PSPACE. Therefore, due to
lowing properties are easy to check (details are omitted): space restrictions, from now on we only provide arguments
                                                      for the PSPACE-hardness of problems we consider.
Lemma  1 With the above deÔ¨Ånitions,
 (i) if œÄ is a plan for PE then S(œÄ) is a plan for PE0; 4.1 Dominance  for generalized CP-nets
(ii) if œÑ is an irreducible plan for PE0 then S0(œÑ) is a plan We will prove that the GCP-DOMINANCE problem is
    for PE;                                           PSPACE-complete   by a reduction from the problem SE
(iii) ACT is acyclic if and only if S(ACT ) is acyclic. STRIPS PLAN, which we now know to be PSPACE-complete.
Proposition 4                                         Mapping  single-effect STRIPS problems to GCP-nets
SE STRIPS  PLAN  and ACYCLIC   SE STRIPS  PLAN  are   dominance problems
PSPACE-complete.                                      Let hV, Œ±0, Œ≥, ACT i be an instance of the SE STRIPS PLAN
Proof: SE STRIPS PLAN and ACYCLIC  SE  STRIPS PLAN    problem. For every action a ‚àà ACT we denote by la the
                                                      unique literal in the postcondition of a, that is, post(a) = la.
problems are restrictions of STRIPS PLAN, from which                 0
membership in PSPACE   follows. PSPACE-hardness  of   We denote by pre (a) the conjunction of all literals in pre(a)
                                                      different from ¬¨la (we recall that by a convention we adopted
ACYCLIC SE STRIPS PLAN  (and so, also of the other prob-       0
                                                      earlier, pre (a) does not contain la either). We then deÔ¨Åne ca
lem) is shown by reduction from ACYCLIC STRIPS PLAN.                                    0
                                                      to be the conditional preference rule pre (a) : la > ¬¨la and
Consider an instance PE = hV, Œ±0, Œ≥, ACT i of ACYCLIC
                      0     0  0  0                   deÔ¨Åne M(ACT  ) to be the GCP-net C = {ca: a ‚àà ACT }.
STRIPS PLAN. DeÔ¨Åne PE  =  hV , Œ±0, Œ≥ , S(ACT )i, which
by Lemma  1(iii) is an instance of the ACYCLIC SE STRIPS A sequence of states in a plan corresponds to an improving
PLAN problem. By Lemma  1(i) and (ii) there exists a plan sequence from Œ±0 to Œ≥, which leads to the following result.
                                      0
for PE if and only if there exists a plan for PE .   Lemma  2  With the above notation,
                                                       (i) there is  a   non-empty  irreducible plan  for
4  Dominance                                              hV, Œ±0, Œ≥, ACTi if and only if Œ≥ dominates Œ±0 in
                                                          C;
The goal of this section is to prove that the GCP-DOMINANCE
problem is PSPACE-complete, and that the complexity does (ii) ACT is acyclic if and only if M(ACT ) is consistent.
not go down even when we restrict the class of inputs to CP-
                                                      Theorem  1 The GCP-DOMINANCE   problem is PSPACE-
nets. We use the results on propositional STRIPS planning complete. Moreover, this remains so under the restrictions
from Section 3 to prove that the general GCP-DOMINANCE that the GCP-net is consistent and is in conjunctive form.
problem is PSPACE-complete. We then show that the com-
plexity does not change if we impose the requirements of lo- Proof: PSPACE-hardness is shown by  reduction
cal consistency and local completeness on input GCP-nets. from ACYCLIC SE STRIPS PLAN (Proposition 4). Let
  The similarities between dominance testing in CP-nets and hV, Œ±0, Œ≥, ACTi be an instance of the ACYCLIC SE STRIPS
propositional STRIPS planning were Ô¨Årst noted in [Boutilier PLAN problem. By Lemma 2(ii), M(ACT ) is a consistent
et al., 1999], where a reduction (presented in more detail GCP-net in conjunctive form. Since Œ±0 6= Œ≥, there is a
in [Boutilier et al., 2004a]) was given from the dominance plan for hV, Œ±0, Œ≥, ACT i if and only if there is a non-empty
problem to the plan existence problem for a class of propo- irreducible plan for hV, Œ±0, Œ≥, ACT i, which, by Lemma 2(i),
sitional STRIPS planning speciÔ¨Åcations consisting of unary is if and only if Œ≥ dominates Œ±0 in C.      
actions (actions with single effects). We prove our results for4.2  Dominance  in CP-nets                             (i) if s is an improving sequence for C from Œ± to Œ≤ then
                                                                                         0           ¬Ø
In this section we show that GCP-DOMINANCE  remains       L(s) is an improving sequence for C from Œ±Œ±¬Ø to Œ≤Œ≤;
PSPACE-complete  under the restriction to locally-consistent (ii) if t is an improving sequence from Œ±Œ±¬Ø to Œ≤Œ≤¬Ø then L0(t)
and locally-complete GCP-nets, i.e., CP-nets. We refer to this is an improving sequence from Œ± to Œ≤;
restriction of GCP-DOMINANCE as CP-DOMINANCE.         (iii) C is consistent if and only if C0 is consistent
  We will show PSPACE-hardness for CP-DOMINANCE by                            n
a reduction from GCP-DOMINANCE for consistent GCP-nets. Sketch of proof: Let e = Vi=1(xi ‚Üî yi). The deÔ¨Ånitions
                                                      have been arranged to ensure the following for CP-net C 0 :
Mapping locally-consistent GCP-nets to CP-nets
                                                       (a) Suppose e holds in an outcome, so the outcome can
Let C  be  a locally-consistent GCP-net. Let V   =
                                               0          be written as Œ±Œ±¬Ø for some Œ±; then no improving Ô¨Çip
{x1, . . . , xn} be the set of variables of C. We deÔ¨Åne V =
                                                          changes any variable xi; furthermore, there is an im-
V ‚à™ {y1, . . . , yn}, where {y1, . . . , yn} ‚à© V = ‚àÖ. We deÔ¨Åne a
         0      0                                         proving Ô¨Çip changing variable yi if and only if there is
GCP-net C over V , which we will show is a CP-net. To this an improving Ô¨Çip for the GCP-net C from outcome Œ±
end, for every z ‚àà V 0 we will deÔ¨Åne conditional preference
                                                          changing variable xi. After applying this Ô¨Çip changing
rules q+(z) : z > ¬¨z and q‚àí(z) : ¬¨z > z to be included in
                                                          variable yi, there is exactly one improving Ô¨Çip possible,
C0 by specifying formulas q+(z) and q‚àí(z).
                                                          changing xi, after which e holds again (this follows us-
  First, for each variable xi ‚àà V , we set
                                                          ing (b), as yi cannot be immediately Ô¨Çipped back again,
            +               ‚àí                             because C0 is locally consistent).
           q (xi) = yi and q  (xi) = ¬¨yi.
                                                       (b) If e does not hold in an outcome then the only improving
Thus, xi depends only on yi. We also note that the for-
      +         ‚àí                                         Ô¨Çips possible change the value of some variable (xi or
mulas q (xi) and q (xi) satisfy local-consistency and local-
                                                          yi) to make xi ‚Üî yi hold for some i.
completeness requirements.
                                                        (a) implies (i) and (ii). Also, (i) implies half of (iii), that
  Next, for each variable yi, 1 ‚â§ i ‚â§ n, we deÔ¨Åne
                                                      if C is inconsistent then C0 is inconsistent. Conversely,
                                                                   0
      ei  =  (x1 ‚Üî y1) ‚àß ¬∑ ¬∑ ¬∑ ‚àß (xi‚àí1 ‚Üî yi‚àí1)        suppose that C is inconsistent, so there exists an improving
                                                              t    C0
             ‚àß(xi+1 ‚Üî  yi+1) ‚àß ¬∑ ¬∑ ¬∑ ‚àß (xn ‚Üî yn),     sequence  for   from some outcome to itself. By (b), any
                                                      improving Ô¨Çip applied to an outcome in which e does not
        +        +           ‚àí        ‚àí
       fi = ei ‚àß p (xi) and fi = ei ‚àß p (xi).         hold increases (by one) the number of i such that xi ‚Üî yi
                                                      holds. This implies that e must hold in some outcome in
Finally, we deÔ¨Åne
                                                      t, because t is cyclic. Write this outcome as Œ±Œ±¬Ø. We can
              +        +      ‚àí                                       t                               Œ±Œ±¬Ø
             q  (yi) = fi ‚à® (¬¨fi ‚àß xi)                cyclically permute to form an improving sequence from
                                                      to itself. Part (ii) then implies that there exists an improving
and                                                   Ô¨Çipping sequence for C from Œ± to itself, showing that C is
              ‚àí       ‚àí       +
             q (yi) = fi ‚à® (¬¨fi ‚àß ¬¨xi)                inconsistent.                                    
                                 0
Thus, yi depends on every variable in V but itself.
                                               +
  We note that by the local consistency of C, formulas fi ‚àß Theorem 2 CP-DOMINANCE is PSPACE-complete. This
 ‚àí
fi , 1 ‚â§ i ‚â§ n, are unsatisÔ¨Åable. Consequently, formulas holds even if we restrict the CP-nets to being consistent.
 +       ‚àí                                      0
q (yi) ‚àß q (yi), 1 ‚â§ i ‚â§ n, are unsatisÔ¨Åable. Thus, C is Proof: We use a reduction from PSPACE-hardness of the
                       q+(y ) ‚à® q‚àí(y )
locally consistent. Finally, i     i  is equivalent to GCP-DOMINANCE  problem when the GCP-nets are restricted
 +          ‚àí                            0
fi ‚à® ¬¨xi ‚à® fi ‚à® xi, so is a tautology. Thus, C is locally to being consistent (Theorem 1). Let C be a consistent
                              0
complete and hence a CP-net over V .                  (and hence locally consistent) GCP-net over V , and let Œ±
  Let Œ±  and  Œ≤ be  outcomes over  {x1, . . . , xn} and and Œ≤ be outcomes over V . Consider the CP-net C 0 over
{y1, . . . , yn}, respectively. By Œ±Œ≤ we denote the outcome variables V 0 constructed above. Lemma 3(i) and (ii) imply
      0
over V obtained by concatenating n-tuples Œ± and Œ≤. Con- that Œ≤ dominates Œ± in C if and only if Œ≤Œ≤¬Ø dominates Œ±Œ±¬Ø in
                        0
versely, every outcome for C can be written in this way. C0. Moreover, C0 is consistent by Lemma 3(iii). Thus, the
  Let Œ± be an outcome over V . We deÔ¨Åne Œ±¬Ø to be the out- hardness part of the assertion follows.      
come over {y1, . . . , yn} obtained by replacing in Œ± every
component of the form xi with yi and every component ¬¨xi
with ¬¨yi. Then for every i, 1 ‚â§ i ‚â§ n, Œ±Œ±¬Ø |= ei.     5   Consistency  of GCP-nets
  Let s be  a sequence Œ±0, . . . , Œ±m of outcomes over
V .  DeÔ¨Åne  L(s) to be the sequence of V 0-outcomes:  In this section we show that the GCP-CONSISTENCY problem
                                                      is PSPACE-complete, using results from Sections 3 and 4.
Œ±0Œ±0, Œ±0Œ±1, Œ±1Œ±1, Œ±1Œ±2, . . . , Œ±mŒ±m. Further, let t be a se-
                       0
quence 0, 1, . . . , m of V -outcomes with 0 = Œ±Œ±¬Ø and Theorem 3
       ¬Ø          0
m = Œ≤Œ≤.  DeÔ¨Åne L (t) to be the sequence obtained from t GCP-CONSISTENCY is PSPACE-complete. This holds even
by projecting each element in t to V and iteratively removing under the restriction to GCP-nets in conjunctive form.
elements in the sequence which are the same as their prede-
                                                      Proof:  PSPACE-hardness   is shown by reduction from
cessor (until any two consecutive outcomes are different).
                                                      ACTION-SET  ACYCLICITY.   We  apply function S from
Lemma  3 With the above deÔ¨Ånitions,                   Section 3.2 followed by M from Section 4.1. This maps