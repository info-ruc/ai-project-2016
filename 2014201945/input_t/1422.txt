                 Mining    Spatial   Object   Associations     for Scientiï¬c    Data  Â 

                       Hui Yang,  Srinivasan  Parthasarathy   and  Sameep  Mehta
                           Department  of Computer   Science and Engineering
                                         Ohio  State University
                                2015 Neil Avenue,  Columbus,  OH   43210

                    Abstract                          more suitable for capturing the shape of vortices in ï¬‚uid
                                                      ï¬‚ow datasets [Sadarjoen et al., 1998]. Alternatively, defect
    In this paper, we present efï¬cient algorithms to dis- structures in materials may require irregular shape descrip-
    cover spatial associations among features extracted tors [Mehta et al., 2004]. In this work, we propose to use dif-
    from scientiï¬c datasets. In contrast to previous  ferent shape descriptors for features from different domains.
    work in this area, features are modeled as geomet-  Frequently recurring relationships among features across
    ric objects rather than points. We deï¬ne multiple different datasets can guide the domain expert to ï¬nd use-
    distance metrics that take into account objectsâ€™ ex- ful knowledge. Such relationships are especially useful in
    tent. We have developed algorithms to discover    bioinformatics. One important issue in bioinformatics is to
    two types of spatial association patterns in scientiï¬c identify structurally similar proteins. To address this issue,
    data. We present experimental results to demon-   one can ï¬rst discover non-local patterns that frequently oc-
    strate the efï¬cacy of our approach on real datasets cur in proteins known to be structurally similar [Zaki, 2002;
    drawn from the bioinformatic domain. We also      Yang et al., 2004]. Such patterns can then be used to indi-
    highlight the importance of the discovered patterns cate whether a new protein is potentially similar to known
    by integrating the underlying domain knowledge.   proteins. We propose algorithms that discover relationships
                                                      across multiple maps. This is different from previous work
1  Introduction                                       on spatial association mining [Koperski and Han, 1995;
                                                      Shekhar and Huang, 2001; Morimoto, 2001; Zhang et al.,
Advances in simulation and data collection techniques in 2004], where features are located in the same dataset and rep-
different scientiï¬c domains such as bioinformatics, compu- resented as points.
tational ï¬‚uid dynamics, and computational molecular dy- We  deï¬ne Spatial Object Association Patterns (SOAP) to
namics, have resulted in huge amounts of data. It is nec- characterize spatial relationships among object types. Our
essary to develop computational techniques to extract fea- algorithm ï¬nds two different types of SOAPs: Star and Se-
tures from scientiï¬c datasets, for instance, vortices in ï¬‚uid quence (Figure 2). They capture different aspects of neigh-
ï¬‚ow ï¬elds and substructures from molecular datasets. It is borhood relationships among features. For example, in pro-
also very important to subsequently uncover meaningful re- tein contact maps, the formation of Star SOAPs among non-
lationships among extracted features. Such relationships can local patterns indicates such patterns have a compact spatial
provide valuable information towards understanding or ex- relationship. The formation of Sequence SOAPs on the other
plaining the underlying scientiï¬c phenomenon. Many algo- hand indicates an extended spatial relationship among the
rithms [Kramer et al., 2001; Jiang et al., 2003; Yang et al., involved patterns. Furthermore, by extracting SOAPs from
2004] have been proposed to extract features from these sci- contact maps that are associated with proteins in different
entiï¬c datasets. In this paper we focus on the latter problem protein classes, we can establish the associations between dif-
of ï¬nding relationships among features.               ferent types of SOAPs and protein classes. Such associations
  Recently, researchers have started to explore the relation- can help us to identify structural characteristics of different
ships [Morimoto, 2001; Munro et al., 2003; Zhang et al., protein classes.
2004] among features. Most of the previous techniques rep- The rest of this document is organized as follows. In Sec-
resent features by single points. However, this represen- tion 2, we present the key ideas underpinning our work: (i)
tation leads to loss of important information. The shape, the notion of spatial feature representation using extents and
size, and orientation of a feature in scientiï¬c datasets are shapes, (ii) the different object-oriented distance metrics, and
very important. A simple solution to this problem is to use (iii) the different association pattern types used to character-
Minimum  Bounding Boxes (MBB). However, MBBs are not  ize spatial relationships. In Section 3, we detail the algo-
well-suited for every domain. For example, ellipsoids are rithms and efï¬cient realizations of the key ideas. Section 4
  Â¡ This work is funded by NSF grants ITR-NGS ACI-0326386, describes the efï¬cacy of our approach on datasets drawn from
CAREER  IIS-0347662, and SOFTWARE ACI-0234273. All cor- bioinformatics. Finally, we present our conclusions and out-
respondence should be addressed to Srinivasan Parthasarathy at line directions of ongoing and future research in Section 5.
srini@cse.ohio-state.edu.2  Background    and  Deï¬nitions                          (or sides) in each object, then compute the shortest dis-
                                                          tance between these two line segments as the line-line


2.1  Spatial Feature Representation                                       )
                                                                               HÂ¤I
                                                          distance between H and . We identify the top and bot-
We propose two basic shape representation schemes: paral- tom surfaces (or sides) by selecting a reference axis in


lelepiped (or parallelogram in 2-D) and ellipsoid (or ellipse in the underlying Cartesian coordinate space, speciï¬cally,




                                                                                                     )
                                                                                 
                                                                                                    H
2-D). As demonstrated in Section 4, parallelograms are more the K -coordinate in 3D and -coordinate in 2D. If and


appropriate to capture the shape and extent of non-local struc- HÂ¤I are ellipsoids (or ellipses), the line-line distance is be-
tures in protein contact maps as opposed to MBBs. Whereas tween the two major axes.



ellipsoids (or ellipses) are suitable for vortices in ï¬‚uid ï¬‚ow J Boundary-Boundary distance: This is the shortest dis-
                                                                                                     )


data as mentioned earlier. Note that the ï¬rst scheme subsumes                         )


                                                                                           H5I      H
                                                          tance between the boundaries of H and . When and


the MBB representation, and the second scheme subsumes
                                                           I
                                                          H  are represented as ellipses, the boundary-boundary
circles. For highly irregular-shaped features such as defect distance is the shortest pair-wise distance between points
structures in materials, we plan to use sampled boundary  sampled on the boundaries (or surfaces in 3D). The num-
points, known as landmarks [Rao and Suryawanshi, 1996].   ber of sampled points is user-speciï¬ed.
  As shown in Figures 1(a) and 1(b), the shape descrip- Notice that the line-line and boundary-boundary metrics


tors of a parallelogram and an ellipse can be described


                 Â¦ !#"$&% Â '
Â¨(Â¨()*Â¡Â¤+,
-
   Â Â¢Â¡Â¤Â£Â¦Â¥Â§Â£Â§Â¨Â©Â¨
Â¨                              are able to take objectsâ€™ geometric properties into account.


as                                 and                                                           [


Â¦  ".%
         
                                                     The algorithms also support Hausdorff distance Atallah,
              , respectively. These descriptors can also be 1983]. Since this distance is not applicable to the applica-
extended to 3D.                                       tions described in this article, we do not discuss it here.



                   (x,y)                                            )
                                                                          HÂ¤I


                                                        Two  objects H and  have a closeTo relationship if the
                                                                                       M
                l               (x,y)                 distance between them is LBM , where is a user-speciï¬ed
                2 l mid
                              Î¸                       parameter. Two objects are neighbors if they have a clos-
                   Ï†              l2


                    Î¸ x                               eTo relationship. We also deï¬ne the isAbove relationship
                                                                                               )
                           l      (b)                          )


            (a) l          1


                                                                    HÂ¤I                       H


                1                                     between H  and  .  In a coordinate system, is said to
                                                                                    I
    Figure 1: Object type: (a)Parallelogram (b)Ellipse have a isAbove relationship with H , if the upper-left cor-
                                                             )                               1



                                                      ner of H â€™s Minimum Bounding Box (MBB)  , denoted as


                                                         




                                                             )
                                                        )  )
                                                                                       HNI


                                                      (     K ), and the upper left corner of â€™s MBB, denoted as






                                                                                                       
                                                                                             %   OQPR
                                                                                     
                                                                                                      )


2.2  Dataset Representation                                                                 )




                                                                                               K7I   K
                                                           I K7I                           K


                                                      ( I     ), meets the following condition:


                                                        SEPRT)F%U VOW#T)X SEY)FZ #[R[


                        0                   1


The dataset / consists of features located in maps


                                                       I          I          I         I




                                                      K
                       5 !Â¤676Â¤67 Â¥8


   %                                                                                       in a 3-D map, or


                                                      \)F%] ^O@PR\)^_ `SaY)bU C[


                 2  3Â¤4  4      4         0


( 1 1), denoted as =                . The   features


                                                            I          I          I
                                        
                                                                                    in a 2-D map.


are categorized into types, corresponding to unique la-






                   8
             7676Â¤67
          






                  Â¨
           
         




                 :
           :
       35:
bels 9 =            . The categorization of features is 2.4 Spatial Object Association Pattern (SOAP)
                                                                                     c
governed by the underlying domain. A featureâ€™s geometric                ci           i
                                                                             cj
properties such as shape and size are captured by adopting                              c j
                                                                          cm (center)


one of the supported representation schemes. A feature ;                             c k


                                             Â =<
                                                
,>                        c
thus can be described as a vector mapID, location, ,                        k


   %                                                                    c


                                                                    (a)  l      (b)   c l c m
                          ?A2


type , where type ?@9 , mapID indicates the map where
                        ;


; occurs, location identiï¬es â€™s position within the map, and Figure 2: SOAP Types: (a)Star (b)Sequence


 <


Â  
,>   Â BÂ¡Â¤Â£Â¦Â¥Â§Â£Â§Â¨Â©Â¨
CÂ¨,#Â =
Â¨Â©Â¨()Â©Â¡Â¤+,
8


     ?@3                                  ;
                        captures the shape of .         A  Spatial Object Association Pattern (SOAP) of size c ,


  Note that in the rest of the paper, we refer to a feature cor- denoted as c -SOAP, characterizes the closeTo relationships




responding to the above vector as a spatial object. We assume among c object types. In this article, we focus on two types


                                   D   E6Â¤676F


                                  4     4


the following order among the 1 maps:                 of SOAPs: Star and Sequence (Figure 2). As discussed ear-


  Â¥


         1                 1
4  . If the maps correspond to snapshots, they are ordered lier, these two SOAP types can characterize different spatial
temporally. If they are from different datasets (e.g., different relationships among objects. These two SOAP types can be


protein contact maps), the order among them is imposed by abstracted as undirected graphs, where a node corresponds to




                                                                                      )# 
                                                                    )                                   )


                                                                                         I




                                                                                      : :
                                                                     ?X9                               :


arbitrarily assigning each map a unique ID. Furthermore, the an object-type : , and an edge indicates that


                          
                                                           I


lexicographic order among the feature types is imposed as and : are required to have a closeTo relationship.


            G6Â¤676


                   Â¨


                                                        J


           :        :
follows: :            .                                   Star SOAPs   (Figure 2a) have a center object-type,
                                                          which is required to have a closeTo relationship with all


2.3  Object-oriented Distance Metrics                     the other object-types in the same SOAP.
                                                                                                )(f


The proposed algorithms use the following metrics to mea- J


                                                                                          c'd  :!e gÂ§? c


                                )                         Sequence SOAPs  (Figure 2b) of size =( :  [1, ])


                                                                                         )(f
                                     HÂ¤I


sure the distance between two objects H and located in the
                                                                                                   ghi


                                                          satisfy two constraints, where :e is the    el-


                                                                                      
                                                                                        )Rjf


same map.                                                                            )Â©f


                                                                                       :Ne
                                                                                   :e


                                                          ement  in d : (1) closeTo(       )=true and (2)


                                                                    




                                                                      )jkf
                                                                   )(f


  J




                                                                     :Ne
                                                                                        L L
    Point-Point distance: This is simply the Euclidian dis- isAbove( :e  )=true, where 1 i k-1. Sequence


    tance between object centroids.                       SOAPs  are mainly motivated by our observation on pro-
                           )



  J                                                       tein contact maps, where non-local structures, i.e, fea-
                                HÂ¤I
     Line-Line distance: If H and are parallelepipeds
    (or parallelograms), we ï¬rst identify the line segment tures, tend to line up in a Sequence like manner.
    between the midpoints of the top and bottom surfaces 1For a 3D MBB, it is the upper-left corner of its top surface.

                                                                        )


                                                                     d   :


  These two SOAP types can also be represented as lists. Let  minSupp, then =( ) is a frequent 1-SOAP. The set of all


   Â¥                                                                               


                                         )(f


Â¡Â Â£Â¢                     c       d     3N:e g? c                               


:    be the center of a star -SOAP , and  :   [1, -   frequent 1-SOAPs is denoted by .




                                              676Â¤6
  8


  h


                                        Cf


                                       :!e L     L


1] be the other k-1 object-types in d , where           The next step, gen2EquiClass, discovers 2-SOAPs and or-


                                                 Â¥


   f


:Ne Â¤Â¦Â¥     d                              d  :


     . SOAP   can then be described by the list =( Â Â£Â¢ , ganizes them into 2-EquiClasses (line 2). The pseudo-code




                               
   Â¤676767


                              Â¥




 Cf                              )(f
           f


                                                h




:Ne                        :    :Ne      gÂ§?  c
       :Ne Â¤Â¦Â¥
             ), where closeTo( Â Â£Â¢ )=true ( [1, -1]). of gen2EquiClass is described in Figure 4. A 2-EquiClass


Whereas elements in a sequence SOh AP correspond to a list is generated for each frequent 1-SOAP (Figure 4:line 2).


                                                                                )               Â¡


                                                                               : ?            


by deï¬nition and cannot be forced into lexicographical order. The 2-EquiClass of 1-SOAP ( ) , denoted by Â Â£ , con-


                                Â Â¨Â§
Â©    Â Â©Â§ 


                                                                                            


                                                                                           )
                                                                                            Â 



For instance, the two sequence SOAPs    and           tains frequent 2-SOAPs in the form of ( : ). To gener-


                                                           


                                                           Â 


are different.                                        ate     , the procedure considers the following 2-SOAPs


                                                                      )               


                                                                        I          I


                                                                       :          :  ?


  A SOAP  is autocorrelated if an object-type occurs multi- as candidates: ( : ), where ( ) (Figure 4:line 3).


                                                                                


                                                                               )


                         :  :                                                 d   :  :Â§I


ple times. For example, :      is an autocorrelated 3- For each candidate 2-SOAP =(   ), the procedure iden-


                                                                             


                                               d                             d


SOAP, where : occurs twice. An instance of a SOAP is  tiï¬es all the maps where  occurs (Figure 4:lines 6-11).


                                                                       ),                  )# 


                                                                           I                     I


                                                                        : :                  H  H


the set of objects that meet all the requirements speciï¬ed by An instance of d =( ) is an object pair , where


                                                        )6 C ) SB 6 C  S           )C


                                                                    I      I               I


                                                       H   d :   H   d :            H H         L  M


d , including those on object-types and closeTo (or isAbove) ( = )       =  )  (distance(   ,distType)  ).


                                                         
                                                                    


relationships.                                        If d occurs in minSupp maps, then it is frequent and is


                                                               Â¡


                                                                Â 
  We deï¬ne two measures-support and realization- to char- added to  (Figure 4:line 12).


acterize the importance of a SOAP. The support of a SOAP
                                                                                               


                                                       Algorithm mine starSOAP(  ,minSupp, minRealization, distType, )
                                       d


d is the number of maps in the dataset where occurs. As-


                     )
                                                                         


                                                       1.  gen1SOAP(); // 1-SOAPs


                    0                d




sume support(p)=s, let be the number of â€™s instances in     


                                                                           


                                                          !"         
                                           8


                                          )            2.      gen2EquiClass( , star, parList); //parList: parameters


                                                         Â¤


                                                          


               d                  d     3Â¤0
the ghi map where appears, realization( )=min . A pat- 3.  ;




                                                       4. while (1) #


                         d 


tern d is frequent if support( ) minSupp, and prevalent if


                                                           $&% ('


                                                       5.         ; //the set of (k+1)-EquiClasses


                                                               Â¤


         d 


                                                                      Â¡


                                                                        $*)  $
                                                                           "


realization( ) minRealization, where minSupp and minRe- 6. foreach -EquiClass 


                                                                 Â¤


                                                                        


                                                                                    Â¡


                                                                         )
                                                                       $,+


alization are user-speciï¬ed parameters.                7.   foreach -SOAP  -$


                                                                                      


                                                                        Â¡         )87




                                                             -$&% ('        -$.%
                                                                                     $,+
                                                                                  


                                                       8.           ; // the preï¬x of is


                                                                  Â¤


                                                                                     I


                                                               Â¡          Â¡          Â¡


                                                                         $/+ 01) $/24365 2


                                                       9.    foreach -SOAP ( 


                                                                            


                                                                                   Â¡    Â¡


                                                                $.%       $/+       $/+ 0


3  Algorithms                                          10.          append( , lastElement( ) );


                                                                         =< 


                                                                                     




                                                               96:   
#&; ;
                                                                                         $/+ 0?>


                                                       11.                    contains $/+ and ;
                                                                 $.%


3.1  Data Organization                                             


                                                                     


                                                                      )


                                                                    ;   96:


                                                                                 Â¡ Â¡


                                                       12.     foreach          


                                                                          $.%


                                                                            


                                                                                 


                                                                           )  Â¡Â§Â¡             Â¡


                                                                                    0


                                                                              ;      @
                                       0


We organize / in the following manner. The objects are 13.      if ( countStarInstances( ) 1) mapCnt++;


               


                                                                           Â¢CBCD


                                                                        @A;      -$.% E-$.% # $.% >


                                                                                           8F   
                                                       14.      if ( mapCnt      )                ;




ï¬rst grouped into partitions, where each partition is com-        H




                                                             5
                                                                     2




                                                              -$.%
                                                                    '  $&% E"I$.% -$.%




                                                                 1G
                                                                                  8F   


                                                       15.  if                          ;


                                                                       J              $&%


posed of objects of the same type. Within each partition, ob- 16. if (minRealization 1) markPrevFreqSOAPs(  );


                                                                  H


                                                             "I$.%
                                                                    '
jects are ordered by their map IDs and locations in a map. 17. if (  ) return; //terminate
This data organization is analogous to the format used for 18. k++; //increase SOAP size > //while(1)
association rule mining [Zaki et al., 1997]. Note that each        Figure 3: Mining Star SOAPs

object can be uniquely identiï¬ed by combining the following                                    %
                                                        The algorithm next discovers SOAPs of size 2 (Figure


information: mapID, label, and locationID in the map.
                                                                                           c
                                                      3:lines 4-17 ). Two c -SOAPs in the same -EquiClass are




3.2  Equivalence Classes                              combined to construct a candidate ( c +1)-SOAP. For each


                                                                            j


                                                                           Â¤
                                                                          d


                                                      candidate ( c +1)-SOAP   derived by appending the last


                                                                          )


Based on the list-based SOAP representation (Section 2.4),        


                                                                 Â¤      Â¤


                                                                   I
                                                                       d


                                                      element of d  to     (Figure 3: line 10), the algorithm
                                                 c


we  organize SOAPs  into equivalence classes. A   -                                j
                                                                                  Â¤
                                                      identiï¬es all the maps where d  occurs (Figure 3:lines
equivalence class, denoted as c -EquiClass, is deï¬ned as the



                                                      11-14). (The gChi k-SOAP in a k-EquiClass is denoted as


     c




                                                                                               
                                                                                           






                                                                                                  
                                                                                               )
                                                         )                                )


set of -SOAPs that (i) are of the same SOAP type, and (ii) 






                                                                                                 Â¤
                                                                                             Â¤
                                                       Â¤




                                                                                                d I
                                                                                            d
                                                                                         4


                                                      d  .) The procedure countStarInstances(      ) (Fig-


                                   c
                                                                                                     )


have the same preï¬x, where the preï¬x of a -SOAP is its ï¬rst                               j


                                                                                         Â¤
                                                                                                    4


                                                      ure 3:line 13) computes the instances of d in map by


                                                                            )                           )


k-1 elements. By using equivalence classes, our mining algo-                


                                                                           Â¤      Â¤                    Â¤


                                                                                   I


                                                                                 d                   d


                                                      combining instances of d and  . Two instances from
                                                                                  j


rithms only need to compute the closeTo or isAbove relation- 


                                                           Â¤                      Â¤


                                                            I
                                                                                d
ships between objects once. The equivalence classes also help and d are joined to produce a instance if they have the

to improve the memory locality of the algorithms, which re- same ï¬rst c -1 objects and different last object. SOAPs with
sult in signiï¬cant performance gains. Moreover, equivalence the same preï¬x are organized into one equivalence class as
classes also enable the algorithms to smoothly scale to large they are being generated (see Figure 3:lines 5, 8, 14, 15). The
datasets [Zaki et al., 1997].                         mining process stops when all the frequent SOAPs have been
  The next two sections describe the algorithms that discover discovered (Figure 3:line 17).
Star and Sequence SOAPs. For each frequent SOAP, the al- To discover frequent SOAPs, the algorithm only needs to
gorithms store information about all of its instances. Such consider a SOAPâ€™s presence in a map (Figure 3:line 13).
                                                      Hence, some of the discovered frequent SOAPs may not be

information allows the algorithms to locate every object in-                 %
volved in an instance.                                prevalent if minRealization 1. In this case, the procedure
                                                      markPrevFreqSOAPs is called to identify the SOAPs that are
3.3  Mining Star SOAPs                                both prevalent and frequent (Figure 3:line 16). It is necessary


Figure 3 outlines the algorithm that discovers star SOAPs. to keep SOAPs that are frequent but not prevalent. We ex-


                                                                                        ?L ?L 8


                                                                                          
                                                                                     Â¦K


The ï¬rst step generates frequent 1-SOAPs (line 1). For each plain this by a simple example. Let 3 be the three
          )




object-type : , the procedure gen1SOAP counts the number of neighboring objects in a map and minRealization=2. To de-


                                       )                                           ?L  N,L7   N,LÂ¦Â¤


                                                                                  K     K          K
maps that contain at least one object of type : . If the count rive the two instances of SOAP ( ), and  ,

                     +,>#Â£Â¡Â¡Â Â£Â¢Â¡Â¤



                                4
                                                                                                  


 Algorithm gen2EquiClass (    ,parList ) // :freq. 1-SOAPs Algorithm mine sequenceSOAP(  ,minSupp, minRealization, distType, )


  " ('


     !


                                                             >Â¥              


 1.      ; //the set of 2-EquiClasses                  1.  gen1SOAP();


       Â Â£


         )  


           


                                                            


                                                            5   2


                                                                          
                                                                !


 2.foreach ( )                                         2.  !       gen2EquiClass( , Sequence, parList);//parList:parameters


                            Â Â£


                                                         Â¤


      + Â¤




        ('
    I!
       


 3.         //2-EquiClass with preï¬x of ;              3.   ;


         Â 


     Â¡     


          0 )


            4
                                                                                 j


 4. foreach ( )                                        4. while (1) #


          Â Â£ Â 


                                                                                Â¤


             0


      !"


                                                                   Â¡          


                                                                               5   2


                                                           4$.% ('


 5.      (   ); //a candidate                          5.        ; //initialize the set of -SOAPs;


                                                                       H


                        Â    Â 




             =<        
                 




                                                                          Â 
                                                                                Â 




                                                                             Â¥Â¥Â¥
                                                                                 


                                                                      




                             0
               5




     96: 
#&;                >
                ;


                                                                                      Â¡7Â¥Â§
5)


                                                                                      )




                                                                    $,+
                                                                                     J  4$




                                                                            
                                                                                 $ 
                                                                                   


 6.    !          contains and ) ;                     6.  foreach SOAP


                                                                                           H


           






                                                                                             Â 
            > >
                       > Â¨RÂ£Â¡Â§
Â¨ > Â¨Â£Â¨Â§ 
CÂ¨


                                                                                     Â¥


            )




          ;
              96:


                                                              + Â¤    + Â¤ )   243 5 + Â¤         2


                                                                E          


                                                             !       !      !     !


                                                                                              $




                                                                                 
 7.  foreach    !




                                                       7.             Â¡                         ;


                                                               $     $          $


                             H           H


                              Â             Â 




             
                    =< Â¦Â¥         Â¥


                                >  >




           5   0 2)                       0.2
                      5         2C3 5 0


 8.   foreach     ;


                                                                       + 0) + Â¤


                                                                          


                                                                       !   !


                                                                             


                                                                         Â¡          Â¡


                                                       8.   foreachÂ¡ 2-SOAP


                                                                             $


                                


               >  >     7          Â¡  >  >


                       3       5   0.2 2


 9.     if ( (soapType=Sequence) ( Â© isAbove ) continue;


                                                                           


                                                                                     Â¡     Â¡


                                                                                      + 0


                                                               $.%       $,+        !


                                                       9.          append( , lastElement( ) );


                                       


             Â¡ 


                  0                   5   0.2
                           


 10.     if distance( , distType) ) addInstance( ! );


                                                                         =< 


                                                                                        


                                                                                             + 0




                                                               96:                    $,+     >
                                                                    
#&;  ;


                                                       10.                   contains both and ! ;


                                                                 $.%


                                                                   


                 


                                 Â¡


                  2


               ;   @


 11.  if ( cntInst( ! 1) mapCnt++;


                                                                    


                                                                     )




                                                                  ;
                                                                       9 :


                                                                                Â¡  Â¡


                                                       11.    foreach          


                                                                         $&%


                                                                           




                             + Â¤
                      + Â¤






                                #  >
                        E
            @       






                               F  !
                            !
                     !
                              


 12. if ( mapCnt minSupp )         ;


         H


                                                                              


                                                                                 


                                                                                         Â¡


                                                                                     + 0


                                                                                $/+   2


                                                                            ;       !  @


       + Â¤                + Â¤




           '
     I!     "!"E"! I!




         G
                       F
                           


 13.if (   )               ;                          12.     if ( countSeqInstances(  1) mapCnt++;


                                                                     @       4$.% E4$.% # $.% >


                                                                                      =F   


                                                       13.    if ( mapCnt minSupp )          ;


                                                                 H


                                                            C$&% '


           Figure 4: 2-EquiClass Generation            14. if (    ) return; //terminate the process;


                                                                     J               4$&%
                                                       15. if (minRealization 1) markPrevFreqSOAPs(  );


                                                       16. k++; //increase SOAP size > //while(1)




the 1-SOAP ( K ) must be maintained even though its realiza-
        

                                                                Figure 5: Mining Sequence SOAPs
tion is 1 ( ) in the map.
Correctness: It is straightforward to show that the algorithm
discovers all the frequent 1-SOAPs and 2-SOAPs. Thus to Other SOAP  types can also be deï¬ned. For instance, we
prove the algorithm is correct, we only need to show that can deï¬ne Clique SOAPs, which require every pair of objects


                      %                               in the same SOAP have a closeTo relationship. We can also
                     c


every frequent c -SOAP ( 2) will be considered as a can-






                     7676Â¤67
                              
                                    




                   f
                             f
                                   Cf


                                       f              deï¬ne SOAPs that involve other types of spatial relations such


               Â¤






              d   :Ne
                         :Ne Â¤Â¦Â¥
                               :Ne Â¤Â¦Â¥
                                      Â¤


didate. Assume  =(                   :Ne ) is frequent,


                                  Â¤676Â¤67 


                           / )


                                          f   Cf


                                 Cf                  as topological relations.


                         Â¤Â¦Â¥




                       d       :e
                                        Â¤ Â¥  :Ne Â¤Â¦Â¥


then the two (k-1)-SOAPs     = (       :e        )


       ,    Â¤676Â¤6  


             Cf      ,f  f


    Â¤Â¦Â¥


        I


           :Ne     :Ne Â¤Â¦Â¥ :e Â¤
and d    = (               ) must also be frequent and 4  Experimental   Evaluation
in the same equivalence class. Thus the algorithm will con-


                                                      In this section, we evaluate the algorithms on a protein contact
     Â¤
sider d as a candidate. It is trivial to show that the procedure
countStarInstances identiï¬es all the instances of a candidate map dataset. We start with a brief description on the dataset
                                                      generation process and the domain-speciï¬c usefulness mea-
SOAP. 
                                                      surement adopted in this work. We then present results to
3.4  Mining Sequence  SOAPs                           analyze the impact from different distance metrics and SOAP
                                                      types. Finally, we present performance characterization of
The pseudo-code is given in Figure 5. Unlike mining Star
                                                      the algorithms.


SOAPs, which uses two k-SOAPs in the same equivalence
                                     -


class to generate a candidate (k+1)-SOAP ( c 2), the algo- 4.1 Data Preprocessing and Representation


                                                                                     


rithm joins one c -SOAP and one 2-SOAP.
                                                      We ï¬rst generate contact maps for  proteins taken from
  The ï¬rst two steps (lines 1-2) discover all the frequent 1- the Protein Data Bank [Berman et al., 2000]. For a protein


SOAPs and 2-SOAPs.  The isAbove relationship is checked                             Â©


                                                                                          !#"$!
                        


                       )                              with N amino acids, its contact map is a  binary ma-


                                                                      Â©  &%
                         HÂ¤I


by the procedure isAbove( H ) (Figure 4:line 9). For each


                                                                        g


              76Â¤676Â¤
                     f


             Cf                                      trix. The position ( ) is set to 1 if the distance between


                                                                %


         Â¤


       d   :Ne     :Ne Â¤


c -SOAP   =(          ), the algorithm ï¬rst locates the 2-




                                                                 hi
                                                         ghi
           Â¡


                                                     the    and    residues is less than a threshold and 0 oth-


           Â 
             


EquiClass    $ , in which every 2-SOAP is in the form                                             Ëš




                      S
                                


      f          f   f            f  f


   f                                                  erwise [Vendruscolo and Domany, 1997]. We use 6A as the


 :Ne Â¤ :Ne     :e Â¤ :Ne       :e Â¤ :e


                    I               I
(     I ):closeTo(    ) isAbove(      ) (line 7). A set threshold as suggested in the literature [Zaki, 2002]. We then


of candidate (k+1)-SOAPs are then generated by combining
                       


                                                     extract features in contact maps. A contact map feature is


 Â¤


d                       Â 
                          
   with each 2-SOAP in    $ (lines 8-9). Same as min-



                                      j             composed of a set of positions, where each position and at
                                     Â¤
ing Star SOAPs, a candidate (k+1)-SOAP d is frequent  least one of its eight neighbors contain a â€™1â€™ (see Figure 6 for



if it appears in  minSupp maps (lines 10-13). The proce-




                           
                       




                             
                           )


                      )                               examples). We apply a simple region growing approach to


                         Â¤


                            d I
                        d


dure countSeqInstances( 4      ) (line 12) identiï¬es in-


                     )         j


           j                                        extract features in contact maps [Yang et al., 2004]. We then


          Â¤                   Â¤


                   4         d


stances of d in map   , where    is a candidate SOAP




           )                     )              )
                                     Â¡


                                                     use an entropy-based clustering algorithm to cluster features


                                                          


         Â¤                      Â¤               Â¤


                 I                       I


               d                             d


based on d and    . Two instances  and    , from
    Â¡


                                                     into groups (or classes) [Cheng et al., 1999]. Features in
      I


and d  respectively, are combined to produce an instance of


                         )


  j                                                 a class have similar geometric properties such as shape and


 Â¤                     Â¤
                      


d    if the last object in is the same as the ï¬rst object
   Â¡


                                                     extent.


                                                                  )(*(*+V*,*,                    -.

    I


in  . For the same reason explained before, the algorithm
                                                                                                    
                                                        A total of '      features are extracted from the


calls the procedure markPrevFreqSOAPs to label SOAPs be-                                        

                                                                                                 
                                        %             contact maps. These features are clustered into classes.
ing both prevalent and frequent if minRealization 1 (line 15).                                         ,
                                                      The average number of features in each map is about '.' .
The algorithm stops when no more SOAPs can be discovered Many of these features correspond to well-known protein sec-
(line 14).                                            ondary structures and are also validated by domain experts.


Correctness:  For  each  frequent sequence k-SOAP






                    
                
       7676Â¤6 


                   f
               Cf


     f                                              We represent each feature by its minimum bounding parallel-


 Â¤




                 :Ne Â¤
           :e Â¤ Â¥
    :Ne


d =(                 ,  the  following two  SOAPs


                                  7676Â¤67
                                           Cf


                                  f                 ogram and label the parallelogram by the featureâ€™s class ID.


                           Â¤ Â¥


                                        :Ne Â¤Â¦Â¥
                                :Ne


must  also be  frequent:  d   =(             ) and


         


 


       Cf  f


                       Â¤




          :Ne Â¤
    :Ne Â¤Â¦Â¥           d
d =(        ).  Thus,    will be considered as a can- 4.2  Domain  Speciï¬c Usefulness Measurement
didate and be discovered. It is trivial to show that the The structure of a protein often provides information about
procedure countSeqInstances identiï¬es all the instances of a its functionality. Thus, one can predict a proteinâ€™s function


candidate SOAP.                                      based on the function of other structurally similar proteins.Frequent                        SOAPs                     in      contact                   maps               characterize                              proteinsâ€™                      struc-                            4.3                 Impact                        of        Distance                            Metrics
 ture.               They                can           be         used              to        generate                       signatures                           for         different                                   Due                to         lack               of          space,                    we             only                report                   the            results                    pro-




 proteins.                       For            instance,                       the         SOAP                    (7       7      7      22),            which                  is      auto-                           duced                  from               the          following                          parameter                           setting:                     minSupp=                           '   %,


                                                                                                                                                                                                                                                                                                                ,*,
                                                                                                                                                                                                                                                                                                       M
 matically                        discovered                            by         our           algorithms                            as       both             Star             and           Se-                       minRealization=                                         '  ,   and               =            A.Ëš
 quence,                    can          be        used             to      identify                    the         following                         structurally                            and                                 Figure                  7     shows                  the         impact                   of       the         three              distance                     metrics                    on

 functionally                              similar                    Â     -proteins:                           1h3t,                1h3u                and            1h3v                (IDs                          different                      SOAP                    types.                   One              can            observe                     that            the          Line-Line
 from              PDB).                   (See             Figures                     6(a)            and           6(b)             for         an        illustration                           of                    (L-L)               distance                      generates                        the         most              number                      of       SOAPs                     for         both
 these              SOAPs.)                                                                                                                                                                                               SOAP                   types,               whereas                      the         Point-Point                             (P-P)              distance                     the         least.
                                                                                                                                                                                                                          This              is       expected                        as         the          P-P            distance                       does              not           consider                       the

                                                                                                          ........1....7.........................
       ..........22..                                                                                     ......11....................................
       .................1.                                                                                .....11......................................
                                                                                                          ....11........................................                                                                  shape                 and            size            of       spatial                  objects,                     in       contrast                     with              the          other
       ................111.                                                                               ...11..........................................
                                                                                                          ..11............................................
       ................1....                                                                              .11..............................................
       ...............11.....                                                                             .1................................................
                                                                                                          11.................................................
       ..............11.....1.                                                                            ....................................................
       .............11.........                                                                           .....................................................                                                           two.               One             may              argue                that            more               SOAPs                      can           be         identiï¬ed                         by
                                                                                                          ......................................................
       ............11...........                                                                          .......................................................
       ..........111.............                                                                         ........................................................
                                                                                                          .........................................................
       .........111...............                                                                        ..........................................................
       .........1..................                                                                       .....................7..................................
                                                                                                          .......................1....................................                                                    increasing                          the          distance                     threshold                         in      the          case            of        P-P           distance.
       ...7.........................                                                                      ......................11.....................................
       .....111......................                                                                     .....................11.......................................
                                                                                                          ....................11.........................................
       ....111........................                                                                    ....................1...........................................
                                                                                                          ..................11.............................................
       ...11...........................                                                                   .................11...............................................
                                                                                                          ................11.................................................                                             However,                          it      is      very             difï¬cult                     to       ï¬nd            an         appropriate                             threshold
       ..11.............................
                                                                                                          ................1...................................................
       .11...............................                                                                 .....................................................................
       .1.................................                                                                ......................................................................
                                                                                                          .......................................................................
       11..................................                                                               ........................................................................
       .....................................                                                              ..............................................................7......                                           value,                as        the         size            of       a     feature,                    i.e.,          the         number                      of       bit-         '     posi-
                                                                                                          ..................................................................11......

       ......................................                                                             .................................................................11........                                                                                                                                        

       .......................................                                                            ................................................................11..........
                                                                                                          ...............................................................11............
       ........................................                                                           ..............................................................11..............
       .........................................                                                          .............................................................11................
                                                                                                          ...........................................................1.1..................                                tions,              varies                drastically,                          from                    up         to      several                   thousand.
       ..........................................                                                         ...........................................................1.....................
                                                                                                          ..................................................................................
       ...........................................                                                        ...................................................................................
       ............................................                                                       ....................................................................................
                                                                                                          .....................................................................................
       .............7..Center.................                                                            ......................................................................................
                                                                                                          .......................................................................................
       ................11............................                                                     ........................................................................................                                                400
       ...............11..............................                                                    .........................................................................................
                                                                                                          ..........................................................................................
       ..............11................................                                                   ...........................................................................................
       .............11..................................                                                  ............................................................................................
                                                                                                          .............................................................................................
       ............11...................................                                                  ..............................................................................................
       ...........11.....................................                                                 ...............................................................................................                                                                                                 313
                                                                                                          ................................................................................................
       ...........1.......................................                                                .................................................................................................
                                                                                                          .................................................................................................
       ...................................................                                                .................................................................................................                                       300
       ...................................................                                                .................................................................................................
                                                                                                          .................................................................................................
       ...................................................                                                .................................................................................................                                                                                257
       ...............................................7..                                                 .................................................................................................


                                                                                                          .................................................................................................                                    )

       .................................................11.                                               .................................................................................................                                     
                                                                                                                                                                                                                                               0

       ................................................11..                                               .......................................................................................22..                                          .
                                                                                                          ...............................................................................................1                                                                                                                                                                                                 P-P
                                                                                                                                                                                                                                               2

       ...............................................11...                                               ...............................................................................................11                                     

       ...............................................1....                                               .............................................................................................11..                                    <  200                                                                                                                                                      B-B
                                                                                                          ............................................................................................11...                                     
                                                                                                          ...........................................................................................11....

       .............................................11.....                                                                                                                                                                                    H
                                                                                                          ..........................................................................................11.....                                                                                                                                                                                                L-L
       ............................................11......                                               .........................................................................................11......                                    (
       ............................................1.......                                               .........................................................................................1.......                                    #
                                                                                                          .......................................................................................111.......                                                                 132
       ...........................................11.......                                               ......................................................................................11.........
                                                                                                                                                                                                                                                  100
                                                                                                                                                                                                                                                                                                                                                                72            77
                                              (a)                                                                                                 (b)                                                                                                                                                                                            52

                                                                                                                                                                                                                                                       0
Figure                  6:        SOAP                   (7       7      7     22)           in      proteins                     1h3u,                1h3t             &1h3v                     as:                                                                                      Star                                                        Sequence
 (a)        Star           and           (b)         Sequence
                                                                                                                                                                                                                                            Figure                  7:       Distance                       metric                 vs        #SOAPS                         discovered
         However,                          a     SOAP                    is      unlikely                     to       add            any           value                to       the         sig-
                                                                                                                                                                                                                                  The             advantage                          of        using               L-L             and           B-B             distance                      metrics                    be-
nature,                   if     it     is      randomly                          associated                           with             proteins                     of       different
                                                                                                                                                                                                                          comes                   more                signiï¬cant                            when                looking                      at       the          SOAPsâ€™                        domi-
classes.                    To        prune                away               such            SOAPs,                      we          use         an        entropy-based
                                                                                                                                                                                                                          nating                 protein                   classes.                     Tables                  1-3           summarize                              the          number                     of
 approach.                           For           a     given                SOAP,                   we           ï¬rst           identify                    its        associated
                                                                                                                                                                                                                          SOAPs                     in       major                 protein                   classes.                    One             can           see          that,            if     the         P-P
proteins.                       We          then            compute                       the         SOAPâ€™s                      entropy                    by        integrating                                                                                                                                                    

                                                                                                                                                                                                                          distance                      is      used             (Table                  1),        only                   '    SOAPs                      are          discovered                            in


the          proteinsâ€™                       lineage                   information                              from              the          database                      of       Struc-                                                                                                                         .
                                                                                                                                                                                                                                                                                                                                                                    Â 
                                                                                                                                                                                                                          small                proteins                     as        against                    '              SOAPs                     in             -proteins.                          On           the
tural              Classiï¬cation                                   of        Proteins                      (SCOP)2.                          A        proteinâ€™s                       SCOP
                                                                                                                                                                                                                          other              hand,               SOAPs                      based               on         L-L            or       B-B            distance                      show               a     rel-


lineage                     is      organized                           into            6       hierarchical                              levels                according                           to
                                                                                                                                                                           


                                                                                                                                                                                                                         atively                  more               balanced                        behavior(Tables                                        2-3).               Compared                            with


                                                                                                                                                                        :     KÂ£Â¢Â¤Â¢


its        structure.                          We           look              at       the          ï¬rst           two            levels:                   Â¡        :                    ,    and


                     Â¦Â¥


                                          


                                                                                                                                                                                                                          P-P           distance,                       much                 more               SOAPs                      in       Â     -proteins                       or       small                pro-


            ;    H                   Â¡                                                                                                                        Â§                                    Â 
 Â¡        :                 .                     consists                      of        11          classes                   such               as              -protein,                            -


                                                                                                                                                                                                                         teins             are         discovered.                              For          instance,                       in      the          L-L            case            (Table                   2),


                                                                                                                                                                                                                                                                 (                    
-(.



protein,                     and            small                protein.                       Â¡           further                   divides                   proteins                      into


                                                                                                                                                                                                                                                                                                                                                                                   Â 
                                                                                                                                                                                                                          there              are         '             and                          SOAPs                     are         identiï¬ed                        in            -proteins                      and

 sub-classes                             based                on         proteinsâ€™                       folding                    structures.                            Let           !         be
                                                                                                                                                                                                                          small                proteins                     respectively.                                Also              the          B-B              distance                     produces


the         number                     of       proteins                    whose                  contact                   maps               contain                   the         SOAP


                             )


                                                                                                                                                                                                                                                                                                                                                 Â§


                                                                                                                                                                                                                          the         most              number                      (  '       )    of       SOAPs                     for              -proteins                       (Table                 3).


                       0                                                                                                                                               !
d    ,   and                     be         the         number                      of       proteins                     among                    these                        proteins


                                                                                                                                                                                                                                  The              differences                             exhibited                         by          SOAPs                      from                different                       dis-


                                                                                     
                                                                                                    d


in       the         ghi      class,              the         entropy                     of            at      the         ï¬rst           SCOP                  level             is      then


                                                             b
Â©                                             )                                !         )           


                                                                                             


                                                                                     )                                                                                                                                    tance               metrics                    show                that           it     is      important                          for         our           algorithms                            to


                                               Â¨         d                                                  0          !            "         HÂ¤            0          !


 computed                          as:                                                  H                                                                                            [Shan-
                                                          


                                                                                                                                                                                                                         support                     multiple                       distance                      metrics,                     especially                           metrics                    which


                                                     d                                                                                                                 d
non,              2001].                   Â¨                   essentially                           measures                         how              well                 â€™s      associ-                               consider                      objectsâ€™                     extent.


ated             proteins                     distribute                        among                     different                      proteins                     classes.                      In


                                                                                                                                                                                                                                                                                                                         
 our          experiments,                                 we         observe                     that           SOAPs                     with             entropy                     L       2.0                                                             Type                            #(       )           #(       )           #(small)                     #(peptide)
show                 good                quality                   and            can            be         used              to        generate                       signatures.                                                                              Star                                2                  103                       19                              7
                                                                                                                                                                                                                                                                Sequence                            4                   30                       12                              4
This             observation                              is      also           validated                       by         domain                     experts.                                                                                                 Total                               6                  133                       31                             11

         For           each              SOAP                    with             entropy                      L       2.0,            we          next             identify                     the                              Table               1:       #SOAPs                        in       major                protein                   groups,                    distType=P-P
 protein                   class              that           dominates                           its        associated                           proteins.                        For           ex-


ample,                   the          dominating                              protein                   class             of       the          clique                SOAP                   (5        7




                                                                                                                            
        ,
                                                                                +
                                                                                                                                                                                                                                                                                                                          


                                                                                                                                                                                                                                                                Type                            #(      )           #(       )           #(small)                     #(peptide)




                                                                                                                                 '
                                                                            '        '
7      22)           is      Â     -protein,                       as                       out          of        its                      associated                           proteins
                                                                                                                                                                                                                                                                Star                                1                  133                      167                             12

 are          Â    -proteins.                           As          suggested                          by         domain                      experts,                     we          would                                                                     Sequence                            4                   37                       36                              6
 like          to       have             many                 SOAPs                     for         a     certain                  protein                   class.               A       large                                                                 Total                               5                  170                     203                              18
number                       of       SOAPs                      not           only             cover                a      wide               range                of        proteins,                                          Table               2:        #SOAPs                        in      major                 protein                  groups,                    distType=L-L
but           can           also            be        used              to       identify                     structurally                            similar                   proteins
 from              different                      aspects.                      This             criterion                      is      used              to       evaluate                      the
 discovered                            SOAPs.                          Note               that           even               if      two            SOAPs                      have               the                      4.4                 Impact                        of        SOAP                      Types


                                                                                                                                                                                                                          As            we             move                   down                   to          the            second                      SCOP                      lineage                     level,


                                                                                                                                                                                                                                               Â¦Â¥


 same               dominating                               protein                   class,              their             associated                           proteins                     can                              


                                                                                                                                                                                                                                      ;    H
 be       very             different.                                                                                                                                                                                     Â¡        :                  ,   we           discover                      that           different                      types                of       SOAPs                      can           ac-
                                                                                                                                                                                                                          tually                distinguish                             different                       protein                   folding                     structures.                             Pro-
           2

              http://scop.mrc-lmb.cam.ac.uk/scop/                                                                                                                                                                         teins             in       the          same               class              (e.g.,             Â     -protein)                       are         further                  classiï¬ed