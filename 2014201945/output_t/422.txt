                        dynamics temporal difference learning                                             andreas wendemuth                        ottovonguerickeuniversity  magdeburg germany                                         cognitive systems group                             andreaswendemuthetechnikunimagdeburgde      abstract                                              smart  adopt following notation course                                                        paper following dayan abbott   behavioural sciences problem sequence stim                                                          â€¢  uli followed sequence rewards rt considered stimulus ut  subject learn sequence rewards â€¢ future reward rt  stimuli prediction modelled suttonbarto â€¢ sum future rewards rt  rule sequence trials prediction rule learned â€¢  eratively temporal difference learning present closed weights wk  formula prediction rewards trial time trial â€¢ predicted reward vt  formula show directly â†’âˆthe want compute trials duration andfor  predictions converge real rewards approach time trial predicted reward vnt ex  new quality correlation type toeplitz matrices proven tended stimulus ut given times tumin tumax  learning rates optimally speed learning extended reward rt presented times trmin trmax  process                                              stimulus reward overlap trmin tumax                                                          subject learn total remaining reward time                                                                tâˆ’t    temporal difference learning                       rt       rt  Ï„ stimulus onset  consider mathematical treatment problem     Ï„                                                          brackets  refer general stochastic values  behavioural biology problem described                                                        rt exactly rewards given each trial  dayan abbott  learning predict reward                                                        ï¬‚uctuations  pavlovian sense classical conditioning adressed                                                          previous stimuli ut weighted linear pre  reward immediate series stimuli                                                        diction model sutton barto   latency time followed series rewards                                                                              t  ing simple linear rule show subject able                                                                                        âˆ’                 predict remaining rewards rule repeating         vt     wÏ„ut  Ï„                                                                              Ï„  stimulireward pattern series trials review  learning theory related problems update rule suttonbartoformula easily                                                        rived mean square error dayan abbott   sutton barto                                                                                                                                                       tâˆ’t         t                  recent experimental biological correlates            mathematical model activity primate rt âˆ’ vt      rt  Ï„ âˆ’   wÏ„utâˆ’Ï„  dopamine cells during appetitive conditioning tasks            Ï„          Ï„  psychological pharmacological rationale                                                studying cells review given schultz  using partial derivative respect weight wÎ±                                                                             connection temporal difference learning âˆ‚rt âˆ’ vt  montague et al                                                                   âˆ‚wÎ±    paper focus mathematical issues                                                                                                   âˆ’t           provide direct constructive proof convergence giving                                                                                   âˆ’              âˆ’            âˆ’        âˆ’  explicit dependence prediction error trials   rt  Ï„     wÏ„ut  Ï„  ut  Î±  minimize learning time giving formula optimal         Ï„          Ï„  setting learning rate paper contributes updates discrete steps direction neg  temporal difference learning purely mathematical ative gradient providing following rule  issue valuable reference Î”wÏ„ÎµÎ´tut   âˆ’ Ï„                                                                                                          havioural biology reinforcement learning          tâˆ’t  understood dynamic programming sense watkins    Î´t         rt  Ï„  âˆ’ vtrtâˆ’vt   later work gordon  szepesvari          Ï„                                                    ijcai                                                                obviously total future reward rt known written matrix notation follows              subject time use rtrtrt inthis unit matrix              formulation rt known subject      â›              â                                                                                tumax              approximate value prediction vt    âœ              âŸ                                                                           âœ    tumax  âŸ              provide socalled                                        âœ                 âŸ                temporal difference rule time                        âœ                 âŸ   âˆ’ Îµga  Ã—                                                                           â                 â                                      âˆ’      âˆ€                     Î”   Ï„ÎµÎ´t      Ï„    Ï„                                                                   âˆ’                                trmax                        Î´trtvt         vt                     â›                â       â›           â                                                                                                                     updates sequentially each time step     tumax                                                                             âœ              âŸ       âœ          âŸ              parallel sampling weight updates times âœ  tumax  âŸ       âœ          âŸ                                                                             âœ               âŸ       âœ           âŸ              given trial updating end trial Ã— âœ            âŸ   Îµg âœ  rtrmin âŸ                                                                             â               â        âœ           âŸ              alternatives substantially differ ï¬nal result                       â          â                                                                                                                      trials computational reasons use parallel       trmax              version update rule learning schedules                                rtrmax              adopted use eq  widely accepted shall use total time  trmaxâˆ’tumax              community following dayan abbott let              denote trial number superscripts                      tumaxâˆ’y                                                                          gy         uk uy   âˆ€                  dynamics temporal difference learning                        ktumin                parallel temporal difference rule eq  obtained real values uk utumax  andt Ã—               using approximation gradient descent matrices              vergence guaranteed shall proven course                                                                                 â›            Â·Â·Â·           â              paper compact notation introduced                    gk                                                                                 âœ                          âŸ              proceed follows                                             âœ                 Â·Â·Â·     âŸ                                                                                 âœ               gk âŸ                â€¢ incorporate rule prediction formula yielding     âœ                      âŸ                                                                            âœ                      âŸ                   recursive formula predictions trial      âœ                      âŸ                                                                                 â gk     Â·Â·Â·       â                 â€¢ make closed formula vnt                                                                                                        â€¢                    â†’                                                 gk Â·Â·Â·                       show convergence  rt large                      â›                      â                                                                                       âˆ’                â€¢ choose optimal learning rate Îµ maximally fast                                                                                                  âœ         âˆ’            âŸ                  convergence                                                   âœ                    âŸ                                                                             âœ                    âŸ              obtain predictions trial fol       âœ                  âŸ                                                                                            â                      â               lowing recursive formula summation limits explicitely state                         âˆ’              situations stimuli reward phases overlap                                          restrict nonoverlapping cases later                                 minttumax               â€â€ing  refers remaining upper                 âˆ’ tâ‰¥tumin        Î”w   âˆ’ kuk                     Îµ                                Îµ             lower triangle respectively entries                                       ktumin                     diagonals  write compact                 minttumax mintrmaxâˆ’tktumax                                                                  notation vectors component index                          uk                   Î´  âˆ’ kux                                                                                                                 ktumin          xtumin                                      âˆ’  Îµga    Îµgr                 mintrmaxâˆ’ttumaxâˆ’tumin                                                                             Î´  gt                                yt   âˆ’mintt                         umin     umax                                                 n                                                                          vn         âˆ’  ga   gr              Î´ntrtvnt  âˆ’  vnt                                Îµ       Îµ                                                                                                                  minminttumaxtumaxâˆ’y                                 âˆ’                                                                                             ÎµÎµga   âˆ’ âˆ’ Îµga       gr                 gt                      ukuy                                                                                                                                   âˆ’        âˆ’                                      kmaxtumintuminâˆ’y                                 âˆ’    âˆ’ Îµga                        interested subject make proper âˆ’ga hurwitz stability matrix eigenval              predictions stimuli given restrict ues negative real suitable Îµ chosen              analysis times ttumaxthengt                                                                                  âˆ’ Îµga       vanish large similar              independent tgiving                                                                    approach relying hurwitz matrices followed                               mintumaxtumaxâˆ’y                sutton  hurwitz property               gygt                     ukuy     shown immediately matrix structure eq                                 kmaxtumintuminâˆ’y                aim provide explicit proof establish                                                                ijcai                                                                interesting result right general property xtgx written  toeplitz matrices correlation entries               n k            n  k kâˆ’j                                                                                                                                 âˆ’       ut xi             ut ut  xi xij    show hurwitz property later          values Îµ convergence assured                                         optimal continuing large nbehaviour obtain       nâ†’âˆ                                              rearranging inner sums  vn  âˆ’â†’   aâˆ’  holds matter stimulus                                                                          k kâˆ’j  k kâˆ’t               â›                  â                                                                                                                     âœ                  âŸ                                                      âœ     âŸ               âˆ’   âœ               âŸ                 âœ             âŸ                using vectors dimension components                    â                 â                                                       ut  ut leads                                                                     n  k            n                                                                                         Ëœ  obtain                                                  gx  âˆ’        ut xi                                 âˆ’t                                                                                              âˆ                   rt  Ï„rt                                  Ëœ                      Ï„                               matrices Ã— band matrices                                                                   Ëœ  desired result proves convergence entries xmmn  xixin â‰¥  generality need show âˆ’ga hurwitz ma symmetrizing matrix products write                                                                                                      trix eigenvalues matrix negative real n       n               n                                                                                      want values Îµ provide   xËœ        xËœ          xËœ     maximum speed convergence                                                                                                                                                                 proof convergence                               matrix elements second term âˆ’k â‰¤ â‰¤                                                                       previous approaches literature temporal difference n             n           n                                                                Ëœ  td learning extended tdÎ» learning pa                 xjxjâˆ’n      xixin    rameter Î» refers exponential weighting recency      mmn              learning convergence issues considered  dayan  dayan sejnowski inthetdÎ» summation limits result taken  framework consider tdlearning convenience larger necessary covering cases  contrast mentioned literature concentrate di summand nonzero note nonposi  rect proof convergence establishing general property tive extra terms zero zero padding  toeplitz matrices correlation entries        vention xi result matrix elements    proof proceeds follows show ï¬rst ï¬rst second term eq  identical format  positive deï¬nite show eigenvalues nonnegative nonpositive respectively  ga positive real estab making use eq  eq  incorporating                                                        ï¬rst sum eq  leads  lished hurwitz property required convergence                                      order positive deï¬nite consider                    n                                                                                   nonzero real vector show gx positive         gx        xË†               ï¬rst extract diagonal matrix gd upper                       triangular matrix gthenwehave                                                        matrices xË† band matrices entries      xtgx       xtg     xtg     xtgtx              Ë†                                                 xmmn    xixin positive negative                                                       gdx     gx                   write sum matrices eq  dif                                                                                                                              ferent way denote vectors xËœ dimension                 gdx    gx                                                                                         components xËœm  xim                 n            n    k                                                       understood xj jn                    xi     xi   gj xij   vectors nonzero components  âˆ’kn                                              notice following covariance matrices generated  order summation limits easy understood vectors                                                                               xi inâ€zero paddingâ€                                                                                    xËœ xËœ         xim xin          toeplitz bands number stimuli shifting                 mn  time index eq  tumin  gj arises  stimuli uk  utrealas                    kn  âˆ’mkâˆ’                                                                                       kâˆ’j                                             n                    nm                                                                  xËœi xËœi     gj      ut ut   âˆ€                                  xi xinâˆ’m                                                             iâˆ’k           mn  iâˆ’km                                                    ijcai                                                                                                        let eigenvector ga Î» corre                                                                               ga                 n                        nm                   sponding eigenvalue    real Î» ei                                              ther real complex complex case           xËœ xËœ                    xi xin                              âˆ—                                                        exists eigenvector corresponding eigenvalue       iâˆ’k                     iâˆ’km                      mmn                           Î»âˆ—whereâˆ— denotes complex conjugated transposed                                                                        ay  establishes                                  let denote      write                                                                   zâˆ—gz    yâˆ—aâˆ—gay       yâˆ—aâˆ—y                                                                                  Î»                                                                                                              âˆ—                    xËœi xËœi  xË†               real symmetric                                                                âˆ—       âˆ—    âˆ—    âˆ— âˆ—               iâˆ’k                                              gz  gz    Î» ay                                                                  summation eqns   gives  rewrite eq  using eq                         âˆ—       âˆ—  âˆ—        âˆ—                                                                     gz   Î»   Î»a                                                                                                real symmetric positive deï¬nite     xtgx         utxËœi xËœi   utxËœi                      âˆ—                                                complex gz real positive used             iâˆ’k                 iâˆ’k                  follows                                                          case  Î» real  sum certainly nonnegative show                 zero                                   real  eq  immediately                                                                           âˆ—                                                                              rez gzÎ»y                  proof contradiction suppose sum zero                                                                                                                         individual terms zero start ï¬rst signreÎ»  signÎ»signy       term deï¬nition                                                          case  Î» complex                       k                               let write  viw Î»  ih eq              utxËœâˆ’k                                                                    ujxâˆ’kj  ukx           real  obtain                                                                                     âˆ—                                                                       rez gzg                                                                                                                                                                                                              zero uk  eq             âˆ’     âˆ’                                                                                              proceed second term                                    âˆ—                                                                      imz      gzh                                                                                                                                  k                                                                             âˆ’k                                                                âˆ’    xËœ           ujxâˆ’kj  ukâˆ’x  ukx  ukx                                                    combining eqns  and  gives                                                                                                                                                         gg                  previous result used                                                                zero uk eq   continuing follows with signre Î»  signg                                                                                              vein steps end product     signreÎ»  sign                                  k                                                                                          âˆ’kn         xËœ           ujxâˆ’knj                      results cases eqns   allow                                                    following sufï¬cient condition                                                        let  real symmetric positive deï¬nite matrix          uxnâˆ’k   ukâˆ’xnâˆ’   ukxn   ukxn                                                                                                        real square matrix matrix   previous results used xn  positive deï¬nite real parts eigenvalues  total means   contradiction ga positive  nonzero vector    result established xtgx    let turn attention speciï¬c matrix given  established                            eq  haveâ›                     â    symmetric toeplitz matrices structure                   âˆ’                                                                       âœ  âˆ’         âˆ’            âŸ  eq  correlation entries gj eq  positive    âœ                      âŸ  deï¬nite                                                           âœ                      âŸ                                                                 âœ                   âŸ                                                                       â                         â                                                                                          âˆ’      âˆ’    turn attention showing eigenvalues                           âˆ’  ga  positive real look real                                real symmetric positive deï¬nite  require stronger condition structure shown matrix   positive def  eq  say entries gj inite using previous result paper matrices    premises proof ï¬rst sufï¬cient structure positive deï¬nite noting  condition sign real eigenvalues structure using eq  im  ga show sign positive mediately gives desired result completes proof  hand                                    âˆ’ga  hurwitz matrix                                                    ijcai                                                    learningrateÎµ       fast convergence             curves mÎµk ensuring condition chosen  convergence behaviour temporal difference rule satisï¬es maxk mÎµk                                                          Îµ allmÎµk     decreasing Îµthe  known eq  large number trials convergence                                         âˆ—                                          âˆ’  ga       slope given âˆ’gk   start choosing  speed dominated eigenvalue  Îµ            âˆ—                                                         argmink   gk ensures condition  largest modulus convergence speed                                     âˆ—  slowest eigenvalues ev            maxk  mÎµk satisï¬ed choice  current                                                        position Îµc  apply following procedure   eve âˆ’ Îµgaâˆ’     Îµ evgaâˆ’     Îµ  ih      start                                                                           âˆ—  notation eigenvalues gaas continuing curve  reach minimum                                                                           âˆ—       gkâˆ—  previous section Î»   ih used                                 Îµkâˆ—                           ï¬rst task compute eigenvalues                 gkâˆ—  hkâˆ—  ga      dependent given stimuli uk current position Îµc pro                           ga                                         âˆ—  total time  note deï¬nes special struc posed position Îµkâˆ— maximum condition maxk mÎµk  ture unsymmetric toeplitz matrix bands satisï¬ed kâˆ— order check compute inter  known closed solution eigenvalues sections curve inspection kâˆ— curves  toeplitz matrices exists three bands  given symmetric asymmetric cases eq  intersections given values Îµk  beam warming      according  closed solution given sec                                                                                               âˆ’ Îµk gk  Îµk hk âˆ’ Îµk gkâˆ—   Îµk hkâˆ—   numerical values obtained special methods  solution asymptotic structure eigenvalues                                                                                 gk âˆ’ gkâˆ—  large aregiveninbeam warming                                                                                          Îµ      âˆ’       âˆ’                square modulus eigenvalues given                     gk   gkâˆ—  hk  hkâˆ—                                                      inspect intersection closest    mÎµ   eve âˆ’ Îµga   âˆ’   Îµg   Îµ                                                            current position ÎµcieforwhichkË† argmink Îµk  ï¬rst choice Îµ convergence Îµk Îµc                                                                  âˆ—        âˆ—  assured serves good rough value ÎµkË† Îµkâˆ— thenÎµkâˆ— eq  solution  setting Îµ computational effort      free minimum stop                                                                                                   âˆ—    note ï¬rst mÎµ eigenvalues fur     intersection prior reaching Îµkâˆ— ifthe  ther âˆ’ ga hurwitz eigenvalues curve intersecting rising ÎµkË† means  small Îµ mÎµ    eigenvalues actually reached condition  eq  lastly large Îµ mÎµ increase eq  solution  bounds eigenvalues mÎµ âˆ Îµ large Îµ                                                                                                                               gk âˆ’ gkâˆ—  eigenvalues                                    Ë†                                                        Îµkmink    Îµk     âˆ’       âˆ’    Îµk Îµc    sketch general behaviour mÎµitis                   gk  gkâˆ—  hk   hkâˆ—  clear each eigenvalue Îµk                                          mÎµk   mÎµk rising Îµk computing bounded minimum stop                                                                                                     Ë†  values eq  eigenvalues Î»k  gk  ihk curve intersecting falling Îµkwe  gives                                                 continue new curve satisï¬es max                              gk                       imum condition eq  end set Îµc  ÎµkË†                    Îµk                          âˆ—   Ë†                           gk  hk                        continue change falling curves maximum                                                        modulus start  mÎµ    Îµmink Îµk good choice  ÎµËœ convergent behaviour mean value fig  illustrates behaviour free minimum ï¬g   bounds                                               bounded minimum ï¬gures change falling                              gk                        curves maximum modulus                   ÎµËœ mink                         algorithm terminates ï¬nitely steps                            gk  hk                                                        minimum curve kâˆ— intersection  note hk   additional              âˆ’                                         falling rising curve clear  eigenvalue gk  ihk minimum eq  possibilities exist curves eventually rise large Îµ  identical needs computed                                       âˆ—    turn ï¬nding optimal value Îµ fastest  stimulus  vergence given               âˆ—                                        look special case stimulus              Îµ  argminÎµ  maxk mÎµk             present  eq  takes particularly                                                                          âˆ’  optimization problem closed solution simple form   unit shift matrix                                                                             simple line search algorithm given ï¬nd solu       t                                                                                                               nâˆ’j             tion ï¬nitely steps              av     âˆ’           âˆ’ Îµu     Îµu  âˆ’      general idea start Îµ increase Îµ             til reach Îµâˆ— process select                                                                                            ijcai                                                    
